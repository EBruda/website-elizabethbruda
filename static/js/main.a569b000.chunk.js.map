{"version":3,"sources":["constants.ts","log.ts","vendor/ics.js","utils/misc.tsx","components/Button/index.tsx","components/ActionRow/index.tsx","contexts/theme.ts","contexts/terms.ts","data/beans/Course.ts","data/beans/Section.ts","data/beans/SortingOption.ts","data/beans/Oscar.ts","data/types.ts","contexts/schedule.ts","contexts/overlayCrns.ts","components/TimeBlocks/index.tsx","components/Calendar/index.tsx","components/CombinationContainer/index.tsx","utils/cancellable.ts","components/Course/index.tsx","components/CourseAdd/index.tsx","components/CourseContainer/index.tsx","components/CourseFilter/index.tsx","utils/semesters.ts","hooks/useMobile.ts","components/Spinner/index.tsx","components/Select/index.tsx","components/HeaderDisplay/index.tsx","components/Header/index.tsx","components/Instructor/index.tsx","components/MapView/index.tsx","components/DaySelection/index.tsx","components/Map/index.tsx","components/NavDrawer/index.tsx","components/NavMenu/index.tsx","components/Palette/index.tsx","components/Prerequisite/index.tsx","components/Scheduler/index.tsx","components/Section/index.tsx","components/Tab/index.tsx","components/Attribution/index.tsx","components/Feedback/index.tsx","components/InformationModal/index.tsx","components/ErrorBoundary/index.tsx","components/ErrorDetails/index.tsx","components/ExpandableCard/index.tsx","components/ErrorDisplay/index.tsx","components/ErrorHeader/index.tsx","components/App/navigation.tsx","data/hooks/useDownloadTerms.ts","components/LoadingDisplay/index.tsx","components/App/content.tsx","components/WarningHeader/index.tsx","components/DataNotPersistentNotification/index.tsx","data/legacy/types.ts","data/legacy/validation.ts","data/migrations/cookiesTo1.ts","data/hooks/useScheduleDataMigrations.ts","data/migrations/index.ts","data/hooks/useExtractTermScheduleData.ts","components/AppDataLoader/stages.tsx","data/hooks/useScheduleDataFromStorage.ts","data/hooks/useDownloadOscarData.ts","data/hooks/useExtractScheduleVersion.ts","components/AppDataLoader/index.tsx","data/hooks/useThemeFromStorage.ts","components/App/index.tsx","hooks/useBodyClass.ts","types.ts","index.tsx"],"names":["OPEN","DAYS","PALETTE","DELIVERY_MODES","CAMPUSES","Video","Online","BACKEND_BASE_URL","ErrorWithFields","message","source","fields","topMessage","Error","stack","fastSafeStringify","rootError","getRootError","name","console","group","this","error","allFields","getAllFields","Object","keys","length","info","groupEnd","softError","logToConsole","includes","type","rest","__do_not_use_type_in_sentry_it_is_special","Sentry","contexts","fingerprint","ics","uidDomain","prodId","navigator","userAgent","indexOf","SEPARATOR","appVersion","calendarEvents","calendarStart","join","calendarEnd","BYDAY_VALUES","events","calendar","addEvent","subject","description","location","begin","stop","rrule","freq","until","Number","isNaN","Date","parse","interval","parseInt","count","byday","prototype","toString","call","d","filter","elem","pos","start_date","end_date","now_date","start_year","getFullYear","slice","start_month","getMonth","start_day","getDate","start_hours","getHours","start_minutes","getMinutes","start_seconds","getSeconds","end_year","end_month","end_day","end_hours","end_minutes","end_seconds","now_year","now_month","now_day","now_hours","now_minutes","now_seconds","start_time","end_time","rruleString","start","end","now","uDate","toISOString","substring","replace","calendarEvent","splice","push","download","filename","ext","blob","Blob","bb","BlobBuilder","append","getBlob","document","characterSet","saveAs","build","log","stringToTime","string","regexResult","exec","hour","minute","timeToString","time","ampm","hh","mm","padStart","A","timeToShortString","periodToString","period","getRandomColor","colors","flat","Math","random","getContentClassName","color","hasConflictBetween","section1","section2","meetings","some","meeting1","meeting2","day","days","classes","classList","c","isMobile","window","innerWidth","simplifyName","tokens","split","shift","pop","unique","array","Array","from","Set","isLab","section","scheduleType","isLecture","humanizeArrayReact","conjunction","String","init","last","trim","serializePrereqs","reqs","openPar","closePar","i","isArray","subClauses","forEach","req","id","isAxiosNetworkError","err","exponentialBackoff","attemptNumber","a","options","DelayFactory","getSanitizedOptions","jitter","numOfAttempts","MAX_SAFE_INTEGER","apply","sleep","amount_ms","Promise","resolve","setTimeout","undefined","Button","className","disabled","href","onClick","children","rel","target","tabIndex","onKeyDown","event","key","role","ActionRow","label","actions","restProps","flatMap","action","map","icon","styling","dataTip","dataFor","onMouseEnter","onMouseLeave","fixedWidth","style","ThemeContext","React","createContext","next","TermsContext","Course","oscar","courseId","data","number","title","sections","prereqs","hasLab","onlyLectures","onlyLabs","allInOnes","sectionGroups","term","entries","sectionId","sectionData","Section","lecture","associatedLabs","lab","startsWith","associatedLectures","lonelyLectures","lonelyLabs","distinct","groups","sectionGroupMeetings","sectionGroupHash","JSON","stringify","sectionGroup","hash","encodedCourse","encodeURIComponent","url","axios","get","responseData","baseId","cleanedId","gpaMap","rawAverageGpa","header","avg_gpa","actual","averageGpa","raw","instructorData","rawInstructor","instructor_name","idx","instructorGpa","GPA","instructor","nameSegments","lastName","firstName","course","crn","seating","credits","campus","deliveryMode","gradeBasis","instructors","scheduleTypeIndex","campusIndex","attributeIndices","gradeBasisIndex","scheduleTypes","campuses","attributes","attributeIndex","attribute","find","gradeBases","periodIndex","where","locationIndex","dateRangeIndex","periods","locations","dateRange","dateRanges","to","reduce","accum","prevDate","currDate","method","headers","then","response","tableRow","cheerio","load","$","eq","first","text","catch","fill","SortingOption","calculateFactor","Oscar","updatedAt","version","courses","courseMap","crnMap","sortingOptions","caches","periodSegments","cacheIndex","segments","v","setHours","combination","startMap","endMap","tot","min","ends","values","starts","desiredCourses","pinnedCrns","excludedCrns","crnsList","dfs","courseIndex","crns","findCourse","isIncluded","isPinned","hasConflict","crnSection","findSection","pinnedOnlyLecture","pinnedOnlyLab","pinnedAllInOne","iterateTimeBlocks","combinations","sortingOptionIndex","sortingOption","actualSortingOptionsLength","factor","sort","b","callback","meeting","EMPTY_OSCAR","defaultTermScheduleData","versions","currentIndex","defaultSchedule","colorMap","ScheduleContext","setTerm","patchSchedule","patch","updateSchedule","OverlayCrnsContext","makeSizeInfoKey","TimeBlocks","overlay","preview","capture","isAutosized","sizeInfo","useContext","contentClassName","sizeInfoKey","sizeInfoDay","sizeInfoPeriodDay","top","height","width","rowSize","left","rowIndex","backgroundColor","place","effect","Calendar","overlayCrns","crnSizeInfo","updateJoinedRowSizes","periodInfos","seen","curCrn","curPeriod","newRowSize","has","add","period2Info","maxMeetingLen","max","m","dayPeriodInfos","curRowSize","acc","courseSizeInfo","daySizeInfo","_","CombinationContainer","setOverlayCrns","handleResetPinnedCrns","useCallback","confirm","useMemo","getCombinations","sortedCombinations","sortCombinations","Select","onChange","newSortingOptionIndex","value","outline","rowCount","rowHeight","rowRenderer","index","cancelledSymbol","Symbol","Cancellable","isCancelled","cancel","promise","other","race","result","cancelled","onAddCourse","useState","expanded","setExpanded","prereqOpen","setPrereqOpen","paletteShown","setPaletteShown","setGpaMap","isSearching","Boolean","useEffect","loadOperation","loadCourseGpa","fetchGpa","perform","handleRemoveCourse","newColorMap","handleIncludeSections","hasPrereqs","instructorMap","primaryInstructor","instructorSections","excludedInstructors","every","includedInstructors","prereqControl","nextPrereqOpen","nextExpanded","prereqAction","faShareAlt","transform","infoAction","faInfoCircle","pinnedSections","totalCredits","faPlus","faAngleUp","faAngleDown","faPalette","faTrash","toFixed","Palette","onSelectColor","col","Instructor","gpa","Prerequisite","isSortKey","sortKey","CourseAdd","keyword","setKeyword","setFilter","activeIndex","setActiveIndex","inputRef","useRef","handleChangeKeyword","e","input","results","toUpperCase","keywordMatch","filterMatch","tags","sortValue","doesFilterMatchCourse","handleAddCourse","toBeExcludedCrns","timeDecided","doesFilterMatchSection","current","focus","handleKeyDown","preventDefault","handleToggleFilter","tag","handleResetFilter","activeCourse","ref","placeholder","property","labels","CourseFilter","selectedTags","onReset","onToggle","CourseContainer","ago","selectedTag","isTerm","maybeTerm","month","yearAsNumber","monthAsNumber","getSemesterName","year","semester","useMobile","mobile","setMobile","handleResize","newMobile","addEventListener","removeEventListener","Spinner","size","actualSize","small","normal","viewBox","cx","cy","r","opened","setOpened","selectedOption","option","faCaretDown","optionValue","optionLabel","LoadingSelect","marginRight","HeaderDisplay","currentTab","onChangeTab","onToggleMenu","tabs","onCopyCrns","enableCopyCrns","onExportCalendar","enableExportCalendar","onDownloadCalendar","enableDownloadCalendar","termsState","theme","setTheme","handleThemeChange","newTheme","Cookies","set","expires","crnButton","faBars","onChangeTerm","currentTerm","terms","tabLabel","tabIdx","Tab","active","faDownload","faCalendarAlt","faPaste","delayHide","afterShow","ReactTooltip","hide","faAdjust","faGithub","Header","captureRef","handleExport","cal","alert","getTime","getDay","setDate","M","T","W","R","F","exportCoursesToCalendar","handleDownload","captureElement","computed","getComputedStyle","getPropertyValue","domtoimage","toBlob","offsetWidth","offsetHeight","downloadShadowCalendar","handleCopyCrns","copy","includeSection","excludeSections","sectionList","instructorPinned","includedSections","excludedSections","excludeTooltipId","faGraduationCap","faBan","pinned","MapView","latitude","longitude","zoom","viewState","setViewState","unknown","coordsToLocationsMap","Map","coords","mapStyle","mapboxApiAccessToken","process","onViewStateChange","newViewState","coordLocations","lat","long","faMapPin","coordLocation","showZoom","showCompass","isDay","rawDay","LIGHT_COLOR_PALETTE","DARK_COLOR_PALETTE","DaySelection","courseDateMap","activeDay","setActiveDay","daysOfTheWeek","colorPalette","formatTime","floor","adjustedHour","date","padding","timeLabel","times","daysOfWeek","firstMeeting","sortedCourseDateMap","courseDataList","activeLocations","NavDrawer","open","onClose","faTimes","NavMenu","items","currentItem","onChangeItem","item","paletteColor","BASE_ITEM_STYLE","fontSize","content","PrerequisiteEmpty","op","PrerequisiteClauseDisplay","clause","subClause","PrerequisiteOption","operator","PrerequisiteHeader","PrerequisiteItem","isLast","Scheduler","setTabIndex","overlayContextValue","tabTitle","Provider","setSeating","hovering","excludeSection","sect","pinSection","faThumbtack","faChair","fetchSeating","newSeating","afterHide","Attribution","Feedback","submit","setSubmit","rating","setRating","feedback","setFeedback","loading","setLoading","faCommentAlt","marginLeft","submitFeedback","MODAL_LOCAL_STORAGE_KEY","InformationModalContent","margin","display","alt","src","ErrorBoundary","props","state","reactErrorInfo","setState","fallback","Component","ErrorDetailsField","ReactErrorDetails","errorInfo","BaseErrorDetails","componentStack","LoadingErrorDetails","overview","safeStringify","ExpandableCard","showChildren","setShowChildren","ErrorDisplay","errorDetails","ErrorHeader","faExclamationTriangle","NAV_TABS","AppNavigationContext","currentTabIndex","isDrawerOpen","openDrawer","closeDrawer","AppNavigation","setIsDrawerOpen","contextValue","AppMobileNav","GITHUB_API_URL","LoadingDisplay","contents","opacity","stillLoading","AppContentBase","SkeletonContent","AppContent","memo","AppSkeletonWithLoadingTerms","AppSkeletonWithSwitchableTerms","WarningHeader","faExclamationCircle","DataNotPersistentNotification","onAccept","defaultTermData","isStringArray","field","validateTermData","termData","rawTermData","errors","termDataType","validTermData","termDataAsRecord","fieldValidationErrors","originalError","defaultVersion1ScheduleData","migrateCookiesTo1","allCookies","userNumber","cookieKey","cookieValue","parseResult","parsed","parseTermData","validateResult","schedule","useScheduleDataMigrations","rawScheduleData","setScheduleData","setError","updatedScheduleData","scheduleDataVersion1OrNewer","migrateScheduleData","newError","isValidTerm","StageLoadScheduleData","loadingState","useLocalStorageState","scheduleData","isPersistent","migrationResult","userAcceptedNonPersistence","setUserAcceptedNonPersistence","updateScheduleData","applyDraft","migrationResultType","produce","useScheduleDataFromStorage","maybeUpdateScheduleData","nextTerm","draft","StageLoadTerms","newTerms","test","reverse","useDownloadTerms","StageExtractTermScheduleData","mostRecentTerm","correctedTerm","currentTermScheduleData","correctedTermScheduleData","castDraft","updateTermScheduleData","currentTermScheduleDataDraft","termScheduleData","allTermsInData","useExtractTermScheduleData","StageLoadOscarData","loadedOscarRef","constructTermDataUrl","isFirst","initialLoad","REFRESH_INTERVAL_MIN","json","loadAndRefresh","useDownloadOscarData","StageExtractScheduleVersion","tryGet","arr","maybeCurrentScheduleVersion","updateScheduleVersion","currentScheduleVersionDraft","subDraft","currentScheduleVersion","scheduleVersion","useExtractSchedule","DataLoader","ContextProvider","original","scheduleContextValue","THEME_LOCAL_STORAGE_KEY","App","hasSeen","setHasSeen","swal","button","localStorageKey","useInformationModal","themeContextValue","legacyValue","correctedTheme","isTheme","useThemeFromStorage","useLayoutEffect","body","remove","AppCSSRoot","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","ignoreErrors","release","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.a569b000.chunk.js","sourcesContent":["const OPEN = 8 * 60;\nconst CLOSE = 21 * 60;\nconst DAYS = ['M', 'T', 'W', 'R', 'F'];\n\nconst PNG_SCALE_FACTOR = 2;\n\nconst PALETTE = [\n  [\n    '#4D4D4D',\n    '#999999',\n    '#FFFFFF',\n    '#F44E3B',\n    '#FE9200',\n    '#FCDC00',\n    '#DBDF00',\n    '#A4DD00',\n    '#68CCCA',\n    '#73D8FF',\n    '#AEA1FF',\n    '#FDA1FF',\n  ],\n  [\n    '#333333',\n    '#808080',\n    '#CCCCCC',\n    '#D33115',\n    '#E27300',\n    '#FCC400',\n    '#B0BC00',\n    '#68BC00',\n    '#16A5A5',\n    '#009CE0',\n    '#7B64FF',\n    '#FA28FF',\n  ],\n  [\n    '#000000',\n    '#666666',\n    '#B3B3B3',\n    '#9F0500',\n    '#C45100',\n    '#FB9E00',\n    '#808900',\n    '#194D33',\n    '#0C797D',\n    '#0062B1',\n    '#653294',\n    '#AB149E',\n  ],\n];\n\nconst ASYNC_DELIVERY_MODE = 'Remote Asynchronous Course';\n\nconst DELIVERY_MODES: Record<string, string> = {\n  'Hybrid Course': 'Hybrid',\n  'Remote Synchronous Course': 'Remote Synchronous',\n  'Remote Asynchronous Course': 'Remote Asynchronous',\n  'Residential Course': 'Residential',\n};\n\nconst CAMPUSES: Record<string, string> = {\n  'Georgia Tech-Atlanta *': 'Atlanta',\n  'GT Lorraine-Undergrad Programs': 'Lorraine Undergrad',\n  'GT Lorraine-Graduate Programs': 'Lorraine Graduate',\n  'Georgia Tech - Shenzhen': 'Shenzhen',\n  Video: 'Video',\n  Online: 'Online',\n  'MBA Evening Program': 'MBA Evening',\n};\n\nconst BACKEND_BASE_URL = 'https://gt-scheduler.azurewebsites.net';\n\nexport {\n  OPEN,\n  CLOSE,\n  DAYS,\n  PNG_SCALE_FACTOR,\n  PALETTE,\n  ASYNC_DELIVERY_MODE,\n  DELIVERY_MODES,\n  CAMPUSES,\n  BACKEND_BASE_URL,\n};\n","import * as Sentry from '@sentry/react';\nimport fastSafeStringify from 'fast-safe-stringify';\n\nexport class ErrorWithFields extends Error {\n  fields: Record<string, unknown>;\n\n  topMessage: string;\n\n  source: Error | null;\n\n  constructor({\n    message,\n    source,\n    fields = {},\n  }: {\n    message: string;\n    source?: unknown;\n    fields?: Record<string, unknown>;\n  }) {\n    super();\n\n    this.fields = fields;\n    this.topMessage = message;\n\n    // Make sure the given source is an error if given,\n    // otherwise add its string serialization as a field\n    if (source instanceof Error) {\n      this.source = source;\n      this.message = `${message}: ${source.message}`;\n\n      // Try to inherit the stacktrace of the given error\n      // (otherwise, fall back to the stacktrace created\n      // when this error was constructed)\n      if (source.stack != null) {\n        this.stack = source.stack;\n      }\n    } else {\n      this.source = null;\n      this.message = message;\n\n      if (this.source !== null) {\n        // The source was non-null but was not an Error:\n        // add a naive string serialization as a context\n        this.fields['__non_error_source'] = 'true';\n        this.fields['__source'] = fastSafeStringify(source);\n      }\n    }\n\n    // Configure the name based on whether this is wrapping\n    // an existing non-wrapped error\n    const rootError = this.getRootError();\n    if (rootError === this || rootError instanceof ErrorWithFields) {\n      this.name = 'ErrorWithFields';\n    } else {\n      this.name = `ErrorWithFields(${rootError.name})`;\n    }\n  }\n\n  logToConsole(): void {\n    /* eslint-disable no-console */\n    console.group(this.topMessage);\n    console.error(this.getRootError());\n\n    const allFields = this.getAllFields();\n    if (Object.keys(allFields).length > 0) {\n      console.info(allFields);\n    }\n\n    console.groupEnd();\n    /* eslint-enable no-console */\n  }\n\n  getAllFields(): Record<string, unknown> {\n    if (this.source instanceof ErrorWithFields) {\n      return { ...this.source.getAllFields(), ...this.fields };\n    }\n\n    return this.fields;\n  }\n\n  getRootError(): Error {\n    if (this.source === null) {\n      return this;\n    }\n\n    if (this.source instanceof ErrorWithFields) {\n      return this.source.getRootError();\n    }\n\n    return this.source;\n  }\n}\n\n/**\n * Logs an error to the console and reports it to Sentry.\n * Does not re-throw any errors and can be used when there is reasonable\n * fallback behavior.\n * @param error - an instance of `ErrorWithFields`\n */\nexport function softError(error: ErrorWithFields): void {\n  error.logToConsole();\n\n  // Report the error to Sentry if in production\n  if (process.env.NODE_ENV === 'production') {\n    // Ensure we don't include `type` in the fields\n    let fields = error.getAllFields();\n    if (Object.keys(fields).includes('type')) {\n      const { type, ...rest } = fields;\n      fields = { __do_not_use_type_in_sentry_it_is_special: type, ...rest };\n    }\n\n    Sentry.captureException(error.getRootError(), {\n      // https://docs.sentry.io/platforms/ruby/enriching-events/context/#structured-context\n      contexts: {\n        fields,\n        error: {\n          message: error.message,\n        },\n      },\n      fingerprint: [error.message],\n    });\n  }\n}\n","/* global saveAs, BlobBuilder */\n/* exported ics */\n\nconst ics = (uidDomain, prodId) => {\n  if (\n    navigator.userAgent.indexOf('MSIE') > -1 &&\n    navigator.userAgent.indexOf('MSIE 10') === -1\n  ) {\n    // eslint-disable-next-line no-console\n    console.log('Unsupported Browser');\n    return;\n  }\n\n  if (typeof uidDomain === 'undefined') {\n    uidDomain = 'default';\n  }\n  if (typeof prodId === 'undefined') {\n    prodId = 'Calendar';\n  }\n\n  const SEPARATOR = navigator.appVersion.indexOf('Win') !== -1 ? '\\r\\n' : '\\n';\n  const calendarEvents = [];\n  const calendarStart = [\n    'BEGIN:VCALENDAR',\n    `PRODID:${prodId}`,\n    'VERSION:2.0',\n  ].join(SEPARATOR);\n  const calendarEnd = `${SEPARATOR}END:VCALENDAR`;\n  const BYDAY_VALUES = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\n\n  return {\n    /**\n     * Returns events array\n     * @return {array} Events\n     */\n    events() {\n      return calendarEvents;\n    },\n\n    /**\n     * Returns calendar\n     * @return {string} Calendar in iCalendar format\n     */\n    calendar() {\n      return (\n        calendarStart + SEPARATOR + calendarEvents.join(SEPARATOR) + calendarEnd\n      );\n    },\n\n    /**\n     * Add event to the calendar\n     * @param  {string} subject     Subject/Title of event\n     * @param  {string} description Description of event\n     * @param  {string} location    Location of event\n     * @param  {string} begin       Beginning date of event\n     * @param  {string} stop        Ending date of event\n     */\n    addEvent(subject, description, location, begin, stop, rrule) {\n      // I'm not in the mood to make these optional... So they are all required\n      if (\n        typeof subject === 'undefined' ||\n        typeof description === 'undefined' ||\n        typeof location === 'undefined' ||\n        typeof begin === 'undefined' ||\n        typeof stop === 'undefined'\n      ) {\n        return false;\n      }\n\n      // validate rrule\n      if (rrule) {\n        if (!rrule.rrule) {\n          if (\n            rrule.freq !== 'YEARLY' &&\n            rrule.freq !== 'MONTHLY' &&\n            rrule.freq !== 'WEEKLY' &&\n            rrule.freq !== 'DAILY'\n          ) {\n            throw new Error(\n              \"Recurrence rrule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'\"\n            );\n          }\n\n          if (rrule.until) {\n            if (Number.isNaN(Date.parse(rrule.until))) {\n              throw new Error(\n                \"Recurrence rrule 'until' must be a valid date string\"\n              );\n            }\n          }\n\n          if (rrule.interval) {\n            if (Number.isNaN(parseInt(rrule.interval, 10))) {\n              throw new Error(\"Recurrence rrule 'interval' must be an integer\");\n            }\n          }\n\n          if (rrule.count) {\n            if (Number.isNaN(parseInt(rrule.count, 10))) {\n              throw new Error(\"Recurrence rrule 'count' must be an integer\");\n            }\n          }\n\n          if (typeof rrule.byday !== 'undefined') {\n            if (\n              Object.prototype.toString.call(rrule.byday) !== '[object Array]'\n            ) {\n              throw new Error(\"Recurrence rrule 'byday' must be an array\");\n            }\n\n            if (rrule.byday.length > 7) {\n              throw new Error(\n                \"Recurrence rrule 'byday' array must not be longer than the 7 days in a week\"\n              );\n            }\n\n            // Filter any possible repeats\n            rrule.byday = rrule.byday.filter((elem, pos) => {\n              return rrule.byday.indexOf(elem) === pos;\n            });\n\n            for (const d in rrule.byday) {\n              if (BYDAY_VALUES.indexOf(rrule.byday[d]) < 0) {\n                throw new Error(\n                  \"Recurrence rrule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'\"\n                );\n              }\n            }\n          }\n        }\n      }\n\n      // TODO add time and time zone? use moment to format?\n      const start_date = new Date(begin);\n      const end_date = new Date(stop);\n      const now_date = new Date();\n\n      const start_year = `0000${start_date.getFullYear().toString()}`.slice(-4);\n      const start_month = `00${(start_date.getMonth() + 1).toString()}`.slice(\n        -2\n      );\n      const start_day = `00${start_date.getDate().toString()}`.slice(-2);\n      const start_hours = `00${start_date.getHours().toString()}`.slice(-2);\n      const start_minutes = `00${start_date.getMinutes().toString()}`.slice(-2);\n      const start_seconds = `00${start_date.getSeconds().toString()}`.slice(-2);\n\n      const end_year = `0000${end_date.getFullYear().toString()}`.slice(-4);\n      const end_month = `00${(end_date.getMonth() + 1).toString()}`.slice(-2);\n      const end_day = `00${end_date.getDate().toString()}`.slice(-2);\n      const end_hours = `00${end_date.getHours().toString()}`.slice(-2);\n      const end_minutes = `00${end_date.getMinutes().toString()}`.slice(-2);\n      const end_seconds = `00${end_date.getSeconds().toString()}`.slice(-2);\n\n      const now_year = `0000${now_date.getFullYear().toString()}`.slice(-4);\n      const now_month = `00${(now_date.getMonth() + 1).toString()}`.slice(-2);\n      const now_day = `00${now_date.getDate().toString()}`.slice(-2);\n      const now_hours = `00${now_date.getHours().toString()}`.slice(-2);\n      const now_minutes = `00${now_date.getMinutes().toString()}`.slice(-2);\n      const now_seconds = `00${now_date.getSeconds().toString()}`.slice(-2);\n\n      let start_time = '';\n      let end_time = '';\n      if (\n        start_hours +\n          start_minutes +\n          start_seconds +\n          end_hours +\n          end_minutes +\n          end_seconds !==\n        0\n      ) {\n        start_time = `T${start_hours}${start_minutes}${start_seconds}`;\n        end_time = `T${end_hours}${end_minutes}${end_seconds}`;\n      }\n      const now_time = `T${now_hours}${now_minutes}${now_seconds}`;\n\n      const start = start_year + start_month + start_day + start_time;\n      const end = end_year + end_month + end_day + end_time;\n      const now = now_year + now_month + now_day + now_time;\n\n      // recurrence rrule vars\n      let rruleString;\n      if (rrule) {\n        if (rrule.rrule) {\n          rruleString = rrule.rrule;\n        } else {\n          rruleString = `RRULE:FREQ=${rrule.freq}`;\n\n          if (rrule.until) {\n            const uDate = new Date(Date.parse(rrule.until)).toISOString();\n            rruleString += `;UNTIL=${uDate\n              .substring(0, uDate.length - 13)\n              .replace(/[-]/g, '')}000000Z`;\n          }\n\n          if (rrule.interval) {\n            rruleString += `;INTERVAL=${rrule.interval}`;\n          }\n\n          if (rrule.count) {\n            rruleString += `;COUNT=${rrule.count}`;\n          }\n\n          if (rrule.byday && rrule.byday.length > 0) {\n            rruleString += `;BYDAY=${rrule.byday.join(',')}`;\n          }\n        }\n      }\n\n      // var stamp = new Date().toISOString();\n\n      let calendarEvent = [\n        'BEGIN:VEVENT',\n        `UID:${calendarEvents.length}@${uidDomain}`,\n        'CLASS:PUBLIC',\n        `DESCRIPTION:${description}`,\n        `DTSTAMP;VALUE=DATE-TIME:${now}`,\n        `DTSTART;VALUE=DATE-TIME:${start}`,\n        `DTEND;VALUE=DATE-TIME:${end}`,\n        `LOCATION:${location}`,\n        `SUMMARY;LANGUAGE=en-us:${subject}`,\n        'TRANSP:TRANSPARENT',\n        'END:VEVENT',\n      ];\n\n      if (rruleString) {\n        calendarEvent.splice(4, 0, rruleString);\n      }\n\n      calendarEvent = calendarEvent.join(SEPARATOR);\n\n      calendarEvents.push(calendarEvent);\n      return calendarEvent;\n    },\n\n    /**\n     * Download calendar using the saveAs function from filesave.js\n     * @param  {string} filename Filename\n     * @param  {string} ext      Extention\n     */\n    download(filename, ext) {\n      if (calendarEvents.length < 1) {\n        return false;\n      }\n\n      ext = typeof ext !== 'undefined' ? ext : '.ics';\n      filename = typeof filename !== 'undefined' ? filename : 'calendar';\n      const calendar =\n        calendarStart +\n        SEPARATOR +\n        calendarEvents.join(SEPARATOR) +\n        calendarEnd;\n\n      let blob;\n      if (navigator.userAgent.indexOf('MSIE 10') === -1) {\n        // chrome or firefox\n        blob = new Blob([calendar]);\n      } else {\n        // ie\n        const bb = new BlobBuilder();\n        bb.append(calendar);\n        blob = bb.getBlob(`text/x-vCalendar;charset=${document.characterSet}`);\n      }\n      saveAs(blob, filename + ext);\n      return calendar;\n    },\n\n    /**\n     * Build and return the ical contents\n     */\n    build() {\n      if (calendarEvents.length < 1) {\n        return false;\n      }\n\n      const calendar =\n        calendarStart +\n        SEPARATOR +\n        calendarEvents.join(SEPARATOR) +\n        calendarEnd;\n\n      return calendar;\n    },\n  };\n};\n\nexport default ics;\n","import React from 'react';\nimport { IBackOffOptions } from 'exponential-backoff';\nimport { DelayFactory } from 'exponential-backoff/dist/delay/delay.factory';\nimport { getSanitizedOptions } from 'exponential-backoff/dist/options';\nimport domtoimage from 'dom-to-image';\nimport { saveAs } from 'file-saver';\n\nimport { Oscar, Section } from '../data/beans';\nimport { DAYS, PALETTE, PNG_SCALE_FACTOR } from '../constants';\nimport { ErrorWithFields, softError } from '../log';\nimport { ICS, Period, PrerequisiteClause, Theme } from '../types';\nimport ics from '../vendor/ics';\n\nexport const stringToTime = (string: string): number => {\n  const regexResult = /(\\d{1,2}):(\\d{2}) (a|p)m/.exec(string);\n  if (regexResult === null) return 0;\n  const [, hour, minute, ampm] = regexResult as unknown as [\n    string,\n    string,\n    string,\n    string\n  ];\n  return ((ampm === 'p' ? 12 : 0) + (+hour % 12)) * 60 + +minute;\n};\n\nexport const timeToString = (time: number, ampm = true): string => {\n  const hour = (time / 60) | 0;\n  const minute = time % 60;\n  const hh = hour > 12 ? hour - 12 : hour;\n  const mm = `${minute}`.padStart(2, '0');\n  const A = `${hour < 12 ? 'a' : 'p'}m`;\n  return ampm ? `${hh}:${mm} ${A}` : `${hh}:${mm}`;\n};\n\nexport const timeToShortString = (time: number): string => {\n  const hour = (time / 60) | 0;\n  return `${hour > 12 ? hour - 12 : hour}${hour < 12 ? 'a' : 'p'}m`;\n};\n\nexport const periodToString = (period: Period | undefined): string =>\n  period != null\n    ? `${timeToString(period.start, false)} - ${timeToString(period.end)}`\n    : 'TBA';\n\nexport const getRandomColor = (): string => {\n  const colors = PALETTE.flat();\n  const index = (Math.random() * colors.length) | 0;\n  return colors[index] ?? '#333333';\n};\n\nexport const getContentClassName = (color: string | undefined): string => {\n  if (color == null) return 'light-content';\n  const r = parseInt(color.substring(1, 3), 16);\n  const g = parseInt(color.substring(3, 5), 16);\n  const b = parseInt(color.substring(5, 7), 16);\n  return r * 0.299 + g * 0.587 + b * 0.114 > 128\n    ? 'light-content'\n    : 'dark-content';\n};\n\nexport const hasConflictBetween = (\n  section1: Section,\n  section2: Section\n): boolean =>\n  section1.meetings.some((meeting1) =>\n    section2.meetings.some(\n      (meeting2) =>\n        meeting1.period &&\n        meeting2.period &&\n        DAYS.some(\n          (day) => meeting1.days.includes(day) && meeting2.days.includes(day)\n        ) &&\n        meeting1.period.start < meeting2.period.end &&\n        meeting2.period.start < meeting1.period.end\n    )\n  );\n\nexport const classes = (\n  ...classList: (string | boolean | null | undefined)[]\n): string => classList.filter((c) => c).join(' ');\n\nexport const isMobile = (): boolean => window.innerWidth < 1024;\n\nexport const simplifyName = (name: string): string => {\n  const tokens = name.split(' ');\n  const firstName = tokens.shift();\n  const lastName = tokens.pop();\n  return [firstName, lastName].join(' ');\n};\n\nexport function unique<T>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport const isLab = (section: Section): boolean =>\n  ['Lab', 'Studio'].some((type) => section.scheduleType.includes(type));\n\nexport const isLecture = (section: Section): boolean =>\n  section.scheduleType.includes('Lecture');\n\nexport function humanizeArray<T>(array: T[], conjunction = 'and'): string {\n  if (array.length <= 2) {\n    return array.join(` ${conjunction} `);\n  }\n  const init = [...array];\n  const last = init.pop();\n  return `${init.join(', ')}, ${conjunction} ${String(last)}`;\n}\n\nexport function humanizeArrayReact<T>(\n  array: T[],\n  conjunction: React.ReactNode = 'and'\n): React.ReactNode {\n  if (array.length === 0) {\n    return null;\n  }\n  if (array.length === 1) {\n    return String(array[0]);\n  }\n  if (array.length === 2) {\n    return (\n      <>\n        {String(array[0])} {conjunction} {String(array[1])}\n      </>\n    );\n  }\n\n  const init = [...array];\n  const last = init.pop();\n  return (\n    <>\n      {`${init.join(', ')},`.trim()} {conjunction} {String(last)}\n    </>\n  );\n}\n\nexport const serializePrereqs = (\n  reqs: PrerequisiteClause,\n  openPar = false,\n  closePar = false\n): string => {\n  // This function accepts the index of a sub-clause\n  // from the sub-clause slice of a compound prereq clause\n  // (i.e. the [...sub-clauses] part of a clause\n  // that itself is of the form [operator, ...sub-clauses]).\n  // As such, we compare to the clause length - 2\n  // (since the sub-clauses[0] is really reqs[1])\n  const last = (i: number): boolean =>\n    Array.isArray(reqs) && i === reqs.length - 2;\n  let string = '';\n\n  if (!Array.isArray(reqs)) {\n    string += (openPar ? '(' : '') + reqs.id + (closePar ? ')' : '');\n  } else if (reqs[0] === 'and') {\n    const [, ...subClauses] = reqs;\n    subClauses.forEach((req, i) => {\n      string +=\n        serializePrereqs(req, i === 0, last(i)) + (last(i) ? '' : ' and ');\n    });\n  } else if (reqs[0] === 'or') {\n    const [, ...subClauses] = reqs;\n    subClauses.forEach((req, i) => {\n      string += serializePrereqs(req) + (last(i) ? '' : ' or ');\n    });\n  }\n\n  return string;\n};\n\n// Determines whether an error is an axios network error,\n// which is used when determining whether to send it to Sentry\n// (since we can't do anything about a client-side NetworkError)--\n// it's either an error in the user's network\n// or downtime in a third-party service.\nexport const isAxiosNetworkError = (err: unknown): boolean => {\n  return err instanceof Error && err.message.includes('Network Error');\n};\n\n/**\n * Sleeps for a delay controlled by an exponential backoff function with jitter.\n * Acts as a thin wrapper around `exponential-backoff`\n * that provides a lower-level API\n * @param attemptNumber - The number of attempts that have occurred so far\n * @param options - [optional] config for exponential-backoff\n */\nexport async function exponentialBackoff(\n  attemptNumber: number,\n  options: Partial<IBackOffOptions> = {}\n): Promise<void> {\n  await DelayFactory(\n    getSanitizedOptions({\n      // See https://github.com/coveooss/exponential-backoff for options API\n      jitter: 'full',\n      numOfAttempts: Number.MAX_SAFE_INTEGER,\n      ...options,\n    }),\n    attemptNumber\n  ).apply();\n}\n\n/**\n * Promise version of `setTimeout`; used to wait for a specific delay\n */\nexport async function sleep({\n  amount_ms,\n}: {\n  amount_ms: number;\n}): Promise<void> {\n  await new Promise((resolve) =>\n    setTimeout(() => resolve(undefined), amount_ms)\n  );\n}\n\n/**\n * Exports the current schedule to a `.ics` file,\n * which allows for importing into a third-party calendar application.\n */\nexport function exportCoursesToCalendar(\n  oscar: Oscar,\n  pinnedCrns: readonly string[]\n): void {\n  const cal = ics() as ICS | undefined;\n  if (cal == null) {\n    window.alert('This browser does not support calendar export');\n    softError(\n      new ErrorWithFields({\n        message: 'ics() returned null or undefined',\n      })\n    );\n\n    return;\n  }\n\n  pinnedCrns.forEach((crn) => {\n    const section = oscar.findSection(crn);\n    if (section == null) return;\n\n    section.meetings.forEach((meeting) => {\n      if (!meeting.period || !meeting.days.length) return;\n      const { from, to } = meeting.dateRange;\n      const subject = section.course.id;\n      const description = section.course.title;\n      const location = meeting.where;\n      const begin = new Date(from.getTime());\n      while (\n        !meeting.days.includes(\n          ['-', 'M', 'T', 'W', 'R', 'F', '-'][begin.getDay()] ?? '-'\n        )\n      ) {\n        begin.setDate(begin.getDate() + 1);\n      }\n      begin.setHours(meeting.period.start / 60, meeting.period.start % 60);\n      const end = new Date(begin.getTime());\n      end.setHours(meeting.period.end / 60, meeting.period.end % 60);\n      const rrule = {\n        freq: 'WEEKLY',\n        until: to,\n        byday: meeting.days\n          .map(\n            (day) =>\n              ({ M: 'MO', T: 'TU', W: 'WE', R: 'TH', F: 'FR' }[day] ?? null)\n          )\n          .filter((day) => !!day),\n      };\n      cal.addEvent(subject, description, location, begin, end, rrule);\n    });\n  });\n  cal.download('gt-scheduler');\n}\n\n/**\n * Downloads a screenshot of the \"shadow\" calendar\n * that exists invisible in the app\n * and reflects the current state of the scheduler.\n * Allows the screenshot to be exported consistently\n * regardless of screen size or app state.\n * Requires the theme to style the background before taking the screenshot.\n */\nexport function downloadShadowCalendar(\n  captureElement: HTMLDivElement,\n  theme: Theme\n): void {\n  const computed = window\n    .getComputedStyle(captureElement)\n    .getPropertyValue('left');\n\n  domtoimage\n    .toBlob(captureElement, {\n      width: captureElement.offsetWidth * PNG_SCALE_FACTOR,\n      height: captureElement.offsetHeight * PNG_SCALE_FACTOR,\n      style: {\n        transform: `scale(${PNG_SCALE_FACTOR})`,\n        'transform-origin': `${computed} 0px`,\n        'background-color': theme === 'light' ? '#FFFFFF' : '#333333',\n      },\n    })\n    .then((blob) => saveAs(blob, 'schedule.png'))\n    .catch((err) =>\n      softError(\n        new ErrorWithFields({\n          message:\n            'could not take screenshot of shadow calendar for schedule export',\n          source: err,\n        })\n      )\n    );\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type ButtonProps = {\n  className?: string;\n  disabled?: boolean;\n  href?: string;\n  onClick?: () => void;\n  children?: React.ReactNode;\n};\n\nexport default function Button({\n  className,\n  disabled = false,\n  href,\n  onClick,\n  children,\n}: ButtonProps): React.ReactElement {\n  if (disabled)\n    return (\n      <div className={classes('Button', 'disabled', className)}>{children}</div>\n    );\n\n  if (href != null)\n    return (\n      <a\n        className={classes('Button', className)}\n        href={href}\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        {children}\n      </a>\n    );\n\n  return (\n    <div\n      className={classes('Button', className)}\n      onClick={onClick}\n      tabIndex={0}\n      onKeyDown={(event): void => {\n        // Intercept enter presses\n        if (event.key === 'Enter' && onClick != null) onClick();\n      }}\n      role=\"button\"\n    >\n      {children}\n    </div>\n  );\n}\n","import React from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { classes } from '../../utils/misc';\nimport Button, { ButtonProps } from '../Button';\n\nimport './stylesheet.scss';\n\ntype FontAwesomeProps = React.ComponentProps<typeof FontAwesomeIcon>;\nexport type Action = {\n  icon: FontAwesomeProps['icon'];\n  styling?: React.CSSProperties;\n  dataTip?: boolean;\n  dataFor?: string;\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n} & Omit<ButtonProps, 'children'>;\n\ntype BaseActionRowProps = {\n  label: string;\n  actions: (Action | null | undefined)[];\n  className?: string;\n  children?: React.ReactNode;\n};\nexport type ActionRowProps = BaseActionRowProps &\n  Omit<React.HTMLAttributes<HTMLDivElement>, keyof BaseActionRowProps>;\n\nexport default function ActionRow({\n  className,\n  label,\n  children,\n  actions,\n  ...restProps\n}: ActionRowProps): React.ReactElement {\n  return (\n    <div className={classes('ActionRow', className)} {...restProps}>\n      <div className=\"action-row-header\">\n        <div className=\"label\">{label}</div>\n        <div className={classes('actions', 'default')}>\n          {actions\n            .flatMap((action) => (action != null ? [action] : []))\n            .map(\n              (\n                {\n                  icon,\n                  styling,\n                  dataTip,\n                  dataFor,\n                  onMouseEnter,\n                  onMouseLeave,\n                  ...rest\n                },\n                i\n              ) => (\n                <Button className=\"action\" {...rest} key={i}>\n                  <FontAwesomeIcon\n                    fixedWidth\n                    style={styling}\n                    icon={icon}\n                    data-tip={dataTip}\n                    data-for={dataFor}\n                    onMouseEnter={onMouseEnter}\n                    onMouseLeave={onMouseLeave}\n                  />\n                </Button>\n              )\n            )}\n        </div>\n      </div>\n      {children}\n    </div>\n  );\n}\n","import React from 'react';\n\nimport { ErrorWithFields } from '../log';\nimport { Theme } from '../types';\n\nexport type ThemeContextValue = [Theme, (next: Theme) => void];\nexport const ThemeContext = React.createContext<ThemeContextValue>([\n  'light',\n  (next: Theme): void => {\n    throw new ErrorWithFields({\n      message: 'empty ThemeContext.setTheme value being used',\n      fields: {\n        next,\n      },\n    });\n  },\n]);\n","import React from 'react';\n\nexport type TermsContextValue = string[];\nexport const TermsContext = React.createContext<TermsContextValue>([]);\n","import axios from 'axios';\n\nimport { Oscar, Section } from '.';\nimport {\n  CourseGpa,\n  CrawlerCourse,\n  CrawlerPrerequisites,\n  Period,\n} from '../../types';\nimport {\n  hasConflictBetween,\n  isLab,\n  isLecture,\n  isAxiosNetworkError,\n} from '../../utils/misc';\nimport { ErrorWithFields, softError } from '../../log';\n\ninterface SectionGroupMeeting {\n  days: string[];\n  period: Period | undefined;\n}\n\ninterface SectionGroup {\n  /**\n   * Equal to`JSON.stringify(this.sectionGroupMeetings)`\n   */\n  hash: string;\n  meetings: SectionGroupMeeting[];\n  sections: Section[];\n}\n\nexport default class Course {\n  id: string;\n\n  subject: string;\n\n  number: string;\n\n  title: string;\n\n  sections: Section[];\n\n  prereqs: CrawlerPrerequisites | undefined;\n\n  hasLab: boolean;\n\n  onlyLectures: Section[] | undefined;\n\n  onlyLabs: Section[] | undefined;\n\n  allInOnes: Section[] | undefined;\n\n  sectionGroups: Record<string, SectionGroup> | undefined;\n\n  term: string;\n\n  constructor(oscar: Oscar, courseId: string, data: CrawlerCourse) {\n    this.term = oscar.term;\n    const [title, sections, prereqs] = data;\n\n    this.id = courseId;\n    const [subject, number] = this.id.split(' ');\n    if (subject == null || number == null) {\n      throw new ErrorWithFields({\n        message: 'course ID could not be parsed',\n        fields: {\n          id: this.id,\n          subject,\n          number,\n          term: this.term,\n        },\n      });\n    }\n    this.subject = subject;\n    this.number = number;\n\n    this.title = title;\n    this.sections = Object.entries(sections).flatMap<Section>(\n      ([sectionId, sectionData]) => {\n        if (sectionData == null) return [];\n        try {\n          return [new Section(oscar, this, sectionId, sectionData)];\n        } catch (err) {\n          softError(\n            new ErrorWithFields({\n              message: 'could not construct Section bean',\n              source: err,\n              fields: {\n                courseId,\n                term: this.term,\n              },\n            })\n          );\n          return [];\n        }\n      }\n    );\n    this.prereqs = prereqs;\n\n    const onlyLectures = this.sections.filter(\n      (section) => isLecture(section) && !isLab(section)\n    );\n    const onlyLabs = this.sections.filter(\n      (section) => isLab(section) && !isLecture(section)\n    );\n    this.hasLab = !!onlyLectures.length && !!onlyLabs.length;\n    if (this.hasLab) {\n      for (const lecture of onlyLectures) {\n        lecture.associatedLabs = onlyLabs.filter((lab) =>\n          lab.id.startsWith(lecture.id)\n        );\n      }\n      for (const lab of onlyLabs) {\n        lab.associatedLectures = onlyLectures.filter((lecture) =>\n          lab.id.startsWith(lecture.id)\n        );\n      }\n      const lonelyLectures = onlyLectures.filter(\n        (lecture) => !lecture.associatedLabs.length\n      );\n      const lonelyLabs = onlyLabs.filter(\n        (lab) => !lab.associatedLectures.length\n      );\n      for (const lecture of lonelyLectures) {\n        lecture.associatedLabs = lonelyLabs.filter(\n          (lab) => !hasConflictBetween(lecture, lab)\n        );\n      }\n      for (const lab of lonelyLabs) {\n        lab.associatedLectures = lonelyLectures.filter(\n          (lecture) => !hasConflictBetween(lecture, lab)\n        );\n      }\n      this.onlyLectures = onlyLectures;\n      this.onlyLabs = onlyLabs;\n      this.allInOnes = this.sections.filter(\n        (section) => isLecture(section) && isLab(section)\n      );\n    } else {\n      this.sectionGroups = this.distinct(this.sections);\n    }\n  }\n\n  distinct(sections: Section[]): Record<string, SectionGroup> {\n    const groups: Record<string, SectionGroup> = {};\n    sections.forEach((section) => {\n      const sectionGroupMeetings = section.meetings.map<SectionGroupMeeting>(\n        ({ days, period }) => ({\n          days,\n          period,\n        })\n      );\n      const sectionGroupHash = JSON.stringify(sectionGroupMeetings);\n      const sectionGroup = groups[sectionGroupHash];\n      if (sectionGroup) {\n        sectionGroup.sections.push(section);\n      } else {\n        groups[sectionGroupHash] = {\n          hash: sectionGroupHash,\n          meetings: sectionGroupMeetings,\n          sections: [section],\n        };\n      }\n    });\n    return groups;\n  }\n\n  async fetchGpa(): Promise<CourseGpa> {\n    const base =\n      'https://c4citk6s9k.execute-api.us-east-1.amazonaws.com/test/data';\n    // We have to clean up the course ID before sending it to the API,\n    // since courses like CHEM 1212K should become CHEM 1212\n    const id = `${this.subject} ${this.number.replace(/\\D/g, '')}`;\n    const encodedCourse = encodeURIComponent(id);\n    const url = `${base}/course?courseID=${encodedCourse}`;\n\n    let responseData: CourseDetailsAPIResponse;\n    try {\n      responseData = (await axios.get<CourseDetailsAPIResponse>(url)).data;\n    } catch (err) {\n      // Ignore network errors\n      if (!isAxiosNetworkError(err)) {\n        softError(\n          new ErrorWithFields({\n            message: 'error fetching course details from Course Critique API',\n            source: err,\n            fields: {\n              baseId: this.id,\n              cleanedId: id,\n              url,\n              term: this.term,\n            },\n          })\n        );\n      }\n\n      return {};\n    }\n\n    // Extract the relevant fields from the response\n    // We catch (or even throw) errors here to defensively ensure that\n    // the data coming out of this function is safely typed\n    try {\n      const gpaMap: CourseGpa = {};\n\n      // Extract the course-wide average GPA\n      const rawAverageGpa = responseData.header[0].avg_gpa;\n      // If the field is null, then the course has no GPA information\n      if (rawAverageGpa === null) return {};\n      if (typeof rawAverageGpa !== 'number')\n        throw new ErrorWithFields({\n          message: `data at \".header[0].avg_gpa\" was not a number`,\n          fields: {\n            actual: rawAverageGpa,\n            term: this.term,\n          },\n        });\n      gpaMap.averageGpa = rawAverageGpa;\n\n      // Extract the GPA for each instructor\n      responseData.raw.forEach((instructorData, i) => {\n        // Extract the instructor's name\n        const rawInstructor = instructorData.instructor_name;\n        if (typeof rawInstructor !== 'string')\n          throw new ErrorWithFields({\n            message: `data at \".raw[idx].instructor_name\" was not a string`,\n            fields: {\n              idx: i,\n              actual: rawInstructor,\n              term: this.term,\n            },\n          });\n\n        // Extract the instructor's GPA\n        const instructorGpa = instructorData.GPA;\n        if (typeof instructorGpa !== 'number')\n          throw new ErrorWithFields({\n            message: `data at \".raw[idx].GPA\" was not a number`,\n            fields: {\n              idx: i,\n              actual: instructorGpa,\n              term: this.term,\n            },\n          });\n\n        // Normalize the instructor name from \"LN, FN\" to \"FN LN\"\n        let instructor = rawInstructor;\n        const nameSegments = instructor.split(', ');\n        if (nameSegments.length === 2) {\n          const [lastName, firstName] = nameSegments as [string, string];\n          instructor = `${firstName} ${lastName}`;\n        }\n\n        gpaMap[instructor] = instructorGpa;\n      });\n\n      return gpaMap;\n    } catch (err) {\n      softError(\n        new ErrorWithFields({\n          message:\n            'error extracting course GPA from Course Critique API response',\n          source: err,\n          fields: {\n            baseId: this.id,\n            cleanedId: id,\n            url,\n            term: this.term,\n          },\n        })\n      );\n      return {};\n    }\n  }\n}\n\n// Based on response for CS 6035 on 2021-08-28\n// from the Course Critique API.\n// Each field has `| unknown` added to ensure\n// that we narrow the type before using them.\ninterface CourseDetailsAPIResponse {\n  header: [\n    {\n      course_name: string | null | unknown;\n      description: string | null | unknown;\n      credits: number | null | unknown;\n      avg_gpa: number | null | unknown;\n      avg_a: number | null | unknown;\n      avg_b: number | null | unknown;\n      avg_c: number | null | unknown;\n      avg_d: number | null | unknown;\n      avg_f: number | null | unknown;\n      avg_w: number | null | unknown;\n      full_name: string | null | unknown;\n    }\n  ];\n  raw: Array<{\n    instructor_gt_username: string | unknown;\n    instructor_name: string | unknown;\n    link: string | unknown;\n    class_size_group: string | unknown;\n    GPA: number | unknown;\n    A: number | unknown;\n    B: number | unknown;\n    C: number | unknown;\n    D: number | unknown;\n    F: number | unknown;\n    W: number | unknown;\n    sections: number | unknown;\n  }>;\n}\n","import axios from 'axios';\nimport cheerio from 'cheerio';\n\nimport { unique } from '../../utils/misc';\nimport { DELIVERY_MODES, BACKEND_BASE_URL } from '../../constants';\nimport Course from './Course';\nimport Oscar from './Oscar';\nimport { CrawlerMeeting, Meeting } from '../../types';\n\nexport type Seating = [\n  seating:\n    | [] // Loading state\n    | [\n        // Loaded state\n        seatsCurrent: number,\n        seatsTotal: number,\n        waitlistCurrent: number,\n        waitlistTotal: number\n      ]\n    | string[], // Error state\n  fetchTime: number\n];\n\ntype SectionConstructionData = [\n  crn: string,\n  meetings: CrawlerMeeting[],\n  credits: number,\n  scheduleTypeIndex: number,\n  campusIndex: number,\n  attributeIndices: number[],\n  gradeBasisIndex: number\n];\n\nexport default class Section {\n  course: Course;\n\n  id: string;\n\n  crn: string;\n\n  seating: Seating;\n\n  credits: number;\n\n  scheduleType: string;\n\n  campus: string;\n\n  deliveryMode: string | undefined;\n\n  gradeBasis: string;\n\n  meetings: Meeting[];\n\n  instructors: string[];\n\n  // This field is initialized after construction inside `Course.constructor`\n  associatedLabs: Section[];\n\n  // This field is initialized after construction inside `Course.constructor`\n  associatedLectures: Section[];\n\n  term: string;\n\n  constructor(\n    oscar: Oscar,\n    course: Course,\n    sectionId: string,\n    data: SectionConstructionData\n  ) {\n    this.term = oscar.term;\n    const [\n      crn,\n      meetings,\n      credits,\n      scheduleTypeIndex,\n      campusIndex,\n      attributeIndices,\n      gradeBasisIndex,\n    ] = data;\n\n    this.course = course;\n    this.id = sectionId;\n    this.crn = crn;\n    this.seating = [[], 0];\n    this.credits = credits;\n    this.scheduleType = oscar.scheduleTypes[scheduleTypeIndex] ?? 'unknown';\n    this.campus = oscar.campuses[campusIndex] ?? 'unknown';\n\n    const attributes = attributeIndices\n      .map((attributeIndex) => oscar.attributes[attributeIndex])\n      .flatMap((attribute) => (attribute == null ? [] : [attribute]));\n    this.deliveryMode = attributes.find(\n      (attribute) => attribute in DELIVERY_MODES\n    );\n\n    this.gradeBasis = oscar.gradeBases[gradeBasisIndex] ?? 'unknown';\n    this.meetings = meetings.map<Meeting>(\n      ([\n        periodIndex,\n        days,\n        where,\n        locationIndex,\n        instructors,\n        dateRangeIndex,\n      ]) => ({\n        period: oscar.periods[periodIndex],\n        days: days === '&nbsp;' ? [] : days.split(''),\n        where,\n        location: oscar.locations[locationIndex] ?? null,\n        instructors: instructors.map((instructor) =>\n          instructor.replace(/ \\(P\\)$/, '')\n        ),\n        // We need some fallback here\n        dateRange: oscar.dateRanges[dateRangeIndex] ?? {\n          from: new Date(),\n          to: new Date(),\n        },\n      })\n    );\n    this.instructors = unique(\n      this.meetings\n        .map<string[]>(({ instructors }) => instructors)\n        .reduce((accum, instructors) => [...accum, ...instructors], [])\n    );\n\n    // These fields are initialized after construction\n    // inside `Course.constructor`\n    this.associatedLabs = [];\n    this.associatedLectures = [];\n  }\n\n  async fetchSeating(term: string): Promise<Seating> {\n    const prevDate = this.seating[1];\n    const currDate = Date.now();\n\n    if (currDate - prevDate > 300000) {\n      const url = `${BACKEND_BASE_URL}/proxy/class_section?term=${term}&crn=${this.crn}`;\n      return axios({\n        url,\n        method: 'get',\n        headers: {\n          'X-Requested-With': 'XMLHttpRequest',\n          'Content-Type': 'text/html',\n        },\n      })\n        .then((response) => {\n          const $ = cheerio.load(response.data);\n          const availabilityTable = $('.datadisplaytable .datadisplaytable');\n          const tableRow = availabilityTable.find('tr');\n\n          this.seating = [\n            [\n              parseInt(tableRow.eq(1).children('td').first().text(), 10),\n              parseInt(tableRow.eq(1).children('td').eq(1).text(), 10),\n              parseInt(tableRow.eq(2).children('td').first().text(), 10),\n              parseInt(tableRow.eq(2).children('td').eq(1).text(), 10),\n            ],\n            currDate,\n          ];\n\n          return this.seating;\n        })\n        .catch(() => [new Array(4).fill('N/A'), currDate]);\n    }\n    return this.seating;\n  }\n}\n","import { Combination } from '../../types';\n\nexport default class SortingOption {\n  label: string;\n\n  calculateFactor: (combo: Combination) => number;\n\n  constructor(label: string, calculateFactor: (combo: Combination) => number) {\n    this.label = label;\n    this.calculateFactor = calculateFactor;\n  }\n}\n","import { Course, Section, SortingOption } from '.';\nimport { hasConflictBetween, stringToTime } from '../../utils/misc';\nimport {\n  Combination,\n  Period,\n  DateRange,\n  Location,\n  CrawlerTermData,\n} from '../../types';\nimport { ErrorWithFields, softError } from '../../log';\n\n// `new Oscar(...)` gets the entirety of the crawler JSON data\ntype OscarConstructionDate = CrawlerTermData;\n\nexport default class Oscar {\n  periods: (Period | undefined)[];\n\n  dateRanges: DateRange[];\n\n  scheduleTypes: string[];\n\n  campuses: string[];\n\n  attributes: string[];\n\n  gradeBases: string[];\n\n  locations: (Location | null)[];\n\n  updatedAt: Date;\n\n  version: number;\n\n  courses: Course[];\n\n  courseMap: Record<string, Course>;\n\n  crnMap: Record<string, Section>;\n\n  sortingOptions: SortingOption[];\n\n  constructor(data: OscarConstructionDate, public term: string) {\n    const { courses, caches, updatedAt, version } = data;\n\n    this.periods = caches.periods.map((period, i) => {\n      if (period === 'TBA') {\n        return undefined;\n      }\n\n      const periodSegments = period.split(' - ');\n      if (periodSegments.length !== 2) {\n        softError(\n          new ErrorWithFields({\n            message: 'period did not follow expected format',\n            fields: {\n              period,\n              cacheIndex: i,\n              term: this.term,\n            },\n          })\n        );\n        return undefined;\n      }\n\n      const [start, end] = periodSegments as [string, string];\n      return {\n        start: stringToTime(start),\n        end: stringToTime(end),\n      };\n    });\n\n    this.dateRanges = caches.dateRanges.map((dateRange, i) => {\n      let segments = dateRange.split(' - ');\n      if (segments.length !== 2) {\n        softError(\n          new ErrorWithFields({\n            message: 'date range did not follow expected format',\n            fields: {\n              dateRange,\n              cacheIndex: i,\n              term: this.term,\n            },\n          })\n        );\n        // We need some fallback here\n        segments = ['Jan 1, 1970', 'Jan 2, 1970'];\n      }\n\n      const [from, to] = segments.map((v) => new Date(v)) as [Date, Date];\n      from.setHours(0);\n      to.setHours(23, 59, 59, 999);\n      return { from, to };\n    });\n\n    this.scheduleTypes = caches.scheduleTypes;\n    this.campuses = caches.campuses;\n    this.attributes = caches.attributes;\n    this.gradeBases = caches.gradeBases;\n    this.locations = caches.locations;\n    this.updatedAt = new Date(updatedAt);\n    this.version = version;\n\n    this.courses = Object.entries(courses).flatMap(([courseId, source]) => {\n      try {\n        return [new Course(this, courseId, source)];\n      } catch (err) {\n        softError(\n          new ErrorWithFields({\n            message: 'could not initialize Course bean',\n            fields: {\n              courseId,\n              source,\n              term: this.term,\n            },\n          })\n        );\n        return [];\n      }\n    });\n\n    this.courseMap = {};\n    this.crnMap = {};\n    this.courses.forEach((course) => {\n      this.courseMap[course.id] = course;\n      course.sections.forEach((section) => {\n        this.crnMap[section.crn] = section;\n      });\n    });\n\n    this.sortingOptions = [\n      new SortingOption('Most Compact', (combination) => {\n        const { startMap, endMap } = combination;\n        const diffs = Object.keys(startMap).map((day) => {\n          const end = endMap[day];\n          const start = startMap[day];\n          if (end == null || start == null) return 0;\n          return end - start;\n        });\n        const sum = diffs.reduce((tot, min) => tot + min, 0);\n        return +sum;\n      }),\n      new SortingOption('Earliest Ending', (combination) => {\n        const { endMap } = combination;\n        const ends = Object.values(endMap);\n        const sum = ends.reduce<number>((tot, end) => tot + (end ?? 0), 0);\n        const avg = sum / ends.length;\n        return +avg;\n      }),\n      new SortingOption('Latest Beginning', (combination) => {\n        const { startMap } = combination;\n        const starts = Object.values(startMap);\n        const sum = starts.reduce<number>((tot, min) => tot + (min ?? 0), 0);\n        const avg = sum / starts.length;\n        return -avg;\n      }),\n    ];\n  }\n\n  findCourse(courseId: string): Course | undefined {\n    return this.courseMap[courseId];\n  }\n\n  findSection(crn: string): Section | undefined {\n    return this.crnMap[crn];\n  }\n\n  getCombinations(\n    desiredCourses: readonly string[],\n    pinnedCrns: readonly string[],\n    excludedCrns: readonly string[]\n  ): Combination[] {\n    const crnsList: string[][] = [];\n    const dfs = (courseIndex = 0, crns: string[] = []): void => {\n      if (courseIndex === desiredCourses.length) {\n        crnsList.push(crns);\n        return;\n      }\n      const courseId = desiredCourses[courseIndex];\n      if (courseId === undefined) return;\n      const course = this.findCourse(courseId);\n      if (course === undefined) return;\n      const isIncluded = (section: Section): boolean =>\n        !excludedCrns.includes(section.crn);\n      const isPinned = (section: Section): boolean =>\n        pinnedCrns.includes(section.crn);\n      const hasConflict = (section: Section): boolean =>\n        [...pinnedCrns, ...crns].some((crn) => {\n          const crnSection = this.findSection(crn);\n          if (crnSection === undefined) return false;\n          return hasConflictBetween(crnSection, section);\n        });\n      if (course.hasLab) {\n        // If a course has a lab, then `onlyLectures`, `onlyLabs`,\n        // and `allInOnes` should be non-undefined, but we have to check\n        // anyways here to satisfy TypeScript\n        const pinnedOnlyLecture = (course.onlyLectures ?? []).find(isPinned);\n        const pinnedOnlyLab = (course.onlyLabs ?? []).find(isPinned);\n        const pinnedAllInOne = (course.allInOnes ?? []).find(isPinned);\n        if ((pinnedOnlyLecture && pinnedOnlyLab) || pinnedAllInOne) {\n          dfs(courseIndex + 1, crns);\n        } else if (pinnedOnlyLecture) {\n          pinnedOnlyLecture.associatedLabs.filter(isIncluded).forEach((lab) => {\n            if (hasConflict(lab)) return;\n            dfs(courseIndex + 1, [...crns, lab.crn]);\n          });\n        } else if (pinnedOnlyLab) {\n          pinnedOnlyLab.associatedLectures\n            .filter(isIncluded)\n            .forEach((lecture) => {\n              if (hasConflict(lecture)) return;\n              dfs(courseIndex + 1, [...crns, lecture.crn]);\n            });\n        } else {\n          (course.onlyLectures ?? []).filter(isIncluded).forEach((lecture) => {\n            if (hasConflict(lecture)) return;\n            lecture.associatedLabs.filter(isIncluded).forEach((lab) => {\n              if (hasConflict(lab)) return;\n              dfs(courseIndex + 1, [...crns, lecture.crn, lab.crn]);\n            });\n          });\n          (course.allInOnes ?? []).filter(isIncluded).forEach((section) => {\n            if (hasConflict(section)) return;\n            dfs(courseIndex + 1, [...crns, section.crn]);\n          });\n        }\n      } else if (course.sections.some(isPinned)) {\n        dfs(courseIndex + 1, crns);\n      } else {\n        // If a course does not have a lab, then `sectionGroups` should be\n        // non-undefined, but we have to check anyways here to satisfy\n        // TypeScript\n        Object.values(course.sectionGroups ?? {}).forEach((sectionGroup) => {\n          if (sectionGroup == null) return;\n          const section = sectionGroup.sections.find(isIncluded);\n          if (!section || hasConflict(section)) return;\n          dfs(courseIndex + 1, [...crns, section.crn]);\n        });\n      }\n    };\n    dfs();\n    return crnsList.map((crns) => {\n      const startMap: Record<string, number> = {};\n      const endMap: Record<string, number> = {};\n      this.iterateTimeBlocks([...pinnedCrns, ...crns], (day, period) => {\n        if (period === undefined) return;\n        const end = endMap[day];\n        const start = startMap[day];\n        if (start == null || start > period.start) startMap[day] = period.start;\n        if (end == null || end < period.end) endMap[day] = period.end;\n      });\n      return {\n        crns,\n        startMap,\n        endMap,\n      };\n    });\n  }\n\n  sortCombinations(\n    combinations: Combination[],\n    sortingOptionIndex: number\n  ): Combination[] {\n    const sortingOption = this.sortingOptions[sortingOptionIndex];\n    if (sortingOption === undefined) {\n      throw new ErrorWithFields({\n        message: `sorting option index was out of bounds`,\n        fields: {\n          sortingOptionIndex,\n          actualSortingOptionsLength: this.sortingOptions.length,\n          term: this.term,\n        },\n      });\n    }\n\n    return combinations\n      .map((combination) => ({\n        ...combination,\n        factor: sortingOption.calculateFactor(combination),\n      }))\n      .sort((a, b) => a.factor - b.factor);\n  }\n\n  iterateTimeBlocks(\n    crns: string[],\n    callback: (day: string, period: Period | undefined) => void\n  ): void {\n    crns.forEach((crn) => {\n      const section = this.findSection(crn);\n      if (section !== undefined) {\n        section.meetings.forEach(\n          (meeting) =>\n            meeting.period &&\n            meeting.days.forEach((day) => {\n              callback(day, meeting.period);\n            })\n        );\n      }\n    });\n  }\n}\n\n/**\n * Create an empty instance of the Oscar bean\n * to use as the default context value\n */\nexport const EMPTY_OSCAR = new Oscar(\n  {\n    courses: {},\n    caches: {\n      periods: [],\n      dateRanges: [],\n      scheduleTypes: [],\n      campuses: [],\n      attributes: [],\n      gradeBases: [],\n      locations: [],\n    },\n    // This converts the Date to the expected string\n    // that it serializes to in the crawler\n    updatedAt: JSON.parse(JSON.stringify(new Date())) as string,\n    version: 1,\n  },\n  '197008'\n);\n","import { Immutable } from 'immer';\n\n// These should always be the latest version of schedule data\nexport const LATEST_SCHEDULE_DATA_VERSION: ScheduleData['version'] = 1;\nexport type ScheduleData = Version1ScheduleData;\nexport type TermScheduleData = Version1TermScheduleData;\nexport type ScheduleVersion = Version1ScheduleVersion;\nexport type Schedule = Version1Schedule;\n\n// Add additional types here named like \"___OrNewer\" for each version,\n// where they are an alias for the version | Version+1ScheduleDataOrNewer.\n// For example, once version 2 is added, there would be two types:\n// type Version2ScheduleDataOrNewer = Version2ScheduleData;\n// type Version1ScheduleDataOrNewer =\n//   Version2ScheduleDataOrNewer | Version1ScheduleData;\nexport type Version1ScheduleDataOrNewer = Version1ScheduleData;\n\n// This type should automatically accept any schedule data\nexport type AnyScheduleData = Version1ScheduleDataOrNewer;\n\nexport const defaultTermScheduleData: Immutable<TermScheduleData> = {\n  versions: [],\n  currentIndex: 0,\n};\n\nexport const defaultSchedule: Immutable<Schedule> = {\n  desiredCourses: [],\n  pinnedCrns: [],\n  excludedCrns: [],\n  colorMap: {},\n  sortingOptionIndex: 0,\n};\n\n// Version 1 schedule data (2021-09-10)\n// ===================================\n//  - addition of schedule versions\n//  - migration from multiple cookies to single local storage key\n\nexport interface Version1ScheduleData {\n  terms: Record<string, Version1TermScheduleData>;\n  currentTerm: string;\n  version: 1;\n}\n\nexport interface Version1TermScheduleData {\n  versions: Version1ScheduleVersion[];\n  currentIndex: number;\n}\n\nexport interface Version1ScheduleVersion {\n  name: string;\n  schedule: Version1Schedule;\n}\n\nexport interface Version1Schedule {\n  desiredCourses: string[];\n  pinnedCrns: string[];\n  excludedCrns: string[];\n  colorMap: Record<string, string>;\n  sortingOptionIndex: number;\n}\n","import React from 'react';\nimport { Draft, Immutable } from 'immer';\n\nimport { Oscar } from '../data/beans';\nimport { EMPTY_OSCAR } from '../data/beans/Oscar';\nimport { defaultSchedule, Schedule } from '../data/types';\nimport { ErrorWithFields } from '../log';\n\nexport type ScheduleContextData = Immutable<Schedule> & {\n  readonly term: string;\n  readonly oscar: Oscar;\n};\n\nexport type ScheduleContextSetters = {\n  setTerm: (next: string) => void;\n  patchSchedule: (patch: Partial<Schedule>) => void;\n  updateSchedule: (\n    applyDraft: (draft: Draft<Schedule>) => void | Immutable<Schedule>\n  ) => void;\n};\nexport type ScheduleContextValue = [\n  ScheduleContextData,\n  ScheduleContextSetters\n];\nexport const ScheduleContext = React.createContext<ScheduleContextValue>([\n  {\n    term: '',\n    oscar: EMPTY_OSCAR,\n    ...defaultSchedule,\n  },\n  {\n    setTerm: (next: string): void => {\n      throw new ErrorWithFields({\n        message: 'empty ScheduleContext.setTerm value being used',\n        fields: {\n          next,\n        },\n      });\n    },\n    patchSchedule: (patch: Partial<Schedule>): void => {\n      throw new ErrorWithFields({\n        message: 'empty ScheduleContext.patchSchedule value being used',\n        fields: {\n          patch,\n        },\n      });\n    },\n    updateSchedule: (): void => {\n      throw new ErrorWithFields({\n        message: 'empty ScheduleContext.updateSchedule value being used',\n      });\n    },\n  },\n]);\n","import React from 'react';\n\nimport { ErrorWithFields } from '../log';\n\nexport type OverlayCrnsContextValue = [string[], (next: string[]) => void];\nexport const OverlayCrnsContext = React.createContext<OverlayCrnsContextValue>([\n  [],\n  (next: string[]): void => {\n    throw new ErrorWithFields({\n      message: 'empty OverlayCrnsContext.setOverlayCrns value being used',\n      fields: {\n        next,\n      },\n    });\n  },\n]);\n\nexport const a = 'ouleuouleuouleu';\n","import React, { useContext } from 'react';\nimport ReactTooltip from 'react-tooltip';\n\nimport { classes, getContentClassName, periodToString } from '../../utils/misc';\nimport { CLOSE, OPEN, DAYS } from '../../constants';\nimport { ScheduleContext } from '../../contexts';\nimport { Period } from '../../types';\n\nimport './stylesheet.scss';\n\nexport interface TimeBlockPosition {\n  rowIndex: number;\n  rowSize: number;\n  period: Period;\n  crn: string;\n}\n\nexport type SizeInfo = Record<string, Record<string, TimeBlockPosition>>;\n\nexport type TimeBlocksProps = {\n  className?: string;\n  crn: string;\n  overlay?: boolean;\n  capture: boolean;\n  preview: boolean;\n  isAutosized: boolean;\n  sizeInfo: SizeInfo;\n};\n\nexport function makeSizeInfoKey(period: Period): string {\n  return [period.start, period.end].join('-');\n}\n\nexport default function TimeBlocks({\n  className,\n  crn,\n  overlay = false,\n  preview,\n  capture,\n  isAutosized,\n  sizeInfo,\n}: TimeBlocksProps): React.ReactElement | null {\n  const [{ oscar, colorMap }] = useContext(ScheduleContext);\n\n  const section = oscar.findSection(crn);\n  if (section == null) return null;\n\n  const color = colorMap[section.course.id];\n  const contentClassName = getContentClassName(color);\n\n  return (\n    <div\n      className={classes(\n        'TimeBlocks',\n        capture && 'capture',\n        overlay && 'overlay',\n        className\n      )}\n    >\n      {section.meetings.map((meeting, i) => {\n        const { period } = meeting;\n        if (period == null) return;\n\n        const sizeInfoKey = makeSizeInfoKey(period);\n        return meeting.days.map((day) => {\n          const sizeInfoDay = sizeInfo[day];\n          if (sizeInfoDay == null) return;\n          const sizeInfoPeriodDay = sizeInfoDay[sizeInfoKey];\n          if (sizeInfoPeriodDay == null) return;\n\n          return (\n            <div\n              className={classes('meeting', contentClassName, 'default', day)}\n              key={[i, day].join('-')}\n              style={{\n                top: `${((period.start - OPEN) / (CLOSE - OPEN)) * 100}%`,\n                height: `${\n                  ((period.end - period.start) / (CLOSE - OPEN)) * 100\n                }%`,\n                width: `${20 / sizeInfoPeriodDay.rowSize}%`,\n                left: `${\n                  DAYS.indexOf(day) * 20 +\n                  sizeInfoPeriodDay.rowIndex * (20 / sizeInfoPeriodDay.rowSize)\n                }%`,\n                backgroundColor: color,\n              }}\n              data-tip\n              data-for={crn}\n            >\n              {!preview && (\n                <div className=\"meeting-wrapper\">\n                  <div className=\"ids\">\n                    <span className=\"course-id\">{section.course.id}</span>\n                    <span className=\"section-id\">&nbsp;{section.id}</span>\n                  </div>\n                  <span className=\"period\">{periodToString(period)}</span>\n                  <span className=\"where\">{meeting.where}</span>\n                  <span className=\"instructors\">\n                    {meeting.instructors.join(', ')}\n                  </span>\n                </div>\n              )}\n            </div>\n          );\n        });\n      })}\n\n      {!isAutosized && (\n        <ReactTooltip\n          id={crn}\n          className=\"tooltip\"\n          type=\"dark\"\n          place=\"top\"\n          effect=\"solid\"\n        >\n          <table>\n            <tbody>\n              <tr>\n                <td>\n                  <b>Course Name</b>\n                </td>\n                <td>{section.course.title}</td>\n              </tr>\n              <tr>\n                <td>\n                  <b>Delivery Type</b>\n                </td>\n                <td>{section.deliveryMode}</td>\n              </tr>\n              <tr>\n                <td>\n                  <b>Course Number</b>\n                </td>\n                <td>{section.crn}</td>\n              </tr>\n              <tr>\n                <td>\n                  <b>Credit Hours</b>\n                </td>\n                <td>{section.credits}</td>\n              </tr>\n            </tbody>\n          </table>\n        </ReactTooltip>\n      )}\n    </div>\n  );\n}\n","import React, { useContext } from 'react';\n\nimport { CLOSE, DAYS, OPEN } from '../../constants';\nimport { classes, timeToShortString } from '../../utils/misc';\nimport { TimeBlocks } from '..';\nimport { ScheduleContext } from '../../contexts';\nimport { makeSizeInfoKey, TimeBlockPosition } from '../TimeBlocks';\nimport { Period } from '../../types';\n\nimport './stylesheet.scss';\n\nexport type CalendarProps = {\n  className?: string;\n  overlayCrns: string[];\n  preview?: boolean;\n  capture?: boolean;\n  isAutosized?: boolean;\n};\n\nexport default function Calendar({\n  className,\n  overlayCrns,\n  preview = false,\n  capture = false,\n  isAutosized = false,\n}: CalendarProps): React.ReactElement {\n  const [{ pinnedCrns, oscar }] = useContext(ScheduleContext);\n\n  // Contains the rowIndex's and rowSize's passed into each crn's TimeBlocks\n  // e.g. crnSizeInfo[crn][day][\"period.start-period.end\"].rowIndex\n  const crnSizeInfo: Record<\n    string,\n    Record<string, Record<string, TimeBlockPosition>>\n  > = {};\n\n  // Recursively sets the rowSize of all time blocks within the current\n  // connected grouping of blocks to the current block's rowSize\n  const updateJoinedRowSizes = (\n    periodInfos: TimeBlockPosition[],\n    seen: Set<string>,\n    curCrn: string,\n    curPeriod: Period,\n    newRowSize: number\n  ): void => {\n    if (seen.has(curCrn)) {\n      return;\n    }\n    seen.add(curCrn);\n\n    periodInfos\n      .filter(\n        (period2Info) =>\n          period2Info.period.start < curPeriod.end &&\n          period2Info.period.end > curPeriod.start\n      )\n      .forEach((period2Info) => {\n        period2Info.rowSize = newRowSize;\n        updateJoinedRowSizes(\n          periodInfos,\n          seen,\n          period2Info.crn,\n          period2Info.period,\n          newRowSize\n        );\n      });\n  };\n\n  const crns = Array.from(new Set([...pinnedCrns, ...(overlayCrns || [])]));\n  const maxMeetingLen = (crn: string): number => {\n    const section = oscar.findSection(crn);\n    if (section == null) return 0;\n    return Math.max(\n      ...section.meetings.flatMap(({ period }) => {\n        if (period == null) return [];\n        return [period.end - period.start];\n      })\n    );\n  };\n\n  crns.sort((a, b) => maxMeetingLen(a) - maxMeetingLen(b));\n\n  // Populates crnSizeInfo by iteratively finding the next time block's\n  // rowSize and rowIndex (1 more than greatest of already processed connected\n  // blocks), updating the processed connected blocks to match its rowSize\n  crns.forEach((crn) => {\n    const section = oscar.findSection(crn);\n    if (section == null) return;\n\n    section.meetings\n      .filter((m) => m.period)\n      .forEach((meeting) => {\n        const { period } = meeting;\n        if (period == null) return;\n\n        meeting.days.forEach((day) => {\n          const dayPeriodInfos = Object.values(crnSizeInfo)\n            .flatMap<TimeBlockPosition | undefined>((days) =>\n              days != null ? Object.values(days[day] ?? {}) : []\n            )\n            .flatMap<TimeBlockPosition>((info) => (info == null ? [] : [info]));\n\n          const curRowSize = dayPeriodInfos\n            .filter(\n              (period2Info) =>\n                period2Info.period.start < period.end &&\n                period2Info.period.end > period.start\n            )\n            .reduce(\n              (acc, period2Info) => Math.max(acc, period2Info.rowSize + 1),\n              1\n            );\n\n          updateJoinedRowSizes(\n            dayPeriodInfos,\n            new Set(),\n            crn,\n            period,\n            curRowSize\n          );\n\n          const courseSizeInfo = crnSizeInfo[crn] || {};\n          crnSizeInfo[crn] = courseSizeInfo;\n\n          const daySizeInfo = courseSizeInfo[day] || {};\n          courseSizeInfo[day] = daySizeInfo;\n\n          daySizeInfo[makeSizeInfoKey(period)] = {\n            period,\n            crn,\n            rowIndex: curRowSize - 1,\n            rowSize: curRowSize,\n          };\n        });\n      });\n  });\n\n  return (\n    <div\n      className={classes(\n        'Calendar',\n        capture && 'capture',\n        preview && 'preview',\n        className\n      )}\n    >\n      {!preview && (\n        <div className=\"times\">\n          {new Array((CLOSE - OPEN) / 60).fill(0).map((_, i) => {\n            const time = OPEN + i * 60;\n            return (\n              <div className=\"time\" key={time}>\n                <span className=\"label\">{timeToShortString(time)}</span>\n              </div>\n            );\n          })}\n        </div>\n      )}\n      {!preview && (\n        <div className=\"days\">\n          {DAYS.map((day) => (\n            <div className=\"day\" key={day}>\n              <span className=\"label\">{day}</span>\n            </div>\n          ))}\n        </div>\n      )}\n      <div className=\"meetings\">\n        {pinnedCrns.map((crn) => (\n          <TimeBlocks\n            key={crn}\n            crn={crn}\n            preview={preview}\n            capture={capture}\n            isAutosized={isAutosized}\n            sizeInfo={crnSizeInfo[crn] ?? {}}\n          />\n        ))}\n        {overlayCrns &&\n          overlayCrns\n            .filter((crn) => !pinnedCrns.includes(crn))\n            .map((crn) => (\n              <TimeBlocks\n                key={crn}\n                crn={crn}\n                overlay={!preview}\n                preview={preview}\n                capture={capture}\n                isAutosized\n                sizeInfo={crnSizeInfo[crn] ?? {}}\n              />\n            ))}\n      </div>\n    </div>\n  );\n}\n","import React, { useCallback, useContext, useMemo } from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\n\nimport { Button, Calendar, Select } from '..';\nimport { OverlayCrnsContext, ScheduleContext } from '../../contexts';\nimport { Combination } from '../../types';\n\nimport 'react-virtualized/styles.css';\nimport './stylesheet.scss';\n\nexport default function CombinationContainer(): React.ReactElement {\n  const [\n    { oscar, desiredCourses, pinnedCrns, excludedCrns, sortingOptionIndex },\n    { patchSchedule },\n  ] = useContext(ScheduleContext);\n  const [, setOverlayCrns] = useContext(OverlayCrnsContext);\n\n  const handleResetPinnedCrns = useCallback(() => {\n    if (window.confirm('Are you sure to reset sections you selected?')) {\n      patchSchedule({\n        pinnedCrns: [],\n      });\n    }\n  }, [patchSchedule]);\n\n  const combinations = useMemo(\n    () => oscar.getCombinations(desiredCourses, pinnedCrns, excludedCrns),\n    [oscar, desiredCourses, pinnedCrns, excludedCrns]\n  );\n  const sortedCombinations = useMemo(\n    () => oscar.sortCombinations(combinations, sortingOptionIndex),\n    [oscar, combinations, sortingOptionIndex]\n  );\n\n  return (\n    <div className=\"CombinationContainer\">\n      <Select\n        onChange={(newSortingOptionIndex): void =>\n          patchSchedule({ sortingOptionIndex: newSortingOptionIndex })\n        }\n        value={sortingOptionIndex}\n        options={oscar.sortingOptions.map((sortingOption, i) => ({\n          value: i,\n          label: sortingOption.label,\n        }))}\n      />\n      <Button\n        className=\"reset\"\n        onClick={handleResetPinnedCrns}\n        disabled={pinnedCrns.length === 0}\n      >\n        Reset Sections\n      </Button>\n      <div className=\"scroller\">\n        <AutoSizer>\n          {({ width, height }): React.ReactElement => (\n            <List\n              width={width}\n              height={height}\n              style={{ outline: 'none' }}\n              rowCount={sortedCombinations.length}\n              rowHeight={108}\n              rowRenderer={({ index, key, style }): React.ReactElement => {\n                const { crns } = sortedCombinations[index] as Combination;\n                return (\n                  <div className=\"list-item\" style={style} key={key}>\n                    <div\n                      className=\"combination\"\n                      onMouseEnter={(): void => setOverlayCrns(crns)}\n                      onMouseLeave={(): void => setOverlayCrns([])}\n                      onClick={(): void =>\n                        patchSchedule({\n                          pinnedCrns: [...pinnedCrns, ...crns],\n                        })\n                      }\n                    >\n                      <div className=\"number\">{index + 1}</div>\n                      <Calendar\n                        className=\"calendar-preview\"\n                        overlayCrns={crns}\n                        isAutosized\n                        preview\n                      />\n                    </div>\n                  </div>\n                );\n              }}\n            />\n          )}\n        </AutoSizer>\n      </div>\n    </div>\n  );\n}\n","export const cancelledSymbol = Symbol('__#Cancellable-cancelled-symbol');\n\n/**\n * Gives an awaitable class (via `promise`) that can be cancelled at any time.\n * Useful when combined with `Promise.race` to cancel background tasks.\n */\nexport default class Cancellable {\n  isCancelled: boolean;\n\n  cancel: () => void;\n\n  promise: Promise<symbol>;\n\n  constructor() {\n    this.isCancelled = false;\n    this.cancel = (): void => undefined;\n    this.promise = new Promise<symbol>((resolve) => {\n      this.cancel = (): void => {\n        this.isCancelled = true;\n        resolve(cancelledSymbol);\n      };\n    });\n  }\n\n  /**\n   * Runs a promise to completion, returning its value.\n   * However, if this operation was cancelled before the promise completed,\n   * then it instead returns an object with `cancelled` true.\n   * The promise will still complete, but its value will be ignored.\n   */\n  async perform<T>(\n    other: Promise<T>\n  ): Promise<{ cancelled: true } | { cancelled: false; value: T }> {\n    const result = await Promise.race([this.promise, other]);\n\n    if (result === cancelledSymbol) {\n      return { cancelled: true };\n    }\n\n    return {\n      cancelled: false,\n      value: result as T,\n    };\n  }\n}\n","import React, { useCallback, useContext, useEffect, useState } from 'react';\nimport {\n  faAngleDown,\n  faAngleUp,\n  faInfoCircle,\n  faShareAlt,\n  faPalette,\n  faPlus,\n  faTrash,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { classes, getContentClassName } from '../../utils/misc';\nimport Cancellable from '../../utils/cancellable';\nimport { ActionRow, Instructor, Palette, Prerequisite } from '..';\nimport { ScheduleContext } from '../../contexts';\nimport { Course as CourseBean, Section } from '../../data/beans';\nimport { CourseGpa, CrawlerPrerequisites } from '../../types';\nimport { ErrorWithFields, softError } from '../../log';\n\nimport './stylesheet.scss';\n\nexport type CourseProps = {\n  className?: string;\n  courseId: string;\n  onAddCourse?: () => void;\n};\n\nexport default function Course({\n  className,\n  courseId,\n  onAddCourse,\n}: CourseProps): React.ReactElement | null {\n  const [expanded, setExpanded] = useState<boolean>(false);\n  const [prereqOpen, setPrereqOpen] = useState<boolean>(false);\n  const [paletteShown, setPaletteShown] = useState<boolean>(false);\n  const [gpaMap, setGpaMap] = useState<CourseGpa | null>(null);\n  const isSearching = Boolean(onAddCourse);\n  const [\n    { oscar, term, desiredCourses, pinnedCrns, excludedCrns, colorMap },\n    { patchSchedule },\n  ] = useContext(ScheduleContext);\n\n  useEffect(() => {\n    const course = oscar.findCourse(courseId);\n    if (course == null) return;\n    if (isSearching) return;\n\n    // Allow the operation to be cancelled early (if the component unmounts)\n    const loadOperation = new Cancellable();\n    async function loadCourseGpa(): Promise<void> {\n      if (course == null) return;\n\n      const promise = course.fetchGpa();\n      const result = await loadOperation.perform(promise);\n      if (!result.cancelled) {\n        setGpaMap(result.value);\n      }\n    }\n\n    loadCourseGpa().catch((err) => {\n      softError(\n        new ErrorWithFields({\n          message: 'error fetching course GPA',\n          source: err,\n          fields: {\n            courseId,\n            term: course.term,\n          },\n        })\n      );\n    });\n\n    return (): void => {\n      loadOperation.cancel();\n    };\n  }, [isSearching, oscar, courseId]);\n\n  const handleRemoveCourse = useCallback(\n    (course: CourseBean) => {\n      const newColorMap = { ...colorMap };\n      delete newColorMap[course.id];\n\n      patchSchedule({\n        desiredCourses: desiredCourses.filter((id) => id !== course.id),\n        pinnedCrns: pinnedCrns.filter(\n          (crn) => !course.sections.some((section) => section.crn === crn)\n        ),\n        excludedCrns: excludedCrns.filter(\n          (crn) => !course.sections.some((section) => section.crn === crn)\n        ),\n        colorMap: newColorMap,\n      });\n    },\n    [desiredCourses, pinnedCrns, excludedCrns, colorMap, patchSchedule]\n  );\n\n  const handleIncludeSections = useCallback(\n    (sections: Section[]) => {\n      const crns = sections.map((section) => section.crn);\n      patchSchedule({\n        excludedCrns: excludedCrns.filter((crn) => !crns.includes(crn)),\n      });\n    },\n    [excludedCrns, patchSchedule]\n  );\n\n  const course = oscar.findCourse(courseId);\n  if (course == null) return null;\n\n  const color = colorMap[course.id];\n  const contentClassName = color != null && getContentClassName(color);\n\n  const hasPrereqs = oscar.version > 1;\n  let prereqs: CrawlerPrerequisites | null = null;\n  if (hasPrereqs) {\n    prereqs = course.prereqs ?? [];\n  }\n\n  const instructorMap: Record<string, Section[] | undefined> = {};\n  course.sections.forEach((section) => {\n    const [primaryInstructor = 'Not Assigned'] = section.instructors;\n\n    const instructorSections = instructorMap[primaryInstructor] ?? [];\n    instructorSections.push(section);\n    instructorMap[primaryInstructor] = instructorSections;\n  });\n\n  const instructors = Object.keys(instructorMap);\n  const excludedInstructors = instructors.filter((instructor) => {\n    const sections = instructorMap[instructor];\n    if (sections == null) return false;\n    return sections.every((section) => excludedCrns.includes(section.crn));\n  });\n  const includedInstructors = instructors.filter(\n    (instructor) => !excludedInstructors.includes(instructor)\n  );\n\n  const prereqControl = (\n    nextPrereqOpen: boolean,\n    nextExpanded: boolean\n  ): void => {\n    setPrereqOpen(nextPrereqOpen);\n    setExpanded(nextExpanded);\n  };\n  const prereqAction = {\n    icon: faShareAlt,\n    styling: { transform: 'rotate(90deg)' },\n    onClick: (): void => {\n      prereqControl(true, !prereqOpen ? true : !expanded);\n    },\n  };\n\n  const infoAction = {\n    icon: faInfoCircle,\n    href:\n      `https://oscar.gatech.edu/pls/bprod/bwckctlg.p_disp_` +\n      `course_detail?cat_term_in=${term}&subj_code_in=` +\n      `${course.subject}&crse_numb_in=${course.number}`,\n  };\n\n  const pinnedSections = course.sections.filter((section) =>\n    pinnedCrns.includes(section.crn)\n  );\n  const totalCredits = pinnedSections.reduce(\n    (credits, section) => credits + section.credits,\n    0\n  );\n\n  return (\n    <div\n      className={classes('Course', contentClassName, 'default', className)}\n      style={{ backgroundColor: color }}\n      key={course.id}\n    >\n      <ActionRow\n        label={[\n          course.id,\n          pinnedSections.map((section) => section.id).join(', '),\n        ].join(' ')}\n        actions={\n          isSearching\n            ? [\n                { icon: faPlus, onClick: onAddCourse },\n                hasPrereqs ? prereqAction : infoAction,\n              ]\n            : [\n                {\n                  icon: expanded ? faAngleUp : faAngleDown,\n                  onClick: (): void => prereqControl(false, !expanded),\n                },\n                hasPrereqs ? prereqAction : infoAction,\n                {\n                  icon: faPalette,\n                  onClick: (): void => setPaletteShown(!paletteShown),\n                },\n                {\n                  icon: faTrash,\n                  onClick: (): void => handleRemoveCourse(course),\n                },\n              ]\n        }\n      >\n        <div className=\"course-row\">\n          <span className=\"course-title\">{course.title}</span>\n          <span className=\"section-crns\">\n            {pinnedSections.map((section) => section.crn).join(', ')}\n          </span>\n        </div>\n        {!isSearching && (\n          <div className=\"course-row\">\n            <span className=\"gpa\">\n              Course GPA:{' '}\n              {gpaMap === null\n                ? 'Loading...'\n                : gpaMap.averageGpa\n                ? gpaMap.averageGpa.toFixed(2)\n                : 'N/A'}\n            </span>\n            {totalCredits > 0 && (\n              <span className=\"credits\">{totalCredits} Credits</span>\n            )}\n          </div>\n        )}\n        {paletteShown && (\n          <Palette\n            className=\"palette\"\n            onSelectColor={(col): void =>\n              patchSchedule({ colorMap: { ...colorMap, [courseId]: col } })\n            }\n            color={color ?? null}\n            onMouseLeave={(): void => setPaletteShown(false)}\n          />\n        )}\n      </ActionRow>\n      {expanded && !prereqOpen && (\n        <div className={classes('hover-container', 'nested')}>\n          {includedInstructors.map((name) => {\n            let instructorGpa: number | undefined = 0;\n            if (gpaMap !== null) {\n              instructorGpa = gpaMap[name];\n            }\n            return (\n              <Instructor\n                key={name}\n                color={color}\n                name={name}\n                sections={instructorMap[name] ?? []}\n                gpa={\n                  gpaMap === null\n                    ? 'Loading...'\n                    : instructorGpa\n                    ? instructorGpa.toFixed(2)\n                    : 'N/A'\n                }\n              />\n            );\n          })}\n          {excludedInstructors.length > 0 && (\n            <div className=\"excluded-instructor-container\">\n              {excludedInstructors.map((name) => (\n                <span\n                  className=\"excluded-instructor\"\n                  key={name}\n                  onClick={(): void => {\n                    const instructorSections = instructorMap[name];\n                    if (instructorSections == null) return;\n                    handleIncludeSections(instructorSections);\n                  }}\n                >\n                  {name}\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n      {expanded && prereqOpen && prereqs !== null && (\n        <Prerequisite course={course} prereqs={prereqs} />\n      )}\n    </div>\n  );\n}\n","import React, {\n  ChangeEvent,\n  KeyboardEvent,\n  useCallback,\n  useContext,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\n\nimport { Course, CourseFilter } from '..';\nimport { classes, getRandomColor } from '../../utils/misc';\nimport { ASYNC_DELIVERY_MODE, CAMPUSES, DELIVERY_MODES } from '../../constants';\nimport { ScheduleContext } from '../../contexts';\nimport { Course as CourseBean, Section } from '../../data/beans';\n\nimport './stylesheet.scss';\n\nexport type CourseAddProps = {\n  className?: string;\n};\n\ntype SortKey = 'deliveryMode' | 'campus';\n\ntype SortFilter = {\n  [sortKey in SortKey]: string[];\n};\n\nfunction isSortKey(sortKey: string): sortKey is SortKey {\n  switch (sortKey) {\n    case 'deliveryMode':\n    case 'campus':\n      return true;\n    default:\n      return false;\n  }\n}\n\nfunction doesFilterMatchCourse(\n  course: CourseBean,\n  filter: SortFilter\n): boolean {\n  return Object.entries(filter).every(([key, tags]) => {\n    if (!isSortKey(key)) return true;\n\n    return (\n      tags.length === 0 ||\n      course.sections.some((section) => {\n        const sortValue = section[key];\n        if (sortValue == null) return false;\n\n        return tags.includes(sortValue);\n      })\n    );\n  });\n}\n\nfunction doesFilterMatchSection(section: Section, filter: SortFilter): boolean {\n  return Object.entries(filter).every(([key, tags]) => {\n    if (tags.length === 0) return true;\n    if (!isSortKey(key)) return true;\n\n    const sortValue = section[key];\n    if (sortValue == null) return false;\n\n    return tags.includes(sortValue);\n  });\n}\n\nexport default function CourseAdd({\n  className,\n}: CourseAddProps): React.ReactElement {\n  const [{ oscar, desiredCourses, excludedCrns, colorMap }, { patchSchedule }] =\n    useContext(ScheduleContext);\n  const [keyword, setKeyword] = useState('');\n  const [filter, setFilter] = useState<SortFilter>({\n    deliveryMode: [],\n    campus: [],\n  });\n  const [activeIndex, setActiveIndex] = useState(0);\n  const inputRef = useRef<HTMLInputElement | null>(null);\n\n  const handleChangeKeyword = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      let input = e.target.value.trim();\n      const results = /^([A-Z]+)(\\d.*)$/i.exec(input);\n      if (results != null) {\n        const [, subject, number] = results as unknown as [\n          string,\n          string,\n          string\n        ];\n        input = `${subject} ${number}`;\n      }\n      setKeyword(input);\n    },\n    []\n  );\n\n  const courses = useMemo(() => {\n    const results = /^([A-Z]+) ?((\\d.*)?)$/i.exec(keyword.toUpperCase());\n    if (!results) {\n      return [];\n    }\n    const [, subject, number] = results as unknown as [string, string, string];\n\n    setActiveIndex(0);\n\n    return oscar.courses\n      .filter((course) => {\n        const keywordMatch =\n          course.subject === subject && course.number.startsWith(number);\n        const filterMatch = doesFilterMatchCourse(course, filter);\n        return keywordMatch && filterMatch;\n      })\n      .filter((course) => !desiredCourses.includes(course.id));\n  }, [oscar, keyword, filter, desiredCourses]);\n\n  const handleAddCourse = useCallback(\n    (course: CourseBean) => {\n      if (desiredCourses.includes(course.id)) return;\n      const toBeExcludedCrns = course.sections\n        .filter((section) => {\n          const timeDecided =\n            section.deliveryMode === ASYNC_DELIVERY_MODE ||\n            (section.meetings.length &&\n              section.meetings.every(\n                (meeting) => meeting.days.length && meeting.period\n              ));\n          const filterMatch = doesFilterMatchSection(section, filter);\n          return !timeDecided || !filterMatch;\n        })\n        .map((section) => section.crn);\n      patchSchedule({\n        desiredCourses: [...desiredCourses, course.id],\n        excludedCrns: [...excludedCrns, ...toBeExcludedCrns],\n        colorMap: { ...colorMap, [course.id]: getRandomColor() },\n      });\n      setKeyword('');\n      inputRef.current?.focus();\n    },\n    [filter, desiredCourses, excludedCrns, colorMap, inputRef, patchSchedule]\n  );\n\n  const handleKeyDown = useCallback(\n    (e: KeyboardEvent<HTMLInputElement>) => {\n      switch (e.key) {\n        case 'Enter': {\n          const course = courses[activeIndex];\n          if (course != null) {\n            handleAddCourse(course);\n          }\n          break;\n        }\n        case 'ArrowDown':\n          setActiveIndex(Math.min(activeIndex + 1, courses.length - 1));\n          break;\n        case 'ArrowUp':\n          setActiveIndex(Math.max(activeIndex - 1, 0));\n          break;\n        default:\n          return;\n      }\n      e.preventDefault();\n    },\n    [courses, handleAddCourse, activeIndex]\n  );\n\n  const handleToggleFilter = useCallback(\n    (key: SortKey, tag: string) => {\n      const tags = filter[key];\n      setFilter({\n        ...filter,\n        [key]: tags.includes(tag)\n          ? tags.filter((v) => v !== tag)\n          : [...tags, tag],\n      });\n    },\n    [filter]\n  );\n\n  const handleResetFilter = useCallback(\n    (key) => {\n      setFilter({\n        ...filter,\n        [key]: [],\n      });\n    },\n    [filter]\n  );\n\n  const activeCourse = courses[activeIndex];\n\n  return (\n    <div className={classes('CourseAdd', className)}>\n      <div className=\"add\">\n        <div className=\"primary\">\n          <FontAwesomeIcon\n            className={classes('icon', courses.length > 0 && 'active')}\n            fixedWidth\n            icon={faPlus}\n          />\n          <div className=\"keyword-wrapper\">\n            {activeCourse && (\n              <div className={classes('keyword', 'autocomplete')}>\n                {activeCourse.id}\n              </div>\n            )}\n            <input\n              type=\"text\"\n              ref={inputRef}\n              value={keyword}\n              onChange={handleChangeKeyword}\n              className=\"keyword\"\n              placeholder=\"XX 0000\"\n              onKeyDown={handleKeyDown}\n            />\n          </div>\n        </div>\n        {[\n          ['Delivery Mode', 'deliveryMode', DELIVERY_MODES] as const,\n          ['Campus', 'campus', CAMPUSES] as const,\n        ].map(([name, property, labels]) => (\n          <CourseFilter\n            key={property}\n            name={name}\n            labels={labels}\n            selectedTags={filter[property]}\n            onReset={(): void => handleResetFilter(property)}\n            onToggle={(tag): void => handleToggleFilter(property, tag)}\n          />\n        ))}\n      </div>\n      {courses.length > 0 ? (\n        courses.map((course) => (\n          <Course\n            key={course.id}\n            className={classes(course === activeCourse && 'active')}\n            courseId={course.id}\n            onAddCourse={(): void => handleAddCourse(course)}\n          />\n        ))\n      ) : (\n        <div className=\"disclaimer\">\n          Disclaimer: GT Scheduler should be used as general reference only, and\n          users are solely responsible for ensuring any information including\n          registration restrictions.\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useContext } from 'react';\nimport ago from 's-ago';\n\nimport { Button, Course, CourseAdd } from '..';\nimport { ScheduleContext } from '../../contexts';\n\nimport 'react-virtualized/styles.css';\nimport './stylesheet.scss';\n\nexport default function CourseContainer(): React.ReactElement {\n  const [{ oscar, desiredCourses }] = useContext(ScheduleContext);\n\n  return (\n    <div className=\"CourseContainer\">\n      <div className=\"scroller\">\n        <div className=\"course-list\">\n          {desiredCourses.map((courseId) => {\n            return <Course courseId={courseId} key={courseId} />;\n          })}\n        </div>\n        <CourseAdd className=\"course-add\" />\n      </div>\n      <Button\n        className=\"updated-at\"\n        href=\"https://github.com/gt-scheduler/crawler\"\n      >\n        Course data fetched {ago(oscar.updatedAt)}\n      </Button>\n    </div>\n  );\n}\n","import React, { useState } from 'react';\nimport { faAngleDown, faAngleUp } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { classes, humanizeArrayReact } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type CourseFilterProps = {\n  name: string;\n  labels: Record<string, string>;\n  selectedTags: string[];\n  onReset: () => void;\n  onToggle: (tag: string) => void;\n};\n\nexport default function CourseFilter({\n  name,\n  labels,\n  selectedTags,\n  onReset,\n  onToggle,\n}: CourseFilterProps): React.ReactElement {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <div className=\"CourseFilter\">\n      <div\n        className={classes('header', selectedTags.length > 0 && 'active')}\n        onClick={(): void => setExpanded(!expanded)}\n      >\n        {!expanded && selectedTags.length > 0 ? (\n          <div className=\"name\">\n            {humanizeArrayReact(\n              selectedTags.flatMap<string>((tag) => {\n                const selectedTag = labels[tag];\n                return selectedTag != null ? [selectedTag] : [];\n              }),\n              <span className=\"or\">or</span>\n            )}\n          </div>\n        ) : (\n          <div className=\"name\">{name}</div>\n        )}\n        <FontAwesomeIcon fixedWidth icon={expanded ? faAngleUp : faAngleDown} />\n      </div>\n      {expanded && (\n        <div className=\"tag-container\">\n          <div\n            className={classes('tag', selectedTags.length === 0 && 'active')}\n            onClick={onReset}\n          >\n            All\n          </div>\n          {Object.keys(labels).map((tag) => (\n            <div\n              key={tag}\n              className={classes('tag', selectedTags.includes(tag) && 'active')}\n              property={tag}\n              onClick={(): void => onToggle(tag)}\n            >\n              {labels[tag]}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Tries to guess whether a term string is really a term or not.\n * Terms are of the form \"202008\", where the first 4 digits are a year\n * and the last 2 are a month.\n */\nexport function isTerm(maybeTerm: string): boolean {\n  if (maybeTerm.length !== 6) return false;\n  const [year, month] = [maybeTerm.substring(0, 4), maybeTerm.substring(4, 6)];\n  const [yearAsNumber, monthAsNumber] = [Number(year), Number(month)];\n  if (Number.isNaN(yearAsNumber) || yearAsNumber < 1970 || monthAsNumber > 2100)\n    return false;\n  if (Number.isNaN(monthAsNumber) || monthAsNumber < 0 || monthAsNumber > 12)\n    return false;\n\n  return true;\n}\n\n/**\n * Gets the human-facing display name of a term/semester\n */\nexport function getSemesterName(term: string): string {\n  if (!isTerm(term)) return 'Unknown';\n\n  const year = term.substring(0, 4);\n  const semester = ((): string => {\n    switch (Number.parseInt(term.substring(4), 10)) {\n      case 1:\n        return 'Winter';\n      case 2:\n      case 3:\n        return 'Spring';\n      case 5:\n      case 6:\n        return 'Summer';\n      case 8:\n      case 9:\n        return 'Fall';\n      default:\n        return 'Unknown';\n    }\n  })();\n  return `${semester} ${year}`;\n}\n","import { useState, useEffect } from 'react';\n\nimport { isMobile } from '../utils/misc';\n\n/**\n * Subscribes to resize events on the page\n *\n * ? Would this be better to subscribe to a media query ?\n */\nexport default function useMobile(): boolean {\n  const [mobile, setMobile] = useState(isMobile());\n  useEffect(() => {\n    const handleResize = (): void => {\n      const newMobile = isMobile();\n      if (mobile !== newMobile) {\n        setMobile(newMobile);\n      }\n    };\n\n    window.addEventListener('resize', handleResize);\n    return (): void => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [mobile]);\n\n  return mobile;\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type SpinnerProps = {\n  style?: React.CSSProperties;\n  className?: string;\n  size?: 'small' | 'normal' | number;\n};\n\n/**\n * Shows a simple circular spinner with a configurable size,\n * designed to indicate loading.\n */\nexport default function Spinner({\n  style,\n  className,\n  size = 'normal',\n}: SpinnerProps): React.ReactElement {\n  const actualSize =\n    typeof size === 'number'\n      ? size\n      : {\n          small: 16,\n          normal: 40,\n        }[size];\n  return (\n    <svg\n      className={classes('spinner', className)}\n      style={\n        {\n          ...style,\n          '--size': `${actualSize}px`,\n        } as React.CSSProperties\n      }\n      viewBox=\"0 0 50 50\"\n    >\n      <circle cx=\"25\" cy=\"25\" r=\"20\" />\n    </svg>\n  );\n}\n","import React, { useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCaretDown } from '@fortawesome/free-solid-svg-icons';\n\nimport { classes } from '../../utils/misc';\nimport { Button } from '..';\nimport Spinner from '../Spinner';\n\nimport './stylesheet.scss';\n\nexport type SelectProps<V extends string | number> = {\n  className?: string;\n  value: V;\n  onChange: (newValue: V) => void;\n  options: SelectOption<V>[];\n};\n\nexport type SelectOption<V> = {\n  value: V;\n  label: React.ReactNode;\n};\n\nexport default function Select<V extends string | number>({\n  className,\n  value,\n  onChange,\n  options,\n}: SelectProps<V>): React.ReactElement {\n  const [opened, setOpened] = useState(false);\n\n  const selectedOption = options.find((option) => option.value === value);\n  const label = selectedOption ? selectedOption.label : '-';\n\n  return (\n    <div\n      className={classes('Button', 'Select', className)}\n      onClick={(): void => setOpened(!opened)}\n    >\n      <div className=\"text\">{label}</div>\n      <FontAwesomeIcon fixedWidth icon={faCaretDown} />\n      {opened && (\n        <div className=\"intercept\" onClick={(): void => setOpened(false)} />\n      )}\n      {opened && (\n        <div className=\"option-container\">\n          {options.map(({ value: optionValue, label: optionLabel }) => (\n            <Button\n              className=\"option\"\n              key={optionValue}\n              onClick={(): void => onChange(optionValue)}\n            >\n              {optionLabel}\n            </Button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport type LoadingSelectProps = {\n  className?: string;\n  label?: string;\n};\n\nexport function LoadingSelect({\n  className,\n  label = 'Loading',\n}: LoadingSelectProps): React.ReactElement {\n  return (\n    <div className={classes('Button', 'Select', className, 'disabled')}>\n      <Spinner size=\"small\" style={{ marginRight: 12 }} />\n      <div className=\"text\">{label}</div>\n      <FontAwesomeIcon fixedWidth icon={faCaretDown} />\n    </div>\n  );\n}\n","import React, { useCallback, useContext, useRef } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faAdjust,\n  faBars,\n  faCalendarAlt,\n  faDownload,\n  faPaste,\n} from '@fortawesome/free-solid-svg-icons';\nimport { faGithub } from '@fortawesome/free-brands-svg-icons';\nimport Cookies from 'js-cookie';\nimport ReactTooltip from 'react-tooltip';\n\nimport { getSemesterName } from '../../utils/semesters';\nimport { Button, Select, Tab } from '..';\nimport useMobile from '../../hooks/useMobile';\nimport { ThemeContext } from '../../contexts';\nimport { LoadingSelect } from '../Select';\nimport Spinner from '../Spinner';\n\nimport './stylesheet.scss';\n\nexport type HeaderDisplayProps = {\n  totalCredits?: number | null;\n  currentTab: number;\n  onChangeTab: (newTab: number) => void;\n  onToggleMenu: () => void;\n  tabs: string[];\n  onCopyCrns?: () => void;\n  enableCopyCrns?: boolean;\n  onExportCalendar?: () => void;\n  enableExportCalendar?: boolean;\n  onDownloadCalendar?: () => void;\n  enableDownloadCalendar?: boolean;\n  termsState:\n    | { type: 'loading' }\n    | {\n        type: 'loaded';\n        terms: string[];\n        currentTerm: string;\n        onChangeTerm: (next: string) => void;\n      };\n};\n\n/**\n * Renders the top header component as a simple display component,\n * letting any substantive state be passed in as props.\n * See `<Header>` for the full implementation that owns the header state.\n * This is safe to render without `ScheduleContext` or `TermsContext`\n * being present.\n */\nexport default function HeaderDisplay({\n  totalCredits = null,\n  currentTab,\n  onChangeTab,\n  onToggleMenu,\n  tabs,\n  onCopyCrns = (): void => undefined,\n  enableCopyCrns = false,\n  onExportCalendar = (): void => undefined,\n  enableExportCalendar = false,\n  onDownloadCalendar = (): void => undefined,\n  enableDownloadCalendar = false,\n  termsState,\n}: HeaderDisplayProps): React.ReactElement {\n  const [theme, setTheme] = useContext(ThemeContext);\n\n  const handleThemeChange = useCallback(() => {\n    const newTheme = theme === 'light' ? 'dark' : 'light';\n    Cookies.set('theme', newTheme, { expires: 1460 });\n    setTheme(newTheme);\n  }, [theme, setTheme]);\n\n  // Obtain a ref to the copy button to only close its tooltip\n  const crnButton = useRef<HTMLDivElement>(null);\n\n  // Re-render when the page is re-sized to become mobile/desktop\n  // (desktop is >= 1024 px wide)\n  const mobile = useMobile();\n  return (\n    <div className=\"Header\">\n      {/* Menu button, only displayed on mobile */}\n      {mobile && (\n        <Button className=\"nav-menu-button\" onClick={onToggleMenu}>\n          <FontAwesomeIcon className=\"icon\" fixedWidth icon={faBars} />\n        </Button>\n      )}\n\n      {/* Left-aligned logo */}\n      <Button className=\"logo\">\n        <span className=\"gt\">GT </span>\n        <span className=\"scheduler\">Scheduler</span>\n      </Button>\n\n      {/* Term selector */}\n      {termsState.type === 'loaded' ? (\n        <Select\n          onChange={termsState.onChangeTerm}\n          value={termsState.currentTerm}\n          options={termsState.terms.map((currentTerm) => ({\n            value: currentTerm,\n            label: getSemesterName(currentTerm),\n          }))}\n          className=\"semester\"\n        />\n      ) : (\n        <LoadingSelect />\n      )}\n\n      <span className=\"credits\">\n        {totalCredits === null ? (\n          <Spinner size=\"small\" style={{ marginRight: 8 }} />\n        ) : (\n          totalCredits\n        )}{' '}\n        Credits\n      </span>\n\n      {/* Include middle-aligned tabs on desktop */}\n      {!mobile && (\n        <div className=\"tabs\">\n          {tabs.map((tabLabel, tabIdx) => (\n            <Tab\n              key={tabIdx}\n              active={tabIdx === currentTab}\n              onClick={(): void => onChangeTab(tabIdx)}\n              label={tabLabel}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Action bar */}\n      <div className=\"menu\">\n        <Button onClick={onDownloadCalendar} disabled={!enableDownloadCalendar}>\n          <FontAwesomeIcon className=\"icon\" fixedWidth icon={faDownload} />\n          <div className=\"text\">Download</div>\n        </Button>\n        <Button onClick={onExportCalendar} disabled={!enableExportCalendar}>\n          <FontAwesomeIcon className=\"icon\" fixedWidth icon={faCalendarAlt} />\n          <div className=\"text\">Export</div>\n        </Button>\n\n        {/* Include separate button and tooltip component\n              with manually controlled closing logic */}\n        <div\n          className=\"menu\"\n          data-tip\n          data-for=\"copy-crn\"\n          delay-hide=\"1000\"\n          ref={crnButton}\n        >\n          <Button disabled={!enableCopyCrns}>\n            <FontAwesomeIcon className=\"icon\" fixedWidth icon={faPaste} />\n            <div className=\"text\">CRNs</div>\n          </Button>\n        </div>\n        {enableCopyCrns && (\n          <ReactTooltip\n            id=\"copy-crn\"\n            type=\"dark\"\n            place=\"bottom\"\n            effect=\"solid\"\n            event=\"click\"\n            delayHide={1000}\n            afterShow={(): void => {\n              onCopyCrns();\n              setTimeout(\n                () => ReactTooltip.hide(crnButton.current ?? undefined),\n                1000\n              );\n            }}\n          >\n            Copied to clipboard!\n          </ReactTooltip>\n        )}\n\n        <Button onClick={handleThemeChange}>\n          <FontAwesomeIcon className=\"icon\" fixedWidth icon={faAdjust} />\n          <div className=\"text\">Theme</div>\n        </Button>\n        <Button href=\"https://github.com/gt-scheduler/website\">\n          <FontAwesomeIcon className=\"icon\" fixedWidth icon={faGithub} />\n          <div className=\"text\">GitHub</div>\n        </Button>\n      </div>\n    </div>\n  );\n}\n","import React, { useCallback, useContext, useMemo, useRef } from 'react';\nimport copy from 'copy-to-clipboard';\n\nimport {\n  downloadShadowCalendar,\n  exportCoursesToCalendar,\n} from '../../utils/misc';\nimport { Calendar } from '..';\nimport { ScheduleContext, TermsContext, ThemeContext } from '../../contexts';\nimport { ErrorWithFields, softError } from '../../log';\nimport HeaderDisplay from '../HeaderDisplay';\n\nimport './stylesheet.scss';\n\nexport type HeaderProps = {\n  currentTab: number;\n  onChangeTab: (newTab: number) => void;\n  onToggleMenu: () => void;\n  tabs: string[];\n};\n\n/**\n * Renders the top header component with all state/interactivity,\n * and includes controls for top-level tab-based navigation.\n * Acts as a wrapper around `<HeaderDisplay>` that provides all props.\n */\nexport default function Header({\n  currentTab,\n  onChangeTab,\n  onToggleMenu,\n  tabs,\n}: HeaderProps): React.ReactElement {\n  const [{ term, oscar, pinnedCrns }, { setTerm }] =\n    useContext(ScheduleContext);\n  const terms = useContext(TermsContext);\n  const [theme] = useContext(ThemeContext);\n  const captureRef = useRef<HTMLDivElement>(null);\n\n  const totalCredits = useMemo(() => {\n    return pinnedCrns.reduce((credits, crn) => {\n      const crnSection = oscar.findSection(crn);\n      return credits + (crnSection != null ? crnSection.credits : 0);\n    }, 0);\n  }, [pinnedCrns, oscar]);\n\n  const handleExport = useCallback(() => {\n    try {\n      exportCoursesToCalendar(oscar, pinnedCrns);\n    } catch (err) {\n      softError(\n        new ErrorWithFields({\n          message: 'exporting courses to calendar failed',\n          fields: {\n            pinnedCrns,\n            term: oscar.term,\n          },\n        })\n      );\n    }\n  }, [oscar, pinnedCrns]);\n\n  const handleDownload = useCallback(() => {\n    const captureElement = captureRef.current;\n    if (captureElement == null) return;\n    try {\n      downloadShadowCalendar(captureElement, theme);\n    } catch (err) {\n      softError(\n        new ErrorWithFields({\n          message: 'downloading shadow calendar as PNG failed',\n          fields: {\n            pinnedCrns,\n            theme,\n            term: oscar.term,\n          },\n        })\n      );\n    }\n  }, [captureRef, theme, pinnedCrns, oscar.term]);\n\n  const handleCopyCrns = useCallback(() => {\n    try {\n      copy(pinnedCrns.join(', '));\n    } catch (err) {\n      softError(\n        new ErrorWithFields({\n          message: 'copying CRNs to clipboard failed',\n          fields: {\n            pinnedCrns,\n            term: oscar.term,\n          },\n        })\n      );\n    }\n  }, [pinnedCrns, oscar.term]);\n\n  return (\n    <>\n      <HeaderDisplay\n        totalCredits={totalCredits}\n        currentTab={currentTab}\n        onChangeTab={onChangeTab}\n        onToggleMenu={onToggleMenu}\n        tabs={tabs}\n        onCopyCrns={handleCopyCrns}\n        enableCopyCrns={pinnedCrns.length > 0}\n        onExportCalendar={handleExport}\n        enableExportCalendar={pinnedCrns.length > 0}\n        onDownloadCalendar={handleDownload}\n        enableDownloadCalendar={pinnedCrns.length > 0}\n        termsState={{\n          type: 'loaded',\n          terms,\n          currentTerm: term,\n          onChangeTerm: setTerm,\n        }}\n      />\n\n      {/* Fake calendar used to capture screenshots */}\n      <div className=\"capture-container\" ref={captureRef}>\n        <Calendar className=\"fake-calendar\" capture overlayCrns={[]} />\n      </div>\n    </>\n  );\n}\n","import React, { useCallback, useContext, useState } from 'react';\nimport ReactTooltip from 'react-tooltip';\nimport {\n  faAngleDown,\n  faAngleUp,\n  faBan,\n  faGraduationCap,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { classes, simplifyName, unique } from '../../utils/misc';\nimport { Section as SectionBean } from '../../data/beans';\nimport { ActionRow, Section } from '..';\nimport { ScheduleContext } from '../../contexts';\n\nimport './stylesheet.scss';\n\nexport type InstructorProps = {\n  className?: string;\n  color: string | undefined;\n  name: string;\n  sections: SectionBean[];\n  gpa: string;\n};\n\nexport default function Instructor({\n  className,\n  color,\n  name,\n  sections,\n  gpa,\n}: InstructorProps): React.ReactElement {\n  const [{ pinnedCrns, excludedCrns }, { patchSchedule }] =\n    useContext(ScheduleContext);\n  const [expanded, setExpanded] = useState(true);\n\n  const includeSection = useCallback(\n    (section: SectionBean) => {\n      patchSchedule({\n        excludedCrns: excludedCrns.filter((crn) => crn !== section.crn),\n      });\n    },\n    [excludedCrns, patchSchedule]\n  );\n\n  const excludeSections = useCallback(\n    (sectionList: SectionBean[]) => {\n      const crns = sectionList.map((section) => section.crn);\n      patchSchedule({\n        excludedCrns: unique([...excludedCrns, ...crns]),\n        pinnedCrns: pinnedCrns.filter((crn) => !crns.includes(crn)),\n      });\n    },\n    [excludedCrns, pinnedCrns, patchSchedule]\n  );\n\n  const instructorPinned = sections.some((section) =>\n    pinnedCrns.includes(section.crn)\n  );\n\n  const includedSections = sections.filter(\n    (section) => !excludedCrns.includes(section.crn)\n  );\n  const excludedSections = sections.filter((section) =>\n    excludedCrns.includes(section.crn)\n  );\n\n  const excludeTooltipId = `exclude-instructor-${name.replace(' ', '-')}`;\n  return (\n    <div\n      className={classes(\n        'Instructor',\n        !expanded && 'divider-bottom',\n        className\n      )}\n    >\n      <ActionRow\n        label={name || 'Not Assigned'}\n        actions={[\n          {\n            icon: expanded ? faAngleUp : faAngleDown,\n            onClick: (): void => setExpanded(!expanded),\n          },\n          !['TBA', 'Not Assigned'].includes(name)\n            ? {\n                icon: faGraduationCap,\n                href: `http://www.ratemyprofessors.com/search.jsp?queryBy=teacherName&schoolName=Georgia+Institute+of+Technology&query=${encodeURIComponent(\n                  simplifyName(name)\n                )}`,\n              }\n            : null,\n          {\n            icon: faBan,\n            dataTip: true,\n            dataFor: excludeTooltipId,\n            onClick: (): void => excludeSections(sections),\n          },\n        ]}\n        style={instructorPinned ? { backgroundColor: color } : undefined}\n      >\n        <div className=\"instructor-row\">\n          <span className=\"gpa\">Instructor GPA: {gpa || 'N/A'}</span>\n        </div>\n      </ActionRow>\n      <ReactTooltip\n        id={excludeTooltipId}\n        type=\"dark\"\n        place=\"bottom\"\n        effect=\"solid\"\n      >\n        Exclude from Combinations\n      </ReactTooltip>\n      {expanded && (\n        <div className={classes('section-container', 'nested')}>\n          {includedSections.map((section) => {\n            const pinned = pinnedCrns.includes(section.crn);\n            return (\n              <Section\n                key={section.id}\n                className=\"divider-bottom\"\n                section={section}\n                color={color}\n                pinned={pinned}\n              />\n            );\n          })}\n          {excludedSections.length > 0 && (\n            <div className=\"excluded-section-container\">\n              {excludedSections.map((section) => (\n                <span\n                  className=\"excluded-section\"\n                  key={section.id}\n                  onClick={(): void => includeSection(section)}\n                >\n                  {section.id}\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useContext, useState } from 'react';\nimport ReactMapGL, { Marker, NavigationControl } from 'react-map-gl';\nimport { ViewState } from 'react-map-gl/src/mapbox/mapbox';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMapPin } from '@fortawesome/free-solid-svg-icons';\n\nimport { Location } from '../../types';\nimport { ThemeContext } from '../../contexts';\n\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport './stylesheet.scss';\n\nexport type MapLocation = {\n  section: string;\n  id: string;\n  coords: Location | null;\n};\n\nexport type MapViewProps = {\n  locations: MapLocation[];\n};\n\nexport default function MapView({\n  locations,\n}: MapViewProps): React.ReactElement {\n  // These initial coordinates start the map looking at the GT Atlanta campus\n  const [viewState, setViewState] = useState<ViewState>({\n    latitude: 33.7765,\n    longitude: -84.3963,\n    zoom: 15,\n  });\n\n  const unknown: MapLocation[] = [];\n  const coordsToLocationsMap = new Map<Location, MapLocation[]>();\n  locations.forEach((location) => {\n    if (location.coords === null) {\n      unknown.push(location);\n    } else if (coordsToLocationsMap.has(location.coords)) {\n      coordsToLocationsMap.get(location.coords)?.push(location);\n    } else {\n      coordsToLocationsMap.set(location.coords, [location]);\n    }\n  });\n\n  // Switch the map style based on the current theme.\n  // These are custom styles owned by the Mapbox account in the BitWarden.\n  // Public share links:\n  // Dark: https://api.mapbox.com/styles/v1/gt-scheduler/cktc4yzhm018w17ql65xa802o.html?fresh=true&title=copy&access_token=pk.eyJ1IjoiZ3Qtc2NoZWR1bGVyIiwiYSI6ImNrdGM0cXlqMDA0aXYyeHBma290Y2NyOTgifQ.S_A1gOu-FSQ8ywQFf2rr5A\n  // Light: https://api.mapbox.com/styles/v1/gt-scheduler/cktc4y61t018918qjynvngozg.html?fresh=true&title=copy&access_token=pk.eyJ1IjoiZ3Qtc2NoZWR1bGVyIiwiYSI6ImNrdGM0cXlqMDA0aXYyeHBma290Y2NyOTgifQ.S_A1gOu-FSQ8ywQFf2rr5A\n  const [theme] = useContext(ThemeContext);\n  const mapStyle =\n    theme === 'dark'\n      ? 'mapbox://styles/gt-scheduler/cktc4yzhm018w17ql65xa802o' // gt-scheduler-dark\n      : 'mapbox://styles/gt-scheduler/cktc4y61t018918qjynvngozg'; // gt-scheduler-light\n\n  return (\n    <div className=\"mapbox\">\n      <ReactMapGL\n        height=\"100%\"\n        width=\"100%\"\n        viewState={viewState}\n        mapStyle={mapStyle}\n        mapboxApiAccessToken={process.env['REACT_APP_MAPBOX_TOKEN'] ?? ''}\n        onViewStateChange={({\n          viewState: newViewState,\n        }: {\n          viewState: ViewState;\n        }): void => setViewState(newViewState)}\n      >\n        {Array.from(coordsToLocationsMap.entries()).map(\n          ([coords, coordLocations], i) => (\n            <Marker key={i} latitude={coords.lat} longitude={coords.long}>\n              <FontAwesomeIcon icon={faMapPin} className=\"pin-icon\" />\n              <div className=\"pin-text\">\n                {coordLocations.map((coordLocation) => (\n                  <div key={coordLocation.id + coordLocation.section}>\n                    {coordLocation.id} {coordLocation.section}\n                  </div>\n                ))}\n              </div>\n            </Marker>\n          )\n        )}\n        {unknown.length > 0 && (\n          <div className=\"unknown-container\">\n            <b>Undetermined</b>\n            {unknown.map((location, i) => (\n              <div className=\"class\" key={i}>\n                {location.id} {location.section}\n              </div>\n            ))}\n          </div>\n        )}\n        <div className=\"navigation\">\n          <NavigationControl showZoom showCompass />\n        </div>\n      </ReactMapGL>\n    </div>\n  );\n}\n","import React, { useContext } from 'react';\nimport { faAngleDown, faAngleUp } from '@fortawesome/free-solid-svg-icons';\n\nimport { ActionRow } from '..';\nimport { classes, getContentClassName } from '../../utils/misc';\nimport { Period } from '../../types';\nimport { ThemeContext } from '../../contexts';\n\nimport './stylesheet.scss';\n\nexport type Day = 'M' | 'T' | 'W' | 'R' | 'F';\n\nexport function isDay(rawDay: string): rawDay is Day {\n  switch (rawDay) {\n    case 'M':\n    case 'T':\n    case 'W':\n    case 'R':\n    case 'F':\n      return true;\n    default:\n      return false;\n  }\n}\n\nexport interface CourseDateItem {\n  id: string;\n  title: string;\n  times: Period | undefined;\n  daysOfWeek: string[];\n}\n\nexport type DaySelectionProps = {\n  courseDateMap: Record<Day, CourseDateItem[]>;\n  activeDay: Day | '';\n  setActiveDay: (next: Day | '') => void;\n};\n\nconst LIGHT_COLOR_PALETTE = [\n  '#FCB9AA',\n  '#FFDBCC',\n  '#ECEAE4',\n  '#A2E1DB',\n  '#55CBCD',\n];\nconst DARK_COLOR_PALETTE = [\n  '#5e3931',\n  '#704737',\n  '#685a30',\n  '#3c6962',\n  '#286061',\n];\n\nexport default function DaySelection({\n  courseDateMap,\n  activeDay,\n  setActiveDay,\n}: DaySelectionProps): React.ReactElement {\n  const daysOfTheWeek = [\n    'Monday',\n    'Tuesday',\n    'Wednesday',\n    'Thursday',\n    'Friday',\n  ];\n\n  // Switch the color palette based on the current theme.\n  const [theme] = useContext(ThemeContext);\n  const colorPalette =\n    theme === 'dark' ? DARK_COLOR_PALETTE : LIGHT_COLOR_PALETTE;\n\n  const formatTime = (time: number): string => {\n    if (Math.floor(time / 60) >= 12) {\n      const adjustedHour = Math.floor(time / 60) % 12;\n      const hour = adjustedHour === 0 ? '12' : adjustedHour;\n      const minute = String(time % 60).padStart(2, '0');\n      return `${hour}:${minute}pm`;\n    }\n\n    const hour = Math.floor(time / 60);\n    const minute = String(time % 60).padStart(2, '0');\n    return `${hour}:${minute}am`;\n  };\n\n  return (\n    <div className=\"date-container\">\n      {Object.keys(courseDateMap).map((date, i) => {\n        if (!isDay(date)) return null;\n        const courses = courseDateMap[date];\n        return (\n          <div\n            key={date}\n            className={classes(\n              'date',\n              getContentClassName(colorPalette[i]),\n              'default'\n            )}\n            style={{ backgroundColor: colorPalette[i] }}\n          >\n            <ActionRow\n              label={daysOfTheWeek[i] ?? ''}\n              className=\"day-select\"\n              actions={[\n                {\n                  icon: date === activeDay ? faAngleUp : faAngleDown,\n                  onClick: (): void =>\n                    date !== activeDay ? setActiveDay(date) : setActiveDay(''),\n                },\n              ]}\n            />\n            {activeDay === date && (\n              <div className=\"dropdown-content\">\n                {courses == null || courses.length === 0 ? (\n                  <div className=\"course-content\" style={{ padding: 8 }}>\n                    No classes this day!\n                  </div>\n                ) : (\n                  courses.map((course) => {\n                    let timeLabel = 'TBA';\n                    const { times } = course;\n                    if (times != null) {\n                      const { start, end } = times;\n                      timeLabel = `${formatTime(start)} - ${formatTime(end)}`;\n                    }\n\n                    return (\n                      <div className=\"course-content\" key={course.id}>\n                        <div className=\"course-id\">{course.id}</div>\n                        <span className=\"course-row\">{course.title}</span>\n                        <span className=\"course-row\">\n                          {course.daysOfWeek} {timeLabel}\n                        </span>\n                      </div>\n                    );\n                  })\n                )}\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","import React, { useContext, useState } from 'react';\n\nimport MapView, { MapLocation } from '../MapView';\nimport { ScheduleContext } from '../../contexts';\nimport DaySelection, { CourseDateItem, Day, isDay } from '../DaySelection';\nimport { Meeting } from '../../types';\n\nimport './stylesheet.scss';\n\n// Construct combined course data\n// to pass to `<MapView>` and `<DaySelection>`\ntype CombinedCourseData = CourseDateItem & MapLocation;\n\nexport default function Map(): React.ReactElement {\n  const [{ oscar, pinnedCrns }] = useContext(ScheduleContext);\n  const [activeDay, setActiveDay] = useState<Day | ''>('M');\n  const courseDateMap: Record<Day, CombinedCourseData[]> = {\n    M: [],\n    T: [],\n    W: [],\n    R: [],\n    F: [],\n  };\n\n  // Construct the course data for the first meeting of each class\n  pinnedCrns.forEach((crn) => {\n    const section = oscar.findSection(crn);\n    if (section == null) return;\n    const { meetings } = section;\n    if (meetings.length === 0) return;\n    const firstMeeting = meetings[0] as Meeting;\n\n    firstMeeting.days.forEach((day) => {\n      if (!isDay(day)) return;\n      const courses = courseDateMap[day] ?? [];\n      courses.push({\n        id: section.course.id,\n        title: section.course.title,\n        times: firstMeeting.period,\n        daysOfWeek: firstMeeting.days,\n        section: section.id,\n        coords: firstMeeting.location,\n      });\n      courseDateMap[day] = courses;\n    });\n  });\n\n  // Sort each list of course data by their times\n  const sortedCourseDateMap: Record<Day, CombinedCourseData[]> = {\n    M: [],\n    T: [],\n    W: [],\n    R: [],\n    F: [],\n  };\n  Object.entries(courseDateMap).forEach(([day, courseDataList]) => {\n    if (!isDay(day)) return;\n    sortedCourseDateMap[day] = courseDataList.sort(\n      (a, b) => (a.times?.start ?? 0) - (b.times?.start ?? 0)\n    );\n  });\n\n  let activeLocations: MapLocation[] = [];\n  if (activeDay !== '') {\n    activeLocations = sortedCourseDateMap[activeDay];\n  }\n\n  return (\n    <div className=\"map-content\">\n      <DaySelection\n        courseDateMap={sortedCourseDateMap}\n        activeDay={activeDay}\n        setActiveDay={setActiveDay}\n      />\n      <MapView locations={activeLocations} />\n    </div>\n  );\n}\n","import React from 'react';\nimport { faTimes } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { classes } from '../../utils/misc';\nimport { Button } from '..';\n\nimport './stylesheet.scss';\n\nexport type NavDrawerProps = {\n  open: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n};\n\n/**\n * Renders a nav drawer and the overlay when it is open\n */\nexport default function NavDrawer({\n  open,\n  onClose,\n  children,\n}: NavDrawerProps): React.ReactElement {\n  return (\n    <>\n      <div\n        className={classes('drawer-overlay', open && 'open')}\n        tabIndex={-1}\n        onClick={onClose}\n        role=\"presentation\"\n      />\n      <div className={classes('drawer-outer', open && 'open')}>\n        <div className=\"drawer-header\">\n          <Button className=\"drawer-close\" onClick={onClose}>\n            <FontAwesomeIcon className=\"icon\" fixedWidth icon={faTimes} />\n          </Button>\n        </div>\n        {children}\n      </div>\n    </>\n  );\n}\n","import React from 'react';\n\nimport { Button } from '..';\nimport { classes } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type NavMenuProps = {\n  items: string[];\n  currentItem: number;\n  onChangeItem: (next: number) => void;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\n/**\n * Renders a vertical nav menu with a single active item\n */\nexport default function NavMenu({\n  items,\n  currentItem,\n  onChangeItem,\n  className,\n  style,\n}: NavMenuProps): React.ReactElement {\n  return (\n    <div className={classes('nav-menu', className)} style={style}>\n      {items.map((item, idx) => (\n        <Button\n          className={classes('nav-button', currentItem === idx && 'active')}\n          onClick={(): void => onChangeItem(idx)}\n          key={idx}\n        >\n          {item}\n        </Button>\n      ))}\n    </div>\n  );\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\nimport { PALETTE } from '../../constants';\n\nimport './stylesheet.scss';\n\nexport type PaletteProps = {\n  className?: string;\n  color: string | null;\n  onSelectColor: (newColor: string) => void;\n  onMouseLeave: () => void;\n};\n\nexport default function Palette({\n  className,\n  color,\n  onSelectColor,\n  onMouseLeave,\n}: PaletteProps): React.ReactElement {\n  return (\n    <div className={classes('Palette', className)} onMouseLeave={onMouseLeave}>\n      {PALETTE.map((colors, i) => (\n        <div className=\"palette-row\" key={i}>\n          {colors.map((paletteColor) => (\n            <div\n              className={classes('color', paletteColor === color && 'frame')}\n              key={paletteColor}\n              style={{ backgroundColor: paletteColor }}\n              onClick={(): void => onSelectColor(paletteColor)}\n            />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React, { useContext, useState } from 'react';\nimport {\n  faInfoCircle,\n  faAngleUp,\n  faAngleDown,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { ScheduleContext } from '../../contexts';\nimport { classes, serializePrereqs } from '../../utils/misc';\nimport { ActionRow } from '..';\nimport { Course } from '../../data/beans';\nimport {\n  CrawlerPrerequisites,\n  PrerequisiteClause,\n  PrerequisiteOperator,\n} from '../../types';\nimport { ErrorWithFields, softError } from '../../log';\n\nconst BASE_ITEM_STYLE = { fontSize: '0.9em', padding: '8px' };\n\nexport type PrerequisiteProps = {\n  course: Course;\n  prereqs: CrawlerPrerequisites;\n};\n\n/**\n * Renders the prereqs for a single course, given that the crawler version\n * supports prereqs. (Make sure to check this before). An empty prereq list is\n * an authoritative statement that the course has no prereqs, and as such a\n * message will be displayed telling the user. Otherwise, this component tries\n * to render the prereq tree in a way that is easily consumable without taking\n * up too much screen space, first trying to split the prereqs up into separate\n * \"options\" (sub-clauses of an OR set) if possible before rendering a list of\n * items with operators in between. Finally, in each item, there is the\n * flattened textual representation of the remainder of the subtree, which\n * restores parentheses groupings (much like the original Oscar prereq syntax)\n */\nexport default function Prerequisite({\n  course,\n  prereqs,\n}: PrerequisiteProps): React.ReactElement {\n  let content: React.ReactNode;\n  if (prereqs.length === 0) {\n    content = <PrerequisiteEmpty />;\n  } else {\n    // `prereqs` isn't an empty array, so it must be `PrerequisiteSet`\n    // (here we manually `Exclude` the empty array case)\n    const [op, ...subClauses] = prereqs as Exclude<CrawlerPrerequisites, []>;\n\n    switch (op) {\n      case 'and':\n        // We only consider this a single \"option\",\n        // so just render the content as a direct child\n        content = <PrerequisiteClauseDisplay clause={['and', ...subClauses]} />;\n        break;\n      case 'or':\n        if (subClauses.length === 1) {\n          // There is only 1 option:\n          // just render the content as a direct child\n          content = (\n            <PrerequisiteClauseDisplay\n              clause={subClauses[0] as PrerequisiteClause}\n            />\n          );\n        } else {\n          // Render an option for each sub-clause\n          content = (\n            <>\n              {subClauses.map((subClause, i) => (\n                <PrerequisiteOption key={i} clause={subClause} index={i} />\n              ))}\n            </>\n          );\n        }\n        break;\n      default:\n        softError(\n          new ErrorWithFields({\n            message: 'invalid operator found in top-level prereqs',\n            fields: {\n              courseId: course.id,\n              operator: op,\n              term: course.term,\n            },\n          })\n        );\n        content = null;\n    }\n  }\n\n  return (\n    <div className={classes('hover-container', 'nested')}>\n      <PrerequisiteHeader course={course} />\n      <div className={classes('nested')}>{content}</div>\n    </div>\n  );\n}\n\n// Private sub-components\n\ntype PrerequisiteHeaderProps = {\n  course: Course;\n};\n\n/**\n * Renders the \"header\" at the top of a prereq display,\n * which includes a link to Oscar giving the original prereq source,\n * plus other course information.\n */\nfunction PrerequisiteHeader({\n  course,\n}: PrerequisiteHeaderProps): React.ReactElement {\n  const [{ term }] = useContext(ScheduleContext);\n\n  return (\n    <ActionRow\n      className={classes('hover-container')}\n      label=\"Prerequisites\"\n      actions={[\n        {\n          icon: faInfoCircle,\n          href:\n            `https://oscar.gatech.edu/pls/bprod/bwckctlg.p_disp_` +\n            `course_detail?cat_term_in=${term}&subj_code_in=` +\n            `${course.subject}&crse_numb_in=${course.number}`,\n        },\n      ]}\n    />\n  );\n}\n\ntype PrerequisiteOptionProps = {\n  clause: PrerequisiteClause;\n  index: number;\n};\n\n/**\n * Renders a single prereq option -- a sub-clause of a larger \"OR\" prereq set\n * that is independently collapse-able from the other sibling options.\n * Inside, uses `PrerequisiteClauseDisplay` to render the sub-clause if\n * the option is expanded.\n */\nfunction PrerequisiteOption({\n  clause,\n  index,\n}: PrerequisiteOptionProps): React.ReactElement {\n  const [expanded, setExpanded] = useState(true);\n\n  return (\n    <>\n      <ActionRow\n        className={classes('hover-container')}\n        label={`Option ${index + 1}`}\n        actions={[\n          {\n            icon: expanded ? faAngleUp : faAngleDown,\n            onClick: (): void => setExpanded(!expanded),\n          },\n        ]}\n      />\n      {expanded && (\n        <div className={classes('nested')}>\n          <PrerequisiteClauseDisplay clause={clause} />\n        </div>\n      )}\n    </>\n  );\n}\n\ntype PrerequisiteClauseDisplayProps = {\n  clause: PrerequisiteClause;\n};\n\n/**\n * Renders an arbitrary prereq clause. If the clause is a singular course,\n * then it renders a single Item. Otherwise, if the clause is a set,\n * this component renders an item for each member of the set, and includes\n * an operator at the end of each item's text to indicate that each item\n * is part of a larger prereq set.\n */\nfunction PrerequisiteClauseDisplay({\n  clause,\n}: PrerequisiteClauseDisplayProps): React.ReactElement {\n  if (!Array.isArray(clause)) {\n    // Render the single prereq course\n    return <PrerequisiteItem clause={clause} operator=\"and\" isLast />;\n  }\n\n  // Render a list of prereq items\n  const [operator, ...subClauses] = clause;\n  return (\n    <>\n      {subClauses.map((subClause, i) => (\n        <PrerequisiteItem\n          key={i}\n          clause={subClause}\n          operator={operator}\n          isLast={i === subClauses.length - 1}\n        />\n      ))}\n    </>\n  );\n}\n\ntype PrerequisiteItemProps = {\n  clause: PrerequisiteClause;\n  operator: PrerequisiteOperator;\n  isLast: boolean;\n};\n\n/**\n * Renders a single \"item\" -- a div with the completely flattened text\n * representation of the prereq subtree passed in as `clause` (whether\n * that's a single prereq course or a sprawling sub-tree with many branches).\n * Includes the ability to display a higher-level operator between different\n * `PrerequisiteItem`'s as long as `isLast` is false, which is used by\n * `PrerequisiteClauseDisplay` when it needs to render a prerequisite set.\n */\nfunction PrerequisiteItem({\n  clause,\n  operator,\n  isLast,\n}: PrerequisiteItemProps): React.ReactElement {\n  return (\n    <div className={classes('divider-bottom')} style={BASE_ITEM_STYLE}>\n      {serializePrereqs(clause)} {!isLast && <strong>{operator}</strong>}\n    </div>\n  );\n}\n\n/**\n * Replacement prerequisite \"item\"-like component that simply contains\n * a notification to the user that the course has no prereqs.\n */\nfunction PrerequisiteEmpty(): React.ReactElement {\n  return (\n    <div style={BASE_ITEM_STYLE}>No prerequisites. You&apos;re good to go!</div>\n  );\n}\n","import React, { useMemo, useState } from 'react';\n\nimport { classes } from '../../utils/misc';\nimport { Button, Calendar, CombinationContainer, CourseContainer } from '..';\nimport { OverlayCrnsContext, OverlayCrnsContextValue } from '../../contexts';\nimport useMobile from '../../hooks/useMobile';\n\n/**\n * Wraps around the root top-level component of the Scheduler tab\n */\nexport default function Scheduler(): React.ReactElement {\n  const mobile = useMobile();\n\n  // Store the current set of CRNs that are shown on the Calendar overlay\n  const [overlayCrns, setOverlayCrns] = useState<string[]>([]);\n\n  // Control second-level navigation between panes on mobile\n  const [tabIndex, setTabIndex] = useState<number>(0);\n\n  // Memoize the CRN overlay set's context value so it is stable\n  const overlayContextValue = useMemo<OverlayCrnsContextValue>(\n    () => [overlayCrns, setOverlayCrns],\n    [overlayCrns, setOverlayCrns]\n  );\n\n  return (\n    <>\n      {mobile && (\n        <div className=\"tab-container\">\n          {['Courses', 'Combinations', 'Calendar'].map((tabTitle, i) => (\n            <Button\n              key={tabTitle}\n              className={classes('tab', tabIndex === i && 'active')}\n              onClick={(): void => setTabIndex(i)}\n            >\n              {tabTitle}\n            </Button>\n          ))}\n        </div>\n      )}\n      <OverlayCrnsContext.Provider value={overlayContextValue}>\n        <div className=\"main\">\n          {(!mobile || tabIndex === 0) && <CourseContainer />}\n          {(!mobile || tabIndex === 1) && <CombinationContainer />}\n          {(!mobile || tabIndex === 2) && (\n            <div className=\"calendar-container\">\n              <Calendar className=\"calendar\" overlayCrns={overlayCrns} />\n            </div>\n          )}\n        </div>\n      </OverlayCrnsContext.Provider>\n    </>\n  );\n}\n","import React, { useCallback, useContext, useState } from 'react';\nimport ReactTooltip from 'react-tooltip';\nimport {\n  faBan,\n  faChair,\n  faThumbtack,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { classes, periodToString } from '../../utils/misc';\nimport { ActionRow } from '..';\nimport { OverlayCrnsContext, ScheduleContext } from '../../contexts';\nimport { DELIVERY_MODES } from '../../constants';\nimport { Section as SectionBean } from '../../data/beans';\nimport { Seating } from '../../data/beans/Section';\nimport { ErrorWithFields, softError } from '../../log';\n\nimport './stylesheet.scss';\n\nexport type SectionProps = {\n  className?: string;\n  section: SectionBean;\n  pinned: boolean;\n  color: string | undefined;\n};\n\nexport default function Section({\n  className,\n  section,\n  pinned,\n  color,\n}: SectionProps): React.ReactElement {\n  const [{ term, pinnedCrns, excludedCrns }, { patchSchedule }] =\n    useContext(ScheduleContext);\n  const [, setOverlayCrns] = useContext(OverlayCrnsContext);\n  const [seating, setSeating] = useState<Seating>([[], 0]);\n\n  let hovering = false;\n  const handleHover = (): void => {\n    hovering = true;\n    setTimeout(() => {\n      if (hovering) {\n        section\n          .fetchSeating(term)\n          .then((newSeating) => {\n            setSeating(newSeating);\n          })\n          .catch((err) =>\n            softError(\n              new ErrorWithFields({\n                message: 'error while fetching seating',\n                source: err,\n                fields: { crn: section.crn, term: section.term },\n              })\n            )\n          );\n      }\n    }, 333);\n  };\n\n  const excludeSection = useCallback(\n    (sect: SectionBean) => {\n      patchSchedule({\n        excludedCrns: [...excludedCrns, sect.crn],\n        pinnedCrns: pinnedCrns.filter((crn) => crn !== sect.crn),\n      });\n    },\n    [pinnedCrns, excludedCrns, patchSchedule]\n  );\n\n  const pinSection = useCallback(\n    (sect: SectionBean) => {\n      if (pinnedCrns.includes(sect.crn)) {\n        patchSchedule({\n          pinnedCrns: pinnedCrns.filter((crn) => crn !== sect.crn),\n        });\n      } else {\n        patchSchedule({\n          pinnedCrns: [...pinnedCrns, sect.crn],\n          excludedCrns: excludedCrns.filter((crn) => crn !== sect.crn),\n        });\n      }\n    },\n    [pinnedCrns, excludedCrns, patchSchedule]\n  );\n\n  const excludeTooltipId = `section-exclude-${section.id}`;\n  return (\n    <ActionRow\n      label={section.id}\n      className={classes('Section', className)}\n      onMouseEnter={(): void => setOverlayCrns([section.crn])}\n      onMouseLeave={(): void => setOverlayCrns([])}\n      actions={[\n        {\n          icon: pinned ? faTimes : faThumbtack,\n          onClick: (): void => pinSection(section),\n        },\n        {\n          icon: faChair,\n          dataTip: true,\n          dataFor: section.id,\n          href: `https://oscar.gatech.edu/pls/bprod/bwckschd.p_disp_detail_sched?term_in=${term}&crn_in=${section.crn}`,\n        },\n        {\n          icon: faBan,\n          dataTip: true,\n          dataFor: excludeTooltipId,\n          onClick: (): void => excludeSection(section),\n        },\n      ]}\n      style={pinned ? { backgroundColor: color } : undefined}\n    >\n      <ReactTooltip\n        id={excludeTooltipId}\n        className=\"tooltip\"\n        type=\"dark\"\n        place=\"right\"\n        effect=\"solid\"\n      >\n        Exclude from Combinations\n      </ReactTooltip>\n      <div className=\"section-details\">\n        <div className=\"delivery-mode\">\n          {section.deliveryMode != null\n            ? DELIVERY_MODES[section.deliveryMode]\n            : ''}\n        </div>\n        <div className=\"meeting-container\">\n          {section.meetings.map((meeting, i) => {\n            return (\n              <div className=\"meeting\" key={i}>\n                <span className=\"days\">{meeting.days.join('')}</span>\n                <span className=\"period\">{periodToString(meeting.period)}</span>\n              </div>\n            );\n          })}\n        </div>\n\n        <ReactTooltip\n          id={section.id}\n          className=\"tooltip\"\n          type=\"dark\"\n          place=\"right\"\n          effect=\"solid\"\n          afterShow={(): void => handleHover()}\n          afterHide={(): void => {\n            hovering = false;\n          }}\n        >\n          <table>\n            <tbody>\n              <tr>\n                <td>\n                  <b>Seats Filled</b>\n                </td>\n                <td>\n                  {seating[0].length === 0\n                    ? `Loading...`\n                    : typeof seating[0][1] === 'number'\n                    ? `${seating[0][1] ?? '<unknown>'} of ${\n                        seating[0][0] ?? '<unknown>'\n                      }`\n                    : `N/A`}\n                </td>\n              </tr>\n              <tr>\n                <td>\n                  <b>Waitlist Filled</b>\n                </td>\n                <td>\n                  {seating[0].length === 0\n                    ? `Loading...`\n                    : typeof seating[0][1] === 'number'\n                    ? `${seating[0][3] ?? '<unknown>'} of ${\n                        seating[0][2] ?? '<unknown>'\n                      }`\n                    : `N/A`}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </ReactTooltip>\n      </div>\n    </ActionRow>\n  );\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type TabProps = {\n  label: string;\n  onClick: () => void;\n  active?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\n/**\n * Renders a single top-level tab that is used in a horizontal list\n */\nexport default function Tab({\n  label,\n  active = false,\n  onClick,\n  className,\n  style,\n}: TabProps): React.ReactElement {\n  return (\n    <button\n      className={classes('Tab', active && 'active', className)}\n      style={style}\n      onClick={onClick}\n      type=\"button\"\n    >\n      {label}\n    </button>\n  );\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\nimport useMobile from '../../hooks/useMobile';\n\nimport './stylesheet.scss';\n\nexport default function Attribution(): React.ReactElement {\n  const mobile = useMobile();\n  return (\n    <div className={classes('Attribution')}>\n      <p>\n        Copyright (c) 2021 with{' '}\n        <span role=\"img\" aria-label=\"love\">\n          ❤️\n        </span>{' '}\n        by <a href=\"https://jasonpark.me\">Jinseo Park</a>,{' '}\n        <a href=\"https://bitsofgood.org\">Bits of Good</a>, and{' '}\n        <a href=\"https://github.com/gt-scheduler/website/graphs/contributors\">\n          {mobile ? 'others' : 'the GT Scheduler contributors'}\n        </a>\n        .\n      </p>\n    </div>\n  );\n}\n","import React, { useState } from 'react';\nimport axios from 'axios';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCommentAlt, faTimes } from '@fortawesome/free-solid-svg-icons';\n\nimport { Button } from '..';\nimport { classes } from '../../utils/misc';\nimport { BACKEND_BASE_URL } from '../../constants';\n\nimport './stylesheet.scss';\n\nexport default function Feedback(): React.ReactElement {\n  const [expanded, setExpanded] = useState<boolean>(false);\n  const [submit, setSubmit] = useState<boolean>(false);\n  const [rating, setRating] = useState<number | null>(null);\n  const [feedback, setFeedback] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const onSubmit = (): void => {\n    setLoading(true);\n    // Add 1 to the rating to move it from [0,4] to [1,5]\n    submitFeedback({ rating: (rating ?? 0) + 1, feedback })\n      .then(() => {\n        setSubmit(true);\n        setLoading(false);\n      })\n      .catch(() => {\n        setSubmit(true);\n        setLoading(false);\n      });\n  };\n\n  return (\n    <>\n      {!expanded && (\n        <div className=\"FeedbackButtonWrapper\">\n          <Button\n            className=\"FeedbackButton\"\n            onClick={(): void => setExpanded(true)}\n          >\n            <FontAwesomeIcon icon={faCommentAlt} size=\"2x\" />\n          </Button>\n        </div>\n      )}\n      {expanded && (\n        <div>\n          <form className=\"FeedbackForm\">\n            <div className=\"container\">\n              <FontAwesomeIcon\n                icon={faTimes}\n                className=\"CloseIcon\"\n                onClick={(): void => setExpanded(false)}\n              />\n              <h3 className=\"FeedbackTitle\">Feedback</h3>\n              {!submit && (\n                <div>\n                  <p className=\"text\">How would you rate your experience?</p>\n                  <div className=\"FormButtons\">\n                    {[1, 2, 3, 4, 5].map((i) => (\n                      <Button\n                        key={i}\n                        className={classes(\n                          'FormButton',\n                          rating === i - 1 && 'active'\n                        )}\n                        onClick={(): void => setRating(i - 1)}\n                      >\n                        {i}\n                      </Button>\n                    ))}\n                  </div>\n                  <div className=\"ScoreLabels\">\n                    <span className=\"score\" style={{ marginLeft: '4px' }}>\n                      Poor\n                    </span>\n                    <span className=\"score\" style={{ marginRight: '4px' }}>\n                      Great\n                    </span>\n                  </div>\n                  <textarea\n                    className=\"FeedbackTextArea\"\n                    placeholder=\"Please let us know if you have any more feedback!\"\n                    onChange={(event): void => setFeedback(event.target.value)}\n                    value={feedback}\n                  />\n                  <Button\n                    className=\"SubmitButton\"\n                    onClick={onSubmit}\n                    disabled={rating == null || loading}\n                  >\n                    Submit\n                  </Button>\n                </div>\n              )}\n              {submit && (\n                <div className=\"submitted\">\n                  <p className=\"submitted-thanks text\">\n                    <span>Thank you for your feedback!</span>\n                  </p>\n                  <div>\n                    <Button\n                      className=\"SubmitButton\"\n                      onClick={(): void => setExpanded(false)}\n                    >\n                      Close\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </form>\n        </div>\n      )}\n    </>\n  );\n}\n\nasync function submitFeedback({\n  rating,\n  feedback,\n}: {\n  rating: number;\n  feedback: string;\n}): Promise<void> {\n  const url = `${BACKEND_BASE_URL}/feedback`;\n  await axios({\n    method: 'post',\n    url,\n    data: {\n      rating,\n      feedback,\n    },\n    headers: {\n      'Content-Type': 'application/json;charset=UTF-8',\n    },\n  });\n}\n","import React, { useEffect } from 'react';\nimport Cookies from 'js-cookie';\nimport swal from '@sweetalert/with-react';\nimport useLocalStorageState from 'use-local-storage-state';\n\nimport { softError, ErrorWithFields } from '../../log';\n\n// Key to mark when a user has already been shown the information modal.\n// Update this when updating the contents of the modal.\n// In the future, prefix all keys with `YYYY-MM-DD-`\n// to ensure that they remain globally unique.\nconst MODAL_LOCAL_STORAGE_KEY = 'visited-merge-notice';\n\n/**\n * Inner content of the information modal.\n * Change this to update the announcement that is shown when visiting the site.\n * Additionally, make sure to change `MODAL_LOCAL_STORAGE_KEY`\n * with another unique value that has never been used before.\n */\nexport function InformationModalContent(): React.ReactElement {\n  return (\n    <div>\n      <img\n        style={{ width: '175px', margin: '0 auto', display: 'block' }}\n        alt=\"GT Scheduler Logo\"\n        src=\"/mascot.png\"\n      />\n      <h1>GT Scheduler</h1>\n      <p>\n        Hey there, yellow jackets!{' '}\n        <a href=\"https://github.com/gt-scheduler\">GT Scheduler</a> is a new\n        collaboration between <a href=\"https://bitsofgood.org/\">Bits of Good</a>{' '}\n        and <a href=\"https://jasonpark.me/\">Jason (Jinseo) Park</a> aimed at\n        making class registration easier for everybody! Now, you can access\n        course prerequisites, instructor GPAs, live seating information, and\n        more all in one location.\n      </p>\n      <p>\n        If you enjoy our work and are interested in contributing, feel free to{' '}\n        <a href=\"https://github.com/gt-scheduler/website/pulls\">\n          open a pull request\n        </a>{' '}\n        with your improvements. Thank you and enjoy!\n      </p>\n    </div>\n  );\n}\n\n/**\n * Hook to show the information modal upon the user's first visit to the site\n * when they haven't seen this version of the information modal before.\n */\nexport function useInformationModal(): void {\n  const [hasSeen, setHasSeen] = useLocalStorageState(\n    MODAL_LOCAL_STORAGE_KEY,\n    () => {\n      const cookieValue = Cookies.get(MODAL_LOCAL_STORAGE_KEY);\n      if (cookieValue === 'true') return true;\n      return false;\n    }\n  );\n\n  useEffect(() => {\n    if (!hasSeen) {\n      setHasSeen(true);\n      swal({\n        button: 'Got It!',\n        content: <InformationModalContent />,\n      }).catch((err) => {\n        softError(\n          new ErrorWithFields({\n            message: 'error with swal call',\n            source: err,\n            fields: {\n              localStorageKey: MODAL_LOCAL_STORAGE_KEY,\n            },\n          })\n        );\n      });\n    }\n  }, [hasSeen, setHasSeen]);\n}\n","import React, { ErrorInfo } from 'react';\n\nimport { ErrorWithFields, softError } from '../../log';\n\ntype ErrorBoundaryProps = {\n  fallback?: (error: Error, errorInfo: ErrorInfo | null) => React.ReactNode;\n  children: React.ReactNode;\n};\n\ntype ErrorBoundaryState = {\n  error: Error | null;\n  info: ErrorInfo | null;\n};\n\n/**\n * Wraps hard errors in the component tree, showing a fallback display\n * so that the error doesn't entirely crash the app.\n * Additionally reports the error to Sentry.\n */\nexport default class ErrorBoundary extends React.Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { error: null, info: null };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error, info: null };\n  }\n\n  override componentDidCatch(error: Error, info: React.ErrorInfo): void {\n    // Log & report to Sentry\n    softError(\n      new ErrorWithFields({\n        message: 'ErrorBoundary caught error from further in render tree',\n        source: error,\n        fields: {\n          reactErrorInfo: info,\n        },\n      })\n    );\n\n    this.setState({ info });\n  }\n\n  override render(): React.ReactElement | null {\n    const { children, fallback } = this.props;\n    const { error, info } = this.state;\n\n    if (error !== null) {\n      if (fallback != null) {\n        return <>{fallback(error, info)}</>;\n      }\n\n      return null;\n    }\n\n    return <>{children}</>;\n  }\n}\n","import React from 'react';\nimport safeStringify from 'fast-safe-stringify';\n\nimport { ErrorWithFields } from '../../log';\nimport { classes } from '../../utils/misc';\n\nexport type ErrorDetailsFieldProps = {\n  name: string;\n  children: React.ReactNode;\n  style?: React.CSSProperties;\n  className?: string;\n};\n\n/**\n * A single field in an error details component\n */\nexport function ErrorDetailsField({\n  name,\n  children,\n  style,\n  className,\n}: ErrorDetailsFieldProps): React.ReactElement {\n  return (\n    <div className={classes(className, 'error-details-field')} style={style}>\n      <strong>{name}</strong>: {children}\n    </div>\n  );\n}\n\nexport type ReactErrorDetailsProps = {\n  error: Error;\n  errorInfo: React.ErrorInfo | null;\n};\n\n/**\n * Shows debug information for an error using react error info.\n */\nexport function ReactErrorDetails({\n  error,\n  errorInfo,\n}: ReactErrorDetailsProps): React.ReactElement {\n  return (\n    <>\n      <BaseErrorDetails error={error} />\n      {errorInfo !== null && (\n        <ErrorDetailsField name=\"Component stacktrace\">\n          <pre>\n            <code>{errorInfo.componentStack.replace(/^[\\n\\r]+/, '')}</code>\n          </pre>\n        </ErrorDetailsField>\n      )}\n    </>\n  );\n}\n\nexport type LoadingErrorDetailsProps = {\n  error: Error;\n  overview: React.ReactNode;\n  name: string;\n};\n\n/**\n * Shows debug information for an error that occurred while loading.\n */\nexport function LoadingErrorDetails({\n  error,\n  overview,\n  name,\n}: LoadingErrorDetailsProps): React.ReactElement {\n  return (\n    <>\n      <BaseErrorDetails error={error} />\n      <ErrorDetailsField name=\"Operation name\">\n        (loading) {name}\n      </ErrorDetailsField>\n      <ErrorDetailsField name=\"Overview\">{overview}</ErrorDetailsField>\n    </>\n  );\n}\n\nexport type BaseErrorDetailsProps = {\n  error: Error;\n};\n\n/**\n * Shows debug information for an instance of `Error`.\n */\nexport function BaseErrorDetails({\n  error,\n}: BaseErrorDetailsProps): React.ReactElement {\n  return (\n    <>\n      <ErrorDetailsField name=\"Name\">{error.name}</ErrorDetailsField>\n      <ErrorDetailsField name=\"Message\">{error.message}</ErrorDetailsField>\n      <ErrorDetailsField name=\"Version\">\n        {process.env['REACT_APP_SENTRY_VERSION']}\n      </ErrorDetailsField>\n      {error instanceof ErrorWithFields && (\n        <ErrorDetailsField name=\"Fields\">\n          <pre>\n            <code>\n              {Object.entries(error.getAllFields())\n                .map(([key, value]) => `    ${key}: ${safeStringify(value)}`)\n                .join('\\n')}\n            </code>\n          </pre>\n        </ErrorDetailsField>\n      )}\n      <ErrorDetailsField name=\"Stacktrace\">\n        <pre>\n          <code>{error.stack ?? '~'}</code>\n        </pre>\n      </ErrorDetailsField>\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { faCaretDown } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { classes } from '../../utils/misc';\n\nimport './stylesheet.scss';\n\nexport type ExpandableCardProps = {\n  label?: string;\n  children: React.ReactNode;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\n/**\n * Renders a simple expandable card that has a button\n * which can be clicked to render all content.\n */\nexport default function ExpandableCard({\n  children,\n  label = 'Details',\n  className,\n  style,\n}: ExpandableCardProps): React.ReactElement {\n  const [showChildren, setShowChildren] = useState(false);\n\n  return (\n    <div className={classes('expandable-card', className)} style={style}>\n      <button\n        className=\"expandable-card-button\"\n        onClick={(): void => setShowChildren(!showChildren)}\n        type=\"button\"\n      >\n        <FontAwesomeIcon\n          fixedWidth\n          icon={faCaretDown}\n          style={{\n            transform: showChildren ? 'rotate(-90deg)' : 'none',\n            marginRight: 8,\n          }}\n        />\n        {label}\n      </button>\n      {showChildren && children}\n    </div>\n  );\n}\n","import React from 'react';\n\nimport ExpandableCard from '../ExpandableCard';\n\nimport './stylesheet.scss';\n\nexport const GITHUB_ISSUE_URL =\n  'https://github.com/gt-scheduler/website/issues/new?assignees=&labels=bug&template=bug-report----.md&title=';\n\nexport type ErrorDisplayProps = {\n  errorDetails: React.ReactNode;\n  children: React.ReactNode;\n};\n\n/**\n * Renders the content for an error display,\n * directing the user to report the error to GitHub\n * and showing a collapsible section that includes details.\n */\nexport default function ErrorDisplay({\n  errorDetails,\n  children,\n}: ErrorDisplayProps): React.ReactElement {\n  return (\n    <div className=\"error-display-outer\">\n      {children}\n      <div>\n        If the issue keeps happening, please consider filing{' '}\n        <a href={GITHUB_ISSUE_URL} target=\"_blank\" rel=\"noreferrer noopener\">\n          a new issue on the gt-scheduler GitHub\n        </a>\n        , and include the information below under &ldquo;Error Details&rdquo; in\n        addition to what you were doing when the error occurred.\n      </div>\n      <div>\n        The error has already been logged, but filing an issue lets you provide\n        more information about what happened and makes it a lot easier for us to\n        fix the bug. Thanks ❤\n      </div>\n      <ExpandableCard label=\"Error Details\">{errorDetails}</ExpandableCard>\n    </div>\n  );\n}\n","import { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\n\nimport './stylesheet.scss';\n\n/**\n * Renders the top of an error display,\n * with an icon and a title saying 'An error occurred'\n */\nexport default function ErrorHeader(): React.ReactElement {\n  return (\n    <div className=\"error-header\">\n      <FontAwesomeIcon icon={faExclamationTriangle} />\n      <h4>An error occurred :(</h4>\n    </div>\n  );\n}\n","import React, {\n  useState,\n  useCallback,\n  useEffect,\n  useMemo,\n  useContext,\n} from 'react';\n\nimport { NavDrawer, NavMenu } from '..';\nimport useMobile from '../../hooks/useMobile';\nimport { ErrorWithFields } from '../../log';\n\nexport const NAV_TABS = ['Scheduler', 'Map'];\n\nexport type AppNavigationContextValue = {\n  currentTabIndex: number;\n  setTabIndex: (next: number) => void;\n  isDrawerOpen: boolean;\n  openDrawer: () => void;\n  closeDrawer: () => void;\n};\n\nexport const AppNavigationContext =\n  React.createContext<AppNavigationContextValue>({\n    currentTabIndex: 0,\n    setTabIndex: (): void => {\n      throw new ErrorWithFields({\n        message: 'empty AppNavigationContext.setTabIndex value being used',\n      });\n    },\n    isDrawerOpen: false,\n    openDrawer: (): void => {\n      throw new ErrorWithFields({\n        message: 'empty AppNavigationContext.openDrawer value being used',\n      });\n    },\n    closeDrawer: (): void => {\n      throw new ErrorWithFields({\n        message: 'empty AppNavigationContext.closeDrawer value being used',\n      });\n    },\n  });\n\nexport type AppNavigationProps = {\n  children: React.ReactNode;\n};\n\n/**\n * Handles controlling the state of app navigation,\n * including the drawer and top-level tabs\n */\nexport function AppNavigation({\n  children,\n}: AppNavigationProps): React.ReactElement {\n  const mobile = useMobile();\n\n  // Allow top-level tab-based navigation\n  const [currentTabIndex, setTabIndex] = useState(0);\n\n  // Handle the status of the drawer being open on mobile\n  const [isDrawerOpen, setIsDrawerOpen] = useState(false);\n  const openDrawer = useCallback(() => setIsDrawerOpen(true), []);\n  const closeDrawer = useCallback(() => setIsDrawerOpen(false), []);\n  useEffect(() => {\n    // Close the drawer if switching to desktop\n    if (isDrawerOpen && !mobile) {\n      setIsDrawerOpen(false);\n    }\n  }, [isDrawerOpen, mobile]);\n\n  // Memoize the context value\n  const contextValue = useMemo<AppNavigationContextValue>(\n    () => ({\n      currentTabIndex,\n      setTabIndex,\n      isDrawerOpen,\n      openDrawer,\n      closeDrawer,\n    }),\n    [currentTabIndex, setTabIndex, isDrawerOpen, openDrawer, closeDrawer]\n  );\n\n  return (\n    <AppNavigationContext.Provider value={contextValue}>\n      {children}\n    </AppNavigationContext.Provider>\n  );\n}\n\n/**\n * Adds the nav drawer that is conditionally open depending on navigation state\n * when the app is running on a mobile device\n */\nexport function AppMobileNav(): React.ReactElement | null {\n  const mobile = useMobile();\n  const { currentTabIndex, setTabIndex, isDrawerOpen, closeDrawer } =\n    useContext(AppNavigationContext);\n\n  if (!mobile) return null;\n\n  return (\n    <NavDrawer open={isDrawerOpen} onClose={closeDrawer}>\n      <NavMenu\n        items={NAV_TABS}\n        currentItem={currentTabIndex}\n        onChangeItem={setTabIndex}\n      />\n    </NavDrawer>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nimport { softError, ErrorWithFields } from '../../log';\nimport { LoadingState, NonEmptyArray } from '../../types';\nimport { exponentialBackoff, isAxiosNetworkError } from '../../utils/misc';\nimport Cancellable from '../../utils/cancellable';\n\nconst CRAWLER_REPO = 'gt-scheduler/crawler';\nconst CRAWLER_BRANCH = 'gh-pages';\nconst GITHUB_API_URL = `https://api.github.com/repos/${CRAWLER_REPO}/contents?ref=${CRAWLER_BRANCH}`;\n\n/**\n * Downloads the list of terms that the crawler has valid data for.\n * Repeatedly attempts to load in the case of errors,\n * and cancels itself once the parent context is unmounted.\n */\nexport default function useDownloadTerms(): LoadingState<\n  NonEmptyArray<string>\n> {\n  const [state, setState] = useState<LoadingState<NonEmptyArray<string>>>({\n    type: 'loading',\n  });\n\n  // Fetch all terms via the GitHub API\n  useEffect(() => {\n    const loadOperation = new Cancellable();\n    async function load(): Promise<void> {\n      let attemptNumber = 1;\n      while (!loadOperation.isCancelled) {\n        try {\n          const promise = axios.get<{ name: string }[]>(GITHUB_API_URL);\n          const result = await loadOperation.perform(promise);\n          if (result.cancelled) {\n            return;\n          }\n\n          const newTerms = result.value.data\n            .map((content) => content.name)\n            .filter((name) => /\\d{6}\\.json/.test(name))\n            .map((name) => name.replace(/\\.json$/, ''))\n            .sort()\n            .reverse();\n\n          // Ensure that there is at least 1 term before continuing\n          if (newTerms.length === 0) {\n            throw new ErrorWithFields({\n              message: 'fetched list of terms is empty; cannot continue',\n            });\n          }\n\n          setState({\n            type: 'loaded',\n            result: newTerms as NonEmptyArray<string>,\n          });\n\n          return;\n        } catch (err) {\n          // Report the error to Sentry if not a network error\n          if (!isAxiosNetworkError(err)) {\n            softError(\n              new ErrorWithFields({\n                message: 'error fetching list of terms',\n                source: err,\n                fields: {\n                  url: GITHUB_API_URL,\n                },\n              })\n            );\n          }\n\n          // Flag that an error has occurred\n          setState({\n            type: 'error',\n            error:\n              err instanceof Error\n                ? err\n                : new ErrorWithFields({\n                    message: 'an error occurred while fetching terms',\n                    source: err,\n                  }),\n            stillLoading: true,\n            overview: String(err),\n          });\n        }\n\n        // Sleep for an exponential backoff between each retry\n        await exponentialBackoff(attemptNumber);\n        attemptNumber += 1;\n      }\n    }\n\n    load().catch(() => {\n      // Unreachable\n    });\n\n    // Cancel the background load when this cleans up\n    return (): void => {\n      loadOperation.cancel();\n    };\n  }, [setState]);\n\n  return state;\n}\n","import React from 'react';\n\nimport {\n  LoadingStateLoading,\n  LoadingStateError,\n  LoadingStateCustom,\n} from '../../types';\nimport { LoadingErrorDetails } from '../ErrorDetails';\nimport ErrorDisplay from '../ErrorDisplay';\nimport ErrorHeader from '../ErrorHeader';\nimport Spinner from '../Spinner';\n\nimport './stylesheet.scss';\n\nexport type LoadingDisplayProps = {\n  state: LoadingStateLoading | LoadingStateError | LoadingStateCustom;\n  name: string;\n};\n\n/**\n * Renders a `LoadingState<T>` value,\n * showing a spinner if the state is loading,\n * and an error otherwise if an error ocurred.\n */\nexport default function LoadingDisplay({\n  state,\n  name,\n}: LoadingDisplayProps): React.ReactElement {\n  let contents: React.ReactNode;\n  if (state.type === 'loading') {\n    contents = (\n      <>\n        <Spinner size=\"normal\" style={{ opacity: 0.6 }} />\n        <h4>Loading</h4>\n        <div>{name}</div>\n      </>\n    );\n  } else if (state.type === 'custom') {\n    // Don't wrap custom contents in the outer div\n    return <>{state.contents}</>;\n  } else if (state.stillLoading) {\n    contents = (\n      <>\n        <Spinner size=\"normal\" style={{ opacity: 0.6 }} />\n        <h4>Loading</h4>\n        <ErrorDisplay\n          errorDetails={\n            <LoadingErrorDetails\n              error={state.error}\n              overview={state.overview}\n              name={name}\n            />\n          }\n        >\n          <div>\n            An error ocurred while loading {name}: {state.overview}\n          </div>\n          <div>\n            The application is retrying in the background, so the issue may\n            resolve itself. If it doesn&apos;t, try refreshing the page.\n          </div>\n        </ErrorDisplay>\n      </>\n    );\n  } else {\n    contents = (\n      <>\n        <ErrorHeader />\n        <ErrorDisplay\n          errorDetails={\n            <LoadingErrorDetails\n              error={state.error}\n              overview={state.overview}\n              name={name}\n            />\n          }\n        >\n          <div>\n            An unrecoverable error ocurred while loading {name}:{' '}\n            {state.overview}\n          </div>\n          <div>Try refreshing the page to see if it fixes the issue.</div>\n        </ErrorDisplay>\n      </>\n    );\n  }\n\n  return <div className=\"loading-display\">{contents}</div>;\n}\n","import React, { useContext } from 'react';\n\nimport { Header, Scheduler, Attribution } from '..';\nimport { ReactErrorDetails } from '../ErrorDetails';\nimport ErrorDisplay from '../ErrorDisplay';\nimport ErrorHeader from '../ErrorHeader';\nimport ErrorBoundary from '../ErrorBoundary';\nimport HeaderDisplay from '../HeaderDisplay';\nimport Map from '../Map';\nimport { AppNavigationContext, AppMobileNav, NAV_TABS } from './navigation';\nimport { classes } from '../../utils/misc';\n\n/**\n * Renders the actual content at the root of the app\n * once it has completely loaded state,\n * including headers & footers.\n * This component is memoized, so it only re-renders when its context changes.\n */\nfunction AppContentBase(): React.ReactElement {\n  const { currentTabIndex, setTabIndex, openDrawer } =\n    useContext(AppNavigationContext);\n\n  return (\n    <>\n      <AppMobileNav />\n      <Header\n        currentTab={currentTabIndex}\n        onChangeTab={setTabIndex}\n        onToggleMenu={openDrawer}\n        tabs={NAV_TABS}\n      />\n      <ErrorBoundary\n        fallback={(error, errorInfo): React.ReactElement => (\n          <SkeletonContent>\n            <ErrorHeader />\n            <ErrorDisplay\n              errorDetails={\n                <ReactErrorDetails error={error} errorInfo={errorInfo} />\n              }\n            >\n              <div>\n                There was en error somewhere somewhere in the{' '}\n                {NAV_TABS[currentTabIndex] ?? '?'} tab and it can&apos;t\n                continue.\n              </div>\n              <div>Try refreshing the page to see if it fixes the issue.</div>\n            </ErrorDisplay>\n          </SkeletonContent>\n        )}\n      >\n        {currentTabIndex === 0 && <Scheduler />}\n        {currentTabIndex === 1 && <Map />}\n      </ErrorBoundary>\n      <Attribution />\n    </>\n  );\n}\n\n/**\n * Renders the actual content at the root of the app\n * once it has completely loaded state,\n * including headers & footers.\n * This component is memoized, so it only re-renders when its context changes.\n */\nexport const AppContent = React.memo(AppContentBase);\n\nexport type AppSkeletonWithLoadingTermsProps = {\n  children: React.ReactNode;\n};\n\n/**\n * Renders a non-functional \"skeleton\" of the app\n * that shows as much content as possible without needing valid context values.\n * The term select box is marked as loading and cannot be interacted with.\n */\nexport function AppSkeletonWithLoadingTerms({\n  children,\n}: AppSkeletonWithLoadingTermsProps): React.ReactElement {\n  const { currentTabIndex, setTabIndex, openDrawer } =\n    useContext(AppNavigationContext);\n\n  return (\n    <>\n      <AppMobileNav />\n      <HeaderDisplay\n        currentTab={currentTabIndex}\n        onChangeTab={setTabIndex}\n        onToggleMenu={openDrawer}\n        tabs={NAV_TABS}\n        termsState={{ type: 'loading' }}\n      />\n      {children}\n      <Attribution />\n    </>\n  );\n}\n\nexport type AppSkeletonWithSwitchableTermsProps = {\n  children: React.ReactNode;\n  terms: string[];\n  currentTerm: string;\n  onChangeTerm: (next: string) => void;\n};\n\n/**\n * Renders a non-functional \"skeleton\" of the app\n * that shows as much content as possible without needing valid context values.\n * The term select box can be interacted with.\n */\nexport function AppSkeletonWithSwitchableTerms({\n  children,\n  terms,\n  currentTerm,\n  onChangeTerm,\n}: AppSkeletonWithSwitchableTermsProps): React.ReactElement {\n  const { currentTabIndex, setTabIndex, openDrawer } =\n    useContext(AppNavigationContext);\n\n  return (\n    <>\n      <AppMobileNav />\n      <HeaderDisplay\n        currentTab={currentTabIndex}\n        onChangeTab={setTabIndex}\n        onToggleMenu={openDrawer}\n        tabs={NAV_TABS}\n        termsState={{ type: 'loaded', terms, currentTerm, onChangeTerm }}\n      />\n      {children}\n      <Attribution />\n    </>\n  );\n}\n\nexport type SkeletonContentProps = {\n  children: React.ReactNode;\n};\n\n/**\n * Parent component for any content rendered inside an app skeleton,\n * centering it horizontally and vertically\n * and allowing vertical overflow to be scrolled.\n */\nexport function SkeletonContent({\n  children,\n}: SkeletonContentProps): React.ReactElement {\n  return (\n    <div className={classes('main', 'skeleton')}>\n      <div className=\"skeleton-content\">\n        <div className=\"skeleton-content-inner\">{children}</div>\n      </div>\n    </div>\n  );\n}\n","import { faExclamationCircle } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\n\nimport './stylesheet.scss';\n\n/**\n * Renders the top of a warning,\n * with an icon and a title saying 'Warning'\n */\nexport default function WarningHeader(): React.ReactElement {\n  return (\n    <div className=\"warning-header\">\n      <FontAwesomeIcon icon={faExclamationCircle} />\n      <h4>Warning</h4>\n    </div>\n  );\n}\n","import React from 'react';\n\nimport WarningHeader from '../WarningHeader';\n\nimport './stylesheet.scss';\n\n/**\n * Renders a notification that schedule data is not persistent\n * and that the user can't use the application.\n */\nexport function renderDataNotPersistentNotification(\n  props: DataNotPersistentNotificationProps\n): React.ReactElement {\n  return <DataNotPersistentNotification {...props} />;\n}\n\nexport type DataNotPersistentNotificationProps = {\n  onAccept: () => void;\n};\n\n/**\n * Content that is shown in the modal when `showDataNotPersistentNotification`\n * is called\n */\nexport function DataNotPersistentNotification({\n  onAccept,\n}: DataNotPersistentNotificationProps): React.ReactElement {\n  return (\n    <div className=\"data-not-persistent-notification\">\n      <WarningHeader />\n      <p>\n        Your browser doesn&apos;t support storing data using local storage,\n        which gt-scheduler relies on to persist schedule data between sessions.\n      </p>\n      <p>Reasons this might be the case:</p>\n      <ul>\n        <li>\n          You&apos;re using an outdated browser that doesn&apos;t support local\n          storage\n        </li>\n        <li>You&apos;re using Mobile Safari with private mode enabled</li>\n        <li>You&apos;re using Safari with cookies disabled</li>\n      </ul>\n      <p>\n        <strong>\n          Would you like to continue using gt-scheduler? Your schedules will not\n          be saved once you close this tab.\n        </strong>\n      </p>\n      <button\n        className=\"data-not-persistent-notification--button\"\n        onClick={onAccept}\n        type=\"button\"\n      >\n        Accept\n      </button>\n    </div>\n  );\n}\n","export type TermData = {\n  desiredCourses: string[];\n  pinnedCrns: string[];\n  excludedCrns: string[];\n  colorMap: Record<string, string>;\n  sortingOptionIndex: number;\n};\n\nexport const defaultTermData: TermData = {\n  desiredCourses: [],\n  pinnedCrns: [],\n  excludedCrns: [],\n  colorMap: {},\n  sortingOptionIndex: 0,\n};\n","import { ErrorWithFields } from '../../log';\nimport { NonEmptyArray } from '../../types';\nimport { TermData, defaultTermData } from './types';\n\nexport type TermDataParseResult =\n  | { type: 'error'; error: Error }\n  | { type: 'parsed'; parsed: unknown };\n\n/**\n * Parses raw term data from its string representation to the parsed JSON\n */\nexport function parseTermData(rawTermData: string): TermDataParseResult {\n  if (rawTermData === '' || rawTermData === 'undefined') {\n    return {\n      type: 'error',\n      error: new ErrorWithFields({\n        message: 'raw term data was empty or \"undefined\"',\n        fields: {\n          rawTermData,\n        },\n      }),\n    };\n  }\n\n  try {\n    return { type: 'parsed', parsed: JSON.parse(rawTermData) };\n  } catch (err) {\n    return {\n      type: 'error',\n      error: new ErrorWithFields({\n        message: 'raw term data was not valid JSON data',\n        source: err,\n        fields: {\n          rawTermData,\n        },\n      }),\n    };\n  }\n}\n\nexport type TermDataValidationResult =\n  | { type: 'error'; errors: NonEmptyArray<Error>; fallback: TermData }\n  | { type: 'valid'; termData: TermData };\n\nconst isStringArray = (field: unknown): field is string[] =>\n  field != null &&\n  Array.isArray(field) &&\n  field.every((elem) => typeof elem === 'string');\n\nconst isStringStringMap = (field: unknown): field is Record<string, string> =>\n  typeof field === 'object' &&\n  field != null &&\n  Object.keys(field).every((elem) => typeof elem === 'string') &&\n  Object.values(field).every((elem) => typeof elem === 'string');\n\n/**\n * Validates parsed term data, ensuring that it is of the expected shape\n */\nexport function validateTermData(\n  termData: unknown,\n  rawTermData?: string\n): TermDataValidationResult {\n  try {\n    if (\n      termData == null ||\n      typeof termData !== 'object' ||\n      Array.isArray(termData)\n    ) {\n      return {\n        type: 'error',\n        fallback: defaultTermData,\n        errors: [\n          new ErrorWithFields({\n            message: 'term data is the wrong type',\n            fields: {\n              rawTermData,\n              termDataType: typeof termData,\n              termData,\n            },\n          }),\n        ],\n      };\n    }\n\n    const validTermData = { ...defaultTermData };\n\n    // Ensure each field is valid, copying them as we go\n    const termDataAsRecord = termData as Record<string, unknown>;\n    const fieldValidationErrors: Error[] = [];\n    const {\n      desiredCourses,\n      pinnedCrns,\n      excludedCrns,\n      colorMap,\n      sortingOptionIndex,\n    } = termDataAsRecord;\n\n    if (isStringArray(desiredCourses)) {\n      validTermData.desiredCourses = desiredCourses;\n    } else {\n      fieldValidationErrors.push(\n        new ErrorWithFields({\n          message: 'termData.desiredCourses was not a string array',\n          fields: {\n            rawTermData,\n            termData,\n            desiredCourses,\n            fallback: validTermData.desiredCourses,\n          },\n        })\n      );\n    }\n\n    if (isStringArray(pinnedCrns)) {\n      validTermData.pinnedCrns = pinnedCrns;\n    } else {\n      fieldValidationErrors.push(\n        new ErrorWithFields({\n          message: 'termData.pinnedCrns was not a string array',\n          fields: {\n            rawTermData,\n            termData,\n            pinnedCrns,\n            fallback: validTermData.pinnedCrns,\n          },\n        })\n      );\n    }\n\n    if (isStringArray(excludedCrns)) {\n      validTermData.excludedCrns = excludedCrns;\n    } else {\n      fieldValidationErrors.push(\n        new ErrorWithFields({\n          message: 'termData.excludedCrns was not a string array',\n          fields: {\n            rawTermData,\n            termData,\n            excludedCrns,\n            fallback: validTermData.excludedCrns,\n          },\n        })\n      );\n    }\n\n    if (isStringStringMap(colorMap)) {\n      validTermData.colorMap = colorMap;\n    } else {\n      fieldValidationErrors.push(\n        new ErrorWithFields({\n          message: 'termData.colorMap was not a string/string map',\n          fields: {\n            rawTermData,\n            termData,\n            colorMap,\n            fallback: validTermData.colorMap,\n          },\n        })\n      );\n    }\n\n    if (typeof sortingOptionIndex === 'number') {\n      validTermData.sortingOptionIndex = sortingOptionIndex;\n    } else {\n      fieldValidationErrors.push(\n        new ErrorWithFields({\n          message: 'termData.sortingOptionIndex was not a number',\n          fields: {\n            rawTermData,\n            termData,\n            sortingOptionIndex,\n            fallback: validTermData.sortingOptionIndex,\n          },\n        })\n      );\n    }\n\n    if (fieldValidationErrors.length > 0) {\n      return {\n        type: 'error',\n        fallback: validTermData,\n        errors: fieldValidationErrors as NonEmptyArray<Error>,\n      };\n    }\n\n    return { type: 'valid', termData: validTermData };\n  } catch (err) {\n    if (err instanceof Error) {\n      return {\n        type: 'error',\n        fallback: defaultTermData,\n        errors: [\n          new ErrorWithFields({\n            message: 'an unexpected error occurred when parsing term data',\n            source: err,\n            fields: {\n              rawTermData,\n            },\n          }),\n        ],\n      };\n    }\n\n    return {\n      type: 'error',\n      fallback: defaultTermData,\n      errors: [\n        new ErrorWithFields({\n          message: 'an unexpected error occurred when parsing term data',\n          fields: {\n            rawTermData,\n            originalError: err,\n          },\n        }),\n      ],\n    };\n  }\n}\n","import { parseTermData, validateTermData } from '../legacy/validation';\nimport { softError, ErrorWithFields } from '../../log';\nimport { isTerm } from '../../utils/semesters';\nimport { Version1ScheduleData, Version1TermScheduleData } from '../types';\n\nexport const defaultVersion1ScheduleData: Version1ScheduleData = {\n  terms: {},\n  currentTerm: '',\n  version: 1,\n};\n\n/**\n * Attempts to \"migrate\" the existing data from the legacy cookie format\n * to version 1 of the schedule data. The output of this function should be\n * safe to migrate to further versions, if applicable. If allCookies\n * is an empty record, then this function returns the default v1 schedule data.\n * @param allCookies - the result of `Cookies.get()` with no arguments --\n * a record of all cookie keys -> values\n */\nexport default function migrateCookiesTo1(\n  allCookies: Record<string, string>\n): Version1ScheduleData {\n  const currentTerm = allCookies['term'] ?? '';\n\n  // Create a number to correlate error events\n  const userNumber = Math.floor(Math.random() * 100000);\n\n  // Collect the values of all cookies that look like term schedule data:\n  const terms: Record<string, Version1TermScheduleData> = {};\n  Object.entries(allCookies).forEach(([cookieKey, cookieValue]): void => {\n    if (isTerm(cookieKey)) {\n      // Try to parse and validate the term information\n      const parseResult = parseTermData(cookieValue);\n      if (parseResult.type === 'error') {\n        softError(\n          new ErrorWithFields({\n            message: 'parsing error for guessed term data when migrating',\n            source: parseResult.error,\n            fields: {\n              cookieKey,\n              cookieValue,\n              userNumber,\n            },\n          })\n        );\n        return;\n      }\n\n      const validateResult = validateTermData(parseResult.parsed, cookieValue);\n      if (validateResult.type === 'error') {\n        validateResult.errors.forEach((err) => {\n          softError(\n            new ErrorWithFields({\n              message: 'validation error for guessed term data when migrating',\n              source: err,\n              fields: {\n                cookieKey,\n                cookieValue,\n                userNumber,\n              },\n            })\n          );\n        });\n\n        terms[cookieKey] = {\n          versions: [{ name: 'Primary', schedule: validateResult.fallback }],\n          currentIndex: 0,\n        };\n      } else {\n        terms[cookieKey] = {\n          versions: [{ name: 'Primary', schedule: validateResult.termData }],\n          currentIndex: 0,\n        };\n      }\n    }\n  });\n\n  return {\n    terms,\n    currentTerm,\n    version: 1,\n  };\n}\n","import { useState, useEffect } from 'react';\n\nimport { softError, ErrorWithFields } from '../../log';\nimport { LoadingStateError, LoadingStateCustom } from '../../types';\nimport migrateScheduleData from '../migrations';\nimport {\n  AnyScheduleData,\n  ScheduleData,\n  LATEST_SCHEDULE_DATA_VERSION,\n} from '../types';\n\nexport type MigrationErrorState = LoadingStateError | LoadingStateCustom;\nexport type MigrationResult =\n  | { type: 'done'; result: ScheduleData }\n  | { type: 'pending' }\n  | { type: 'error'; error: MigrationErrorState };\n\n/**\n * Performs an asynchronous migration of the schedule data,\n * ensuring that it is of the latest version's shape\n * using the migrations defined in `src/data/migrations.\n */\nexport default function useScheduleDataMigrations({\n  rawScheduleData,\n  setScheduleData,\n}: {\n  rawScheduleData: AnyScheduleData | null;\n  setScheduleData: (next: ScheduleData) => void;\n}): MigrationResult {\n  const [error, setError] = useState<MigrationErrorState | null>(null);\n\n  useEffect(() => {\n    // Make sure the data needs migrating\n    if (\n      rawScheduleData !== null &&\n      rawScheduleData.version === LATEST_SCHEDULE_DATA_VERSION\n    )\n      return;\n\n    try {\n      const updatedScheduleData = migrateScheduleData(rawScheduleData);\n      setScheduleData(updatedScheduleData);\n    } catch (err) {\n      // An error occurred: the safe thing to do is report to the user & stop\n      const newError = new ErrorWithFields({\n        source: err,\n        message: 'an error occurred when loading schedule data',\n      });\n\n      softError(newError);\n      setError({\n        type: 'error',\n        error: newError,\n        stillLoading: false,\n        overview: 'could not convert stored schedule data to latest version',\n      });\n    }\n  }, [rawScheduleData, setScheduleData]);\n\n  if (error !== null) {\n    return { type: 'error', error };\n  }\n\n  if (\n    rawScheduleData === null ||\n    rawScheduleData.version !== LATEST_SCHEDULE_DATA_VERSION\n  ) {\n    return { type: 'pending' };\n  }\n\n  return { type: 'done', result: rawScheduleData };\n}\n","import Cookies from 'js-cookie';\n\nimport { softError, ErrorWithFields } from '../../log';\nimport {\n  AnyScheduleData,\n  ScheduleData,\n  Version1ScheduleDataOrNewer,\n} from '../types';\nimport migrateCookiesTo1, { defaultVersion1ScheduleData } from './cookiesTo1';\n\n/**\n * Attempts to migrate the given \"raw\" schedule data\n * (which can be of any version) to the latest version,\n * automatically applying pre-defined migrations between versions.\n * If this function fails, it will throw an error; otherwise,\n * it returns an instance of the schedule data for the latest version\n */\nexport default function migrateScheduleData(\n  rawScheduleData: AnyScheduleData | null\n): ScheduleData {\n  // Having the `scheduleData` be `null`counts as a \"special\" migration\n  // from the legacy storage method (if it exists).\n  let scheduleDataVersion1OrNewer: Version1ScheduleDataOrNewer;\n  if (rawScheduleData === null) {\n    try {\n      const allCookies = Cookies.get();\n      scheduleDataVersion1OrNewer = migrateCookiesTo1(allCookies);\n    } catch (err) {\n      // An error occurred: fall back to the default data & report it\n      softError(\n        new ErrorWithFields({\n          source: err,\n          message: 'an error occurred when sourcing schedule data from cookies',\n        })\n      );\n      scheduleDataVersion1OrNewer = defaultVersion1ScheduleData;\n    }\n  } else {\n    scheduleDataVersion1OrNewer = rawScheduleData;\n  }\n\n  // Apply any other migrations here if the version of the data\n  // is lesser than the current one. For example:\n  // let scheduleDataVersion2OrNewer: Version2ScheduleDataOrNewer;\n  // if (scheduleDataVersion1OrNewer.version === 1) {\n  //   scheduleDataVersion2OrNewer =\n  //     migrateVersion1To2(scheduleDataVersion1OrNewer);\n  //   // scheduleDataVersion2OrNewer.version is now 2\n  // } else {\n  //   scheduleDataVersion2OrNewer = scheduleDataVersion1OrNewer;\n  // }\n  // Note: if a migration fails, we probably can't continue,\n  // so feel free to throw an error that will be caught by the caller.\n\n  return scheduleDataVersion1OrNewer;\n}\n","import produce, { Immutable, Draft, castDraft } from 'immer';\nimport { useEffect, useCallback } from 'react';\n\nimport { ErrorWithFields, softError } from '../../log';\nimport { NonEmptyArray, LoadingState } from '../../types';\nimport {\n  ScheduleData,\n  TermScheduleData,\n  defaultTermScheduleData,\n} from '../types';\n\n/**\n * Gets the current term schedule data based on the current term,\n * ensuring that there is a valid current term selected.\n * If the current term isn't valid (i.e. empty or not in the `terms` array),\n * then it is set to the most recent term (which is the first item in `terms`).\n * If the term schedule data for the current term doesn't exist,\n * then this hook also initializes it to an empty value.\n */\nexport default function useExtractTermScheduleData(\n  terms: NonEmptyArray<string>,\n  scheduleData: Immutable<ScheduleData>,\n  updateScheduleData: (\n    applyDraft: (draft: Draft<ScheduleData>) => void | Immutable<ScheduleData>\n  ) => void\n): LoadingState<{\n  currentTerm: string;\n  termScheduleData: Immutable<TermScheduleData>;\n  // This function allows the term schedule data to be edited in 1 of 2 ways:\n  // 1. the draft parameter is mutated, and the function returns nothing/void\n  // 2. the draft parameter is not mutated\n  //    (it can still be used, just not mutated)\n  //    and the function returns the new state to use.\n  //    This is similar to a traditional setState callback\n  updateTermScheduleData: (\n    applyDraft: (\n      draft: Draft<TermScheduleData>\n    ) => void | Immutable<TermScheduleData>\n  ) => void;\n}> {\n  // Set the term to be the first one if it is unset or no longer valid.\n  // Also, ensure that there is a valid term schedule data object for that term\n  useEffect(() => {\n    const mostRecentTerm = terms[0];\n    const correctedTerm = !isValidTerm(scheduleData.currentTerm, terms)\n      ? mostRecentTerm\n      : scheduleData.currentTerm;\n\n    const currentTermScheduleData = scheduleData.terms[correctedTerm];\n    const correctedTermScheduleData =\n      currentTermScheduleData === undefined\n        ? defaultTermScheduleData\n        : currentTermScheduleData;\n\n    if (\n      correctedTerm !== scheduleData.currentTerm ||\n      correctedTermScheduleData !== currentTermScheduleData\n    ) {\n      updateScheduleData((draft) => {\n        draft.currentTerm = correctedTerm;\n        draft.terms[correctedTerm] = castDraft(correctedTermScheduleData);\n      });\n    }\n  }, [scheduleData.currentTerm, scheduleData.terms, terms, updateScheduleData]);\n\n  const { currentTerm } = scheduleData;\n  const currentTermScheduleData = scheduleData.terms[currentTerm];\n\n  // Create a nested update callback for just the term's schedule data.\n  // This should only escape this function\n  // when `currentTermScheduleData` is not undefined\n  const updateTermScheduleData = useCallback(\n    (\n      applyDraft: (\n        draft: Draft<TermScheduleData>\n      ) => void | Immutable<TermScheduleData>\n    ): void => {\n      updateScheduleData((draft) => {\n        const currentTermScheduleDataDraft = draft.terms[currentTerm];\n        if (currentTermScheduleDataDraft === undefined) {\n          softError(\n            new ErrorWithFields({\n              message:\n                'updateTermScheduleData called on term that does not exist',\n              fields: {\n                currentTerm,\n                currentTermScheduleData,\n                terms,\n                allTermsInData: Object.keys(draft.terms),\n              },\n            })\n          );\n          return;\n        }\n\n        draft.terms[currentTerm] = produce(\n          currentTermScheduleDataDraft,\n          (termScheduleData) => castDraft(applyDraft(termScheduleData))\n        );\n      });\n    },\n    [currentTerm, terms, currentTermScheduleData, updateScheduleData]\n  );\n\n  if (\n    !isValidTerm(currentTerm, terms) ||\n    currentTermScheduleData === undefined\n  ) {\n    return { type: 'loading' };\n  }\n\n  return {\n    type: 'loaded',\n    result: {\n      currentTerm,\n      termScheduleData: currentTermScheduleData,\n      updateTermScheduleData,\n    },\n  };\n}\n\n/**\n * Determines if the given term is considered \"valid\";\n * helps to recover from invalid cookie values if possible.\n */\nexport function isValidTerm(term: string, terms: string[]): boolean {\n  return term !== '' && term !== 'undefined' && terms.includes(term);\n}\n","import React, { useCallback } from 'react';\nimport { Immutable, Draft } from 'immer';\n\nimport { Oscar } from '../../data/beans';\nimport useDownloadOscarData from '../../data/hooks/useDownloadOscarData';\nimport useDownloadTerms from '../../data/hooks/useDownloadTerms';\nimport { NonEmptyArray } from '../../types';\nimport LoadingDisplay from '../LoadingDisplay';\nimport {\n  AppSkeletonWithLoadingTerms,\n  SkeletonContent,\n  AppSkeletonWithSwitchableTerms,\n} from '../App/content';\nimport {\n  ScheduleData,\n  ScheduleVersion,\n  TermScheduleData,\n} from '../../data/types';\nimport useScheduleDataFromStorage from '../../data/hooks/useScheduleDataFromStorage';\nimport { ErrorWithFields } from '../../log';\nimport useExtractSchedule from '../../data/hooks/useExtractScheduleVersion';\nimport useExtractTermScheduleData from '../../data/hooks/useExtractTermScheduleData';\n\n// Each of the components in this file is a \"stage\" --\n// a component that takes in a render function for its `children` prop\n// that it uses to pass in the results of the stage on to the next one.\n// If a stage is loading or has an error,\n// then it renders its own loading/error view\n// and does not call its `children` prop,\n// effectively \"stopping\" the loading chain at that stage.\n//\n// The problem that this design solves is needing to perform\n// a series of operations, whether data fetching or maintaining invariants\n// (like having a valid current term/version),\n// where an operation depends on the results of previous action(s).\n// For example, ensuring that the current term is valid\n// depends on fetching the list of terms from the GitHub API,\n// so having them be two separate stages naturally encodes this dependency.\n\nexport type StageLoadScheduleDataProps = {\n  children: (props: {\n    scheduleData: Immutable<ScheduleData>;\n    // This is similar to a function like `(next: ScheduleData) => void`\n    // in that it lets callers update the schedule data, but it uses Immer.js\n    // to provide a mutable \"draft\" that allows callers to treat\n    // the parameter given in the callback as if it can be directly mutated.\n    // This saves verbose code that is normally used to deeply clone objects\n    // before changing them whenever immutable state updates are needed\n    // (which is common in React apps).\n    // Read more about it here: https://immerjs.github.io/immer/\n    //\n    // This function allows the schedule data to be edited in 1 of 2 ways:\n    // 1. the draft parameter is mutated, and the function returns nothing/void\n    // 2. the draft parameter is not mutated\n    //    (it can still be used, just not mutated)\n    //    and the function returns the new state to use.\n    //    This is similar to a traditional setState callback\n    updateScheduleData: (\n      applyDraft: (draft: Draft<ScheduleData>) => void | Immutable<ScheduleData>\n    ) => void;\n    setTerm: (next: string) => void;\n  }) => React.ReactNode;\n};\n\n/**\n * Handles loading the local schedule data from local storage,\n * handling migrating it to a newer version as needed.\n * Renders a disabled header & attribution footer even when loading.\n */\nexport function StageLoadScheduleData({\n  children,\n}: StageLoadScheduleDataProps): React.ReactElement {\n  const loadingState = useScheduleDataFromStorage();\n\n  // We'll need `setTerm` in a few places, so we just construct here\n  // and send it to the children that we render.\n  const maybeUpdateScheduleData =\n    loadingState.type === 'loaded'\n      ? loadingState.result.updateScheduleData\n      : null;\n  const setTerm = useCallback(\n    (nextTerm: string): void => {\n      if (maybeUpdateScheduleData === null) {\n        throw new ErrorWithFields({\n          message: 'setTerm called when schedule data was not loaded yet',\n          fields: {\n            nextTerm,\n          },\n        });\n      }\n\n      maybeUpdateScheduleData((draft) => {\n        draft.currentTerm = nextTerm;\n      });\n    },\n    [maybeUpdateScheduleData]\n  );\n\n  if (loadingState.type !== 'loaded') {\n    return (\n      <AppSkeletonWithLoadingTerms>\n        <SkeletonContent>\n          <LoadingDisplay state={loadingState} name=\"local schedule data\" />\n        </SkeletonContent>\n      </AppSkeletonWithLoadingTerms>\n    );\n  }\n\n  return <>{children({ ...loadingState.result, setTerm })}</>;\n}\n\nexport type StageLoadTermsProps = {\n  children: (props: { terms: NonEmptyArray<string> }) => React.ReactNode;\n};\n\n/**\n * Handles loading the list of terms from the GitHub API upon first mount,\n * showing loading and error states as needed.\n * Renders a disabled header & attribution footer even when loading.\n */\nexport function StageLoadTerms({\n  children,\n}: StageLoadTermsProps): React.ReactElement {\n  const loadingState = useDownloadTerms();\n\n  if (loadingState.type !== 'loaded') {\n    return (\n      <AppSkeletonWithLoadingTerms>\n        <SkeletonContent>\n          <LoadingDisplay state={loadingState} name=\"list of current terms\" />\n        </SkeletonContent>\n      </AppSkeletonWithLoadingTerms>\n    );\n  }\n\n  return <>{children({ terms: loadingState.result })}</>;\n}\n\nexport type StageExtractTermScheduleDataProps = {\n  terms: NonEmptyArray<string>;\n  scheduleData: Immutable<ScheduleData>;\n  updateScheduleData: (\n    applyDraft: (draft: Draft<ScheduleData>) => void | Immutable<ScheduleData>\n  ) => void;\n  children: (props: {\n    currentTerm: string;\n    termScheduleData: Immutable<TermScheduleData>;\n    // This function allows the term schedule data to be edited in 1 of 2 ways:\n    // 1. the draft parameter is mutated, and the function returns nothing/void\n    // 2. the draft parameter is not mutated\n    //    (it can still be used, just not mutated)\n    //    and the function returns the new state to use.\n    //    This is similar to a traditional setState callback\n    updateTermScheduleData: (\n      applyDraft: (\n        draft: Draft<TermScheduleData>\n      ) => void | Immutable<TermScheduleData>\n    ) => void;\n  }) => React.ReactNode;\n};\n\n/**\n * Handles extracting the term schedule data from the parent schedule data,\n * ensuring that the term is valid before rendering its children.\n */\nexport function StageExtractTermScheduleData({\n  terms,\n  scheduleData,\n  updateScheduleData,\n  children,\n}: StageExtractTermScheduleDataProps): React.ReactElement {\n  const loadingState = useExtractTermScheduleData(\n    terms,\n    scheduleData,\n    updateScheduleData\n  );\n\n  if (loadingState.type !== 'loaded') {\n    return (\n      <AppSkeletonWithLoadingTerms>\n        <SkeletonContent>\n          <LoadingDisplay\n            state={loadingState}\n            name=\"schedule data for the current term\"\n          />\n        </SkeletonContent>\n      </AppSkeletonWithLoadingTerms>\n    );\n  }\n\n  return <>{children({ ...loadingState.result })}</>;\n}\n\n/**\n * Loads the instance of the `Oscar` bean from the crawled data,\n * showing loading and error states as needed.\n * Renders a disabled header & attribution footer even when loading.\n */\nexport type StageLoadOscarDataProps = {\n  terms: string[];\n  term: string;\n  setTerm: (next: string) => void;\n  children: (props: { oscar: Oscar }) => React.ReactNode;\n};\n\nexport function StageLoadOscarData({\n  terms,\n  term,\n  setTerm,\n  children,\n}: StageLoadOscarDataProps): React.ReactElement {\n  const loadingState = useDownloadOscarData(term);\n\n  if (loadingState.type !== 'loaded') {\n    return (\n      <AppSkeletonWithSwitchableTerms\n        terms={terms}\n        currentTerm={term}\n        onChangeTerm={setTerm}\n      >\n        <SkeletonContent>\n          <LoadingDisplay\n            state={loadingState}\n            name=\"Oscar course data for the current term\"\n          />\n        </SkeletonContent>\n      </AppSkeletonWithSwitchableTerms>\n    );\n  }\n\n  return <>{children({ oscar: loadingState.result })}</>;\n}\n\nexport type StageExtractScheduleVersionProps = {\n  terms: NonEmptyArray<string>;\n  currentTerm: string;\n  setTerm: (next: string) => void;\n  termScheduleData: Immutable<TermScheduleData>;\n  updateTermScheduleData: (\n    applyDraft: (\n      draft: Draft<TermScheduleData>\n    ) => void | Immutable<TermScheduleData>\n  ) => void;\n  children: (props: {\n    currentIndex: number;\n    scheduleVersion: Immutable<ScheduleVersion>;\n    // This function allows the schedule version to be edited in 1 of 2 ways:\n    // 1. the draft parameter is mutated, and the function returns nothing/void\n    // 2. the draft parameter is not mutated\n    //    (it can still be used, just not mutated)\n    //    and the function returns the new state to use.\n    //    This is similar to a traditional setState callback\n    updateScheduleVersion: (\n      applyDraft: (\n        draft: Draft<ScheduleVersion>\n      ) => void | Immutable<ScheduleVersion>\n    ) => void;\n  }) => React.ReactNode;\n};\n\n/**\n * Handles extracting the schedule version from the parent tern schedule data,\n * ensuring that it is valid before rendering its children.\n */\nexport function StageExtractScheduleVersion({\n  terms,\n  currentTerm,\n  setTerm,\n  termScheduleData,\n  updateTermScheduleData,\n  children,\n}: StageExtractScheduleVersionProps): React.ReactElement {\n  const loadingState = useExtractSchedule(\n    termScheduleData,\n    updateTermScheduleData\n  );\n\n  if (loadingState.type !== 'loaded') {\n    return (\n      <AppSkeletonWithSwitchableTerms\n        terms={terms}\n        currentTerm={currentTerm}\n        onChangeTerm={setTerm}\n      >\n        <SkeletonContent>\n          <LoadingDisplay\n            state={loadingState}\n            name=\"current schedule version\"\n          />\n        </SkeletonContent>\n      </AppSkeletonWithSwitchableTerms>\n    );\n  }\n\n  return <>{children({ ...loadingState.result })}</>;\n}\n","import produce, { Draft, Immutable } from 'immer';\nimport { useCallback, useState } from 'react';\nimport useLocalStorageState from 'use-local-storage-state';\n\nimport { renderDataNotPersistentNotification } from '../../components/DataNotPersistentNotification';\nimport { ErrorWithFields } from '../../log';\nimport { LoadingState } from '../../types';\nimport { ScheduleData, AnyScheduleData } from '../types';\nimport useScheduleDataMigrations from './useScheduleDataMigrations';\n\nexport const SCHEDULE_DATA_LOCAL_STORAGE_KEY = 'schedule-data';\n\ntype HookResult = {\n  scheduleData: Immutable<ScheduleData>;\n  updateScheduleData: (\n    applyDraft: (draft: Draft<ScheduleData>) => void\n  ) => void;\n};\n\n/**\n * Gets the current schedule data from local storage.\n * Do not call this function in a non-root component;\n * it should only be called once in a root component (i.e. <App>).\n */\nexport default function useScheduleDataFromStorage(): LoadingState<HookResult> {\n  const [scheduleData, setScheduleData, { isPersistent }] =\n    useLocalStorageState<AnyScheduleData | null>(\n      SCHEDULE_DATA_LOCAL_STORAGE_KEY,\n      null\n    );\n\n  // This attempts to apply any relevant migrations to the data\n  // in an effect hook, and as such, requires us to return a \"loading\" state\n  // until migrations have been applied\n  const migrationResult = useScheduleDataMigrations({\n    rawScheduleData: scheduleData,\n    setScheduleData,\n  });\n\n  const [userAcceptedNonPersistence, setUserAcceptedNonPersistence] =\n    useState(false);\n\n  // updateScheduleData is a referentially stable callback function\n  // that can be used to update the schedule data using an immer draft:\n  // https://immerjs.github.io/immer/produce/\n  const updateScheduleData = useCallback(\n    (applyDraft: (draft: Draft<ScheduleData>) => void): void =>\n      // Here, we use the callback API for the setter function\n      // returned by `useState` so that we don't have to re-generate\n      // the callback when the state changes\n      setScheduleData((current: ScheduleData | null) => {\n        if (migrationResult.type !== 'done') {\n          // This should not be possible:\n          // we return early from the outer hook before we return this callback.\n          // The stacktrace will be useful for debugging this.\n          throw new ErrorWithFields({\n            message:\n              'updateScheduleData called when schedule data is not valid',\n            fields: {\n              migrationResultType: migrationResult.type,\n            },\n          });\n        }\n\n        // Use `produce` from Immer to combine the current state\n        // & caller-supplied callback that modifies the current state\n        // to produce the next state\n        return produce(current, applyDraft);\n      }),\n    [setScheduleData, migrationResult.type]\n  );\n\n  // If the state isn't persistent, then return an error to alert the user\n  // requiring them to acknowledge this before continuing\n  if (!isPersistent && !userAcceptedNonPersistence) {\n    return {\n      type: 'custom',\n      contents: renderDataNotPersistentNotification({\n        onAccept: (): void => {\n          setUserAcceptedNonPersistence(true);\n        },\n      }),\n    };\n  }\n\n  // The data is still \"loading\" -- it is waiting for the migration\n  // useEffect hook to apply migrations as needed\n  if (migrationResult.type === 'pending') {\n    return { type: 'loading' };\n  }\n\n  // The migration might have failed: in this case, there's nothing we can do.\n  if (migrationResult.type === 'error') {\n    return migrationResult.error;\n  }\n\n  return {\n    type: 'loaded',\n    result: {\n      scheduleData: migrationResult.result,\n      updateScheduleData,\n    },\n  };\n}\n","import axios from 'axios';\nimport { useEffect, useState, useRef } from 'react';\n\nimport { Oscar } from '../beans';\nimport { ErrorWithFields, softError } from '../../log';\nimport { CrawlerTermData, LoadingState } from '../../types';\nimport {\n  exponentialBackoff,\n  isAxiosNetworkError,\n  sleep,\n} from '../../utils/misc';\nimport Cancellable from '../../utils/cancellable';\n\nconst constructTermDataUrl = (term: string): string =>\n  `https://gt-scheduler.github.io/crawler/${term}.json`;\n\n// Number of minutes between re-downloads of the oscar data\nconst REFRESH_INTERVAL_MIN = 15;\n\n/**\n * Downloads the crawled data from Oscar that the crawler prepared\n * for the given term.\n * Repeatedly attempts to load in the case of errors,\n * and cancels any in-flight downloads if the parent context is unmounted\n * or the term is changed.\n * Once loaded, this also attempts to update the data every 15 minutes\n * in case the crawler has run again and there is updated data.\n * @param term - The term to fetch crawler data for\n */\nexport default function useDownloadOscarData(\n  term: string\n): LoadingState<Oscar> {\n  const [state, setState] = useState<LoadingState<Oscar>>({\n    type: 'loading',\n  });\n\n  // Keep a ref of the latest loaded Oscar\n  // to check if it is any newer than the current one.\n  const loadedOscarRef = useRef<Oscar | null>(null);\n\n  // Fetch the current term's crawler information\n  useEffect(() => {\n    const loadOperation = new Cancellable();\n    const url = constructTermDataUrl(term);\n\n    async function loadAndRefresh(): Promise<void> {\n      let isFirst = true;\n      while (!loadOperation.isCancelled) {\n        // Load the oscar data, showing errors only if this is the first time\n        // it is being loaded (otherwise, just log errors\n        // but don't disrupt the user). This is to prevent\n        // a background refresh from showing an error screen\n        // in the middle of a session.\n        // `load` will return early if it is cancelled\n        await load({ initialLoad: isFirst });\n        if (loadOperation.isCancelled) return;\n\n        // Sleep for the refresh interval,\n        // exiting early if cancelled\n        const promise = sleep({ amount_ms: REFRESH_INTERVAL_MIN * 60 * 1000 });\n        const result = await loadOperation.perform(promise);\n        if (result.cancelled) {\n          return;\n        }\n\n        isFirst = false;\n      }\n    }\n\n    async function load({\n      initialLoad,\n    }: {\n      initialLoad: boolean;\n    }): Promise<void> {\n      if (initialLoad) {\n        setState({\n          type: 'loading',\n        });\n      }\n\n      let attemptNumber = 1;\n      while (!loadOperation.isCancelled) {\n        try {\n          const promise = axios.get<CrawlerTermData>(url);\n          const result = await loadOperation.perform(promise);\n          if (result.cancelled) {\n            return;\n          }\n\n          const json = result.value.data;\n\n          // If the data is the same as the currently loaded data,\n          // skip loading it\n          if (\n            loadedOscarRef.current !== null &&\n            new Date(json.updatedAt).getTime() ===\n              loadedOscarRef.current?.updatedAt.getTime()\n          ) {\n            // Skip this update\n            return;\n          }\n\n          const oscar = new Oscar(json, term);\n          setState({\n            type: 'loaded',\n            result: oscar,\n          });\n          loadedOscarRef.current = oscar;\n\n          return;\n        } catch (err) {\n          // Report the error to Sentry if not a network error\n          if (!isAxiosNetworkError(err)) {\n            softError(\n              new ErrorWithFields({\n                message: 'error fetching crawler data',\n                source: err,\n                fields: {\n                  term,\n                  url,\n                },\n              })\n            );\n          }\n\n          if (initialLoad) {\n            // Flag that an error has occurred\n            setState({\n              type: 'error',\n              error:\n                err instanceof Error\n                  ? err\n                  : new ErrorWithFields({\n                      message: 'an error occurred while fetching crawler data',\n                      source: err,\n                    }),\n              stillLoading: true,\n              overview: String(err),\n            });\n          }\n        }\n\n        // Sleep for an exponential backoff between each retry\n        await exponentialBackoff(attemptNumber);\n        attemptNumber += 1;\n      }\n    }\n\n    loadAndRefresh().catch((err) => {\n      softError(\n        new ErrorWithFields({\n          message: 'error loading and refreshing oscar data',\n          source: err,\n          fields: {\n            term,\n            url,\n          },\n        })\n      );\n    });\n\n    // Cancel the background load when this cleans up\n    return (): void => {\n      loadOperation.cancel();\n    };\n  }, [term, setState]);\n\n  // If we are about to start a new background load\n  // after the term changed, then don't return a loaded Oscar\n  if (state.type === 'loaded' && state.result.term !== term) {\n    return { type: 'loading' };\n  }\n\n  return state;\n}\n","import produce, { Immutable, Draft, castDraft } from 'immer';\nimport { useEffect, useCallback } from 'react';\n\nimport { ErrorWithFields, softError } from '../../log';\nimport { LoadingState } from '../../types';\nimport { TermScheduleData, defaultSchedule, ScheduleVersion } from '../types';\n\n/**\n * Gets the current schedule version from the term schedule data,\n * ensuring that there is a valid current version selected.\n * If the current version isn't valid,\n * then this hook switches to a random existing version.\n * If there are no versions, then this hook automatically creates\n * an empty schedule version called 'Primary' and sets it as the current one.\n */\nexport default function useExtractScheduleVersion(\n  termScheduleData: Immutable<TermScheduleData>,\n  updateTermScheduleData: (\n    applyDraft: (\n      draft: Draft<TermScheduleData>\n    ) => void | Immutable<TermScheduleData>\n  ) => void\n): LoadingState<{\n  currentIndex: number;\n  scheduleVersion: Immutable<ScheduleVersion>;\n  // This function allows the schedule version to be edited in 1 of 2 ways:\n  // 1. the draft parameter is mutated, and the function returns nothing/void\n  // 2. the draft parameter is not mutated\n  //    (it can still be used, just not mutated)\n  //    and the function returns the new state to use.\n  //    This is similar to a traditional setState callback\n  updateScheduleVersion: (\n    applyDraft: (\n      draft: Draft<ScheduleVersion>\n    ) => void | Immutable<ScheduleVersion>\n  ) => void;\n}> {\n  function tryGet<T>(arr: readonly T[], index: number): T | null {\n    if (index < 0 || index > arr.length - 1) return null;\n    return arr[index] ?? null;\n  }\n\n  // Switch the version to any other version if the current one is invalid.\n  // If there are no versions, then create a new one called 'Primary'\n  const maybeCurrentScheduleVersion = tryGet(\n    termScheduleData.versions,\n    termScheduleData.currentIndex\n  );\n  useEffect(() => {\n    if (maybeCurrentScheduleVersion === null) {\n      updateTermScheduleData((draft) => {\n        // Make sure the schedule isn't on the draft either\n        if (tryGet(draft.versions, draft.currentIndex) === null) {\n          if (draft.versions.length === 0) {\n            // Create a new version called 'Primary'\n            draft.versions.push({\n              name: 'Primary',\n              schedule: castDraft(defaultSchedule),\n            });\n            draft.currentIndex = 0;\n          } else {\n            // Set the current version to the first one\n            draft.currentIndex = 0;\n          }\n        }\n      });\n    }\n  }, [maybeCurrentScheduleVersion, updateTermScheduleData]);\n\n  // Create a nested update callback for just the schedule version.\n  // This should only escape this function\n  // when `maybeCurrentScheduleVersion` is not null\n  const updateScheduleVersion = useCallback(\n    (\n      applyDraft: (\n        draft: Draft<ScheduleVersion>\n      ) => void | Immutable<ScheduleVersion>\n    ): void => {\n      updateTermScheduleData((draft) => {\n        const currentScheduleVersionDraft = tryGet(\n          draft.versions,\n          draft.currentIndex\n        );\n        if (currentScheduleVersionDraft === null) {\n          softError(\n            new ErrorWithFields({\n              message:\n                'updateScheduleVersion called with invalid current schedule version; ignoring',\n              fields: {\n                currentIndex: draft.currentIndex,\n                currentScheduleVersion: null,\n              },\n            })\n          );\n          return;\n        }\n\n        draft.versions[draft.currentIndex] = produce(\n          currentScheduleVersionDraft,\n          (subDraft) => castDraft(applyDraft(subDraft))\n        );\n      });\n    },\n    [updateTermScheduleData]\n  );\n\n  if (maybeCurrentScheduleVersion === null) {\n    return {\n      type: 'loading',\n    };\n  }\n\n  return {\n    type: 'loaded',\n    result: {\n      currentIndex: termScheduleData.currentIndex,\n      scheduleVersion: maybeCurrentScheduleVersion,\n      updateScheduleVersion,\n    },\n  };\n}\n","import produce, { Immutable, Draft, original, castDraft } from 'immer';\nimport React, { useCallback, useMemo } from 'react';\n\nimport {\n  ScheduleContextValue,\n  TermsContext,\n  ScheduleContext,\n} from '../../contexts';\nimport { Oscar } from '../../data/beans';\nimport { Schedule, defaultSchedule, ScheduleVersion } from '../../data/types';\nimport {\n  StageLoadScheduleData,\n  StageLoadTerms,\n  StageExtractTermScheduleData,\n  StageLoadOscarData,\n  StageExtractScheduleVersion,\n} from './stages';\n\nexport type DataLoaderProps = {\n  children: React.ReactNode;\n};\n\n/**\n * Handles loading all relevant data and provide valid values\n * for the Terms & Term contexts before rendering its `children`.\n * Works by having a series of \"stages\" implemented as components,\n * where each stage doesn't render its children until its ready.\n * Until then, they won't run the function passed in to their `children` prop\n * and will instead show an intermediate loading state,\n * complete with an app \"skeleton\" that includes the footer/header.\n */\nexport default function DataLoader({\n  children,\n}: DataLoaderProps): React.ReactElement {\n  return (\n    <StageLoadScheduleData>\n      {({ scheduleData, updateScheduleData, setTerm }): React.ReactElement => (\n        <StageLoadTerms>\n          {({ terms }): React.ReactElement => (\n            <StageExtractTermScheduleData\n              terms={terms}\n              scheduleData={scheduleData}\n              updateScheduleData={updateScheduleData}\n            >\n              {({\n                currentTerm,\n                termScheduleData,\n                updateTermScheduleData,\n              }): React.ReactElement => (\n                <StageLoadOscarData\n                  terms={terms}\n                  term={currentTerm}\n                  setTerm={setTerm}\n                >\n                  {({ oscar }): React.ReactElement => (\n                    <StageExtractScheduleVersion\n                      terms={terms}\n                      currentTerm={currentTerm}\n                      setTerm={setTerm}\n                      termScheduleData={termScheduleData}\n                      updateTermScheduleData={updateTermScheduleData}\n                    >\n                      {({\n                        // currentIndex,\n                        scheduleVersion,\n                        updateScheduleVersion,\n                      }): React.ReactElement => (\n                        <ContextProvider\n                          terms={terms}\n                          term={currentTerm}\n                          setTerm={setTerm}\n                          oscar={oscar}\n                          scheduleVersion={scheduleVersion}\n                          updateScheduleVersion={updateScheduleVersion}\n                        >\n                          {children}\n                        </ContextProvider>\n                      )}\n                    </StageExtractScheduleVersion>\n                  )}\n                </StageLoadOscarData>\n              )}\n            </StageExtractTermScheduleData>\n          )}\n        </StageLoadTerms>\n      )}\n    </StageLoadScheduleData>\n  );\n}\n\n// Private sub-components\n\ntype ContextProviderProps = {\n  terms: string[];\n  term: string;\n  setTerm: (next: string) => void;\n  oscar: Oscar;\n  scheduleVersion: Immutable<ScheduleVersion>;\n  updateScheduleVersion: (\n    applyDraft: (\n      draft: Draft<ScheduleVersion>\n    ) => void | Immutable<ScheduleVersion>\n  ) => void;\n  children: React.ReactNode;\n};\n\n/**\n * Handles making all loaded data available to the rest of the app\n * via the contexts `TermsContext` and `ScheduleContext`.\n * Additionally, memoizes the context values\n * as well as any derived values that go into them.\n */\nfunction ContextProvider({\n  terms,\n  term,\n  setTerm,\n  oscar,\n  scheduleVersion,\n  updateScheduleVersion,\n  children,\n}: ContextProviderProps): React.ReactElement {\n  // Create a `updateSchedule` function\n  const updateSchedule = useCallback(\n    (\n      applyDraft: (draft: Draft<Schedule>) => void | Immutable<Schedule>\n    ): void => {\n      updateScheduleVersion((draft) => {\n        draft.schedule = produce(draft.schedule, (subDraft) =>\n          castDraft(applyDraft(subDraft))\n        );\n      });\n    },\n    [updateScheduleVersion]\n  );\n\n  // Create a `patchSchedule` function\n  const patchSchedule = useCallback(\n    (patch: Partial<Schedule>): void => {\n      updateSchedule((draft) => ({\n        ...(original(draft) ?? defaultSchedule),\n        ...patch,\n      }));\n    },\n    [updateSchedule]\n  );\n\n  // Memoize the context value so that it is stable\n  const scheduleContextValue = useMemo<ScheduleContextValue>(\n    () => [\n      { term, oscar, ...castDraft(scheduleVersion.schedule) },\n      { setTerm, patchSchedule, updateSchedule },\n    ],\n    [term, oscar, scheduleVersion, setTerm, patchSchedule, updateSchedule]\n  );\n\n  return (\n    <TermsContext.Provider value={terms}>\n      <ScheduleContext.Provider value={scheduleContextValue}>\n        {children}\n      </ScheduleContext.Provider>\n    </TermsContext.Provider>\n  );\n}\n","import Cookies from 'js-cookie';\nimport { useEffect, useMemo } from 'react';\nimport useLocalStorageState from 'use-local-storage-state';\n\nimport { ThemeContextValue } from '../../contexts';\nimport { isTheme } from '../../types';\n\nconst THEME_LOCAL_STORAGE_KEY = 'theme';\n\n/**\n * Loads the current UI theme (light/dark) from local storage,\n * falling back to the legacy cookies-based storage if necessary.\n * Returns a memoized value of the theme context.\n */\nexport default function useThemeFromStorage(): ThemeContextValue {\n  const [theme, setTheme] = useLocalStorageState(\n    THEME_LOCAL_STORAGE_KEY,\n    () => {\n      const legacyValue = Cookies.get(THEME_LOCAL_STORAGE_KEY);\n      if (legacyValue !== undefined) return legacyValue;\n      return 'dark';\n    }\n  );\n  const correctedTheme = isTheme(theme) ? theme : 'dark';\n\n  // Ensure that the stored theme is valid; otherwise reset it\n  useEffect(() => {\n    if (theme !== correctedTheme) {\n      setTheme(correctedTheme);\n    }\n  }, [theme, correctedTheme, setTheme]);\n\n  const themeContextValue = useMemo<ThemeContextValue>(\n    () => [correctedTheme, setTheme],\n    [correctedTheme, setTheme]\n  );\n\n  return themeContextValue;\n}\n","import React from 'react';\n\nimport { classes } from '../../utils/misc';\nimport Feedback from '../Feedback';\nimport useBodyClass from '../../hooks/useBodyClass';\nimport useMobile from '../../hooks/useMobile';\nimport { ThemeContext } from '../../contexts';\nimport { useInformationModal } from '../InformationModal';\nimport ErrorBoundary from '../ErrorBoundary';\nimport { ReactErrorDetails } from '../ErrorDetails';\nimport ErrorDisplay from '../ErrorDisplay';\nimport ErrorHeader from '../ErrorHeader';\nimport { AppNavigation } from './navigation';\nimport AppDataLoader from '../AppDataLoader';\nimport {\n  AppSkeletonWithLoadingTerms,\n  SkeletonContent,\n  AppContent,\n} from './content';\nimport useThemeFromStorage from '../../data/hooks/useThemeFromStorage';\n\nimport 'react-virtualized/styles.css';\nimport './stylesheet.scss';\n\nexport default function App(): React.ReactElement {\n  // Display a popup when first visiting the site\n  useInformationModal();\n\n  // Grab the current theme (light/dark) from local storage.\n  // This hook returns the memoized context value.\n  const themeContextValue = useThemeFromStorage();\n\n  // Add the current theme as a class on the body element\n  useBodyClass(themeContextValue[0]);\n\n  return (\n    <ThemeContext.Provider value={themeContextValue}>\n      <AppCSSRoot>\n        <ErrorBoundary\n          fallback={(error, errorInfo): React.ReactElement => (\n            <AppSkeletonWithLoadingTerms>\n              <SkeletonContent>\n                <ErrorHeader />\n                <ErrorDisplay\n                  errorDetails={\n                    <ReactErrorDetails error={error} errorInfo={errorInfo} />\n                  }\n                >\n                  <div>\n                    There was en error somewhere in the core application logic\n                    and it can&apos;t continue.\n                  </div>\n                  <div>\n                    Try refreshing the page to see if it fixes the issue.\n                  </div>\n                </ErrorDisplay>\n              </SkeletonContent>\n            </AppSkeletonWithLoadingTerms>\n          )}\n        >\n          <AppNavigation>\n            {/* AppDataLoader is in charge of ensuring that there are valid values\n                for the Terms and Term contexts before rendering its children.\n                If any data is still loading,\n                then it displays an \"app skeleton\" with a spinner.\n                If there was an error while loading\n                then it displays an error screen. */}\n            <AppDataLoader>\n              <AppContent />\n            </AppDataLoader>\n          </AppNavigation>\n          <Feedback />\n        </ErrorBoundary>\n      </AppCSSRoot>\n    </ThemeContext.Provider>\n  );\n}\n\n// Private sub-components\n\ntype AppCSSRootProps = {\n  children?: React.ReactNode;\n};\n\n/**\n * Mounts the outer `div.App` that is used to control global CSS selectors\n * such as `.App.mobile`.\n */\nfunction AppCSSRoot({ children }: AppCSSRootProps): React.ReactElement {\n  // Re-render when the page is re-sized to become mobile/desktop\n  // (desktop is >= 1024 px wide)\n  const mobile = useMobile();\n\n  return <div className={classes('App', mobile && 'mobile')}>{children}</div>;\n}\n","import { useLayoutEffect } from 'react';\n\n/**\n * Adds the given class(es) to the HTML `body` element\n * when this hook runs.\n */\nexport default function useBodyClass(className: string | string[]): void {\n  useLayoutEffect(() => {\n    if (typeof className === 'string') {\n      document.body.classList.add(className);\n    } else {\n      document.body.classList.add(...className);\n    }\n\n    return (): void => {\n      if (typeof className === 'string') {\n        document.body.classList.remove(className);\n      } else {\n        document.body.classList.remove(...className);\n      }\n    };\n  }, [className]);\n}\n","import React from 'react';\n\nexport type Theme = 'light' | 'dark';\n\nexport function isTheme(theme: string): theme is Theme {\n  switch (theme) {\n    case 'light':\n    case 'dark':\n      return true;\n    default:\n      return false;\n  }\n}\n\nexport type LoadingState<T> =\n  | LoadingStateLoaded<T>\n  | LoadingStateLoading\n  | LoadingStateError\n  | LoadingStateCustom;\nexport type LoadingStateLoaded<T> = { type: 'loaded'; result: T };\nexport type LoadingStateLoading = { type: 'loading' };\nexport type LoadingStateError = {\n  type: 'error';\n  overview: React.ReactNode;\n  error: Error;\n  stillLoading: boolean;\n};\nexport type LoadingStateCustom = {\n  type: 'custom';\n  contents: React.ReactNode;\n};\n\nexport type NonEmptyArray<T> = [T, ...T[]];\n\n// Declare (better) types for the ICS library\nexport type ICS = {\n  download(filename: string, ext?: string): string | false;\n  addEvent(\n    subject: string,\n    description: string,\n    location: string,\n    begin: string | Date,\n    stop: string | Date,\n    rrule: unknown\n  ): false | string[];\n};\n\nexport interface Combination {\n  crns: string[];\n  startMap: Record<string, number>;\n  endMap: Record<string, number>;\n}\n\nexport interface Period {\n  start: number;\n  end: number;\n}\n\nexport interface DateRange {\n  from: Date;\n  to: Date;\n}\n\nexport interface Location {\n  lat: number;\n  long: number;\n}\n\nexport interface Meeting {\n  period: Period | undefined;\n  days: string[];\n  where: string;\n  location: Location | null;\n  instructors: string[];\n  dateRange: DateRange;\n}\n\nexport interface CourseGpa {\n  averageGpa?: number;\n  [instructor: string]: number | undefined;\n}\n\n// Meeting type (imported as `CrawlerMeeting`):\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\nexport type CrawlerMeeting = [\n  /**\n   * an integer index into `caches.periods`,\n   * specifying the class's start/end times\n   */\n  periodIndex: number,\n  /**\n   * a string specifying what days the class takes place on\n   * (e.g. `\"MW\"` or `\"TR\"`)\n   */\n  days: string,\n  /**\n   * a string giving the room/location where the course will be held\n   * (e.g. `\"College of Business 224\"`)\n   */\n  room: string,\n  /**\n   * an integer index into `caches.locations`,\n   * containing the latitude and longitude for a given course\n   */\n  locationIndex: number,\n  /**\n   * an array of strings listing all the instructors for this section,\n   * along with a 1-character code to mark the principal instructor\n   * (e.g. `[\"Katarzyna Rubar (P)\"]`)\n   */\n  instructors: string[],\n  /**\n   * an integer index into `caches.dateRanges`,\n   * specifying the start/end date of the class this semester\n   */\n  dateRangeIndex: number\n];\n\n// Section type (imported as `CrawlerSection`):\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\n/**\n * Contains  information about the course's section\n * (**Note** that this is an **array** (tuple), not an object)\n */\nexport type CrawlerSection = [\n  /**\n   * the CRN number of this section of the course\n   */\n  crn: string,\n  /**\n   * array of information about the section's meeting\n   * times/places/professors/etc.; in most cases, this array will only contain\n   * 1 item\n   */\n  meetings: CrawlerMeeting[],\n  /**\n   * integer number of credit hours this course is worth\n   */\n  creditHours: number,\n  /**\n   * integer index into `caches.scheduleTypes`\n   */\n  scheduleTypeIndex: number,\n  /**\n   * integer index into `caches.campuses`,\n   * specifying which campus the class is being taught at\n   */\n  campusIndex: number,\n  /**\n   * array of integer indices into `caches.attributes`,\n   * specifying any additional attributes the course has\n   */\n  attributeIndices: number[],\n  /**\n   * integer index into caches.gradeBases,\n   * specifying the grading scheme of the class\n   */\n  gradeBaseIndex: number\n];\n\n// Prerequisite types:\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\nexport type MinimumGrade = 'A' | 'B' | 'C' | 'D' | 'T';\nexport type PrerequisiteCourse = { id: string; grade?: MinimumGrade };\nexport type PrerequisiteClause = PrerequisiteCourse | PrerequisiteSet;\nexport type PrerequisiteOperator = 'and' | 'or';\nexport type PrerequisiteSet = [\n  operator: PrerequisiteOperator,\n  ...clauses: PrerequisiteClause[]\n];\n\n/**\n * Recursive data structure that is the sequence of all prerequisites in prefix\n * notation, parsed from the information on Oscar\n *\n * @example\n *\n * ```json\n   [\n     \"and\",\n     [\n       \"or\",\n       {\"id\":\"CS 3510\", \"grade\":\"C\"},\n       {\"id\":\"CS 3511\", \"grade\":\"C\"}\n     ]\n   ]\n * ```\n */\nexport type CrawlerPrerequisites = PrerequisiteSet | [];\n\n// Caches type (imported as `CrawlerCaches`):\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\n/**\n * Contains data shared by multiple class descriptions\n */\nexport interface CrawlerCaches {\n  /**\n   * List of all the different time ranges that classes can be offered at\n   * (e.g. `\"8:00 am - 8:50 am\"`;\n   * there is one `\"TBA\"` string for classes whose time is \"To Be Announced\")\n   */\n  periods: string[];\n  /**\n   * List of all possible start/ending dates that classes can be offered between\n   * (e.g. `\"Aug 17, 2020 - Dec 10, 2020\"`)\n   */\n  dateRanges: string[];\n  /**\n   * List of the different types of classes for each time block\n   * (e.g. `\"Lecture*\"`, `\"Recitation*\"`, or `\"Internship/Practicum*\"`)\n   */\n  scheduleTypes: string[];\n  /**\n   * List of the different GT campus locations that a class could take place at\n   * (e.g. `\"Georgia Tech-Atlanta *\"` or `\"Online\"`)\n   */\n  campuses: string[];\n  /**\n   * List of other miscellaneous attributes that can be associated with a class\n   * (e.g. `\"Hybrid Course\"`, `\"Honors Program\"`, or `\"Capstone\"`)\n   */\n  attributes: string[];\n  /**\n   * List of the different kinds of grading schemes a course can have\n   */\n  gradeBases: string[];\n  /**\n   * List of the different building locations a class can be at\n   */\n  locations: Location[];\n}\n\n// Course type (imported as `CrawlerCourse`):\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\n/**\n * Contains information about a single class\n * (**Note** that this is an **array** (tuple), not an object)\n */\nexport type CrawlerCourse = [\n  /**\n   * the full, human-readable name of the course (e.g. \"Accounting I\")\n   */\n  fullName: string,\n  /**\n   * a JSON object with information about each section of the course;\n   * the section IDs are the keys (`\"A\"`, `\"B\"`, `\"S2\"`, etc.)\n   */\n  sections: Record<string, CrawlerSection>,\n  /**\n     * a tree of prerequisite classes and the necessary grades in them\n     * (using boolean expressions in prefix order)\n     *\n     * @example\n     *\n     * ```json\n       [\n         \"and\",\n         [\n            \"or\",\n            {\"id\":\"CS 3510\", \"grade\":\"C\"},\n            {\"id\":\"CS 3511\", \"grade\":\"C\"}\n         ]\n       ]\n     * ```\n     */\n  // ! Type had `undefined` explicitly added to ensure we check when accessing\n  prerequisites: CrawlerPrerequisites | undefined,\n  /**\n   * Description pulled from Oscar\n   */\n  description: string | null\n];\n\n// TermData type (imported as `CrawlerTermData`):\n// Copied from https://github.com/gt-scheduler/crawler/blob/master/src/types.ts\n\n/**\n * Primary JSON object returned by the API.\n * See https://github.com/GTBitsOfGood/gt-scheduler/issues/1#issuecomment-694326220\n * for more info on the shape\n */\nexport interface CrawlerTermData {\n  /**\n   * Contains information about each class;\n   * this makes up the vast bulk of the resultant JSON.\n   * The course IDs are the keys (`\"ACCT 2101\"`, `\"CS 2340\"`, etc.)\n   */\n  courses: Record<string, CrawlerCourse>;\n  /**\n   * Contains data shared by multiple class descriptions\n   */\n  caches: CrawlerCaches;\n  /**\n   * Contains the time this JSON file was retrieved\n   */\n  // ! Type changed to `string` since this is what the JSON will be\n  updatedAt: string;\n  /**\n   * Version number for the term data\n   */\n  version: number;\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from '@sentry/react';\nimport { Integrations } from '@sentry/tracing';\n\nimport App from './components/App';\n\nimport 'normalize.css';\nimport './stylesheet.scss';\n\n// Only initialize sentry on production\nif (process.env.NODE_ENV === 'production') {\n  // eslint-disable-next-line no-console\n  console.log('Initializing Sentry');\n  Sentry.init({\n    dsn: 'https://8955ef982197469e97c7644a8c090db1@o552970.ingest.sentry.io/5679614',\n    integrations: [new Integrations.BrowserTracing()],\n    tracesSampleRate: 1.0,\n    ignoreErrors: ['ResizeObserver loop limit exceeded'],\n    release: process.env['REACT_APP_SENTRY_VERSION'],\n  });\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}